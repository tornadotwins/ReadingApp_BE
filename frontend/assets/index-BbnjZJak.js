var Ut=Object.defineProperty;var $t=(e,o,n)=>o in e?Ut(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n;var ut=(e,o,n)=>$t(e,typeof o!="symbol"?o+"":o,n);import{c as Ae,_ as q,j as a,$ as le,b,ak as Lt,F as re,ao as Ot,as as Nt,at as Ie,au as Oe,a3 as K,Z as X,av as Ne,aw as Mt,ax as zt,ay as Ce,az as bt,aA as _e,aB as gt,ap as Ft}from"./index-Clv2Y-Ws.js";import{w as _t,x as Rt,y as Ht,z as Te,s as de,A as Kt,D as jt,E as je,F as At,S as Pe,g as Ee,k as V,B as wt,c as Gt,u as Wt,d as U}from"./App-CDBbwMU4.js";import{S as Vt,a as Yt,b as qt,c as Xt,d as Zt,e as Qt,f as Jt,g as pt,h as xt,i as eo,j as to,k as oo,l as kt,m as so,n as ao,o as no,p as io,q as lo,r as ro,s as co,t as uo,u as bo,v as go,w as xo,x as ko,y as mo,z as fo,A as vo,B as yo,C as mt,D as ft,E as vt,F as Bo}from"./BookHeader-1_YPCs1w.js";import{T as oe,I as O,g as So,t as yt,a as Bt}from"./index-te5N--mx.js";import{C as Y}from"./index-rBkjBpoI.js";import{A as Co,b as St}from"./bookmark.service-JvaCoiYa.js";import{S as ho}from"./index-p59hCajf.js";import{L as To}from"./index-BLWqtpmw.js";import{b as Ct}from"./book.service-BE_qkedx.js";import{a as Re}from"./auth.service-CYQxV5o3.js";import"./index-JNcP9kBx.js";import"./index-CfPj1ezk.js";import"./axios-upsvKRUO.js";function Po(e){return Rt("MuiPagination",e)}_t("MuiPagination",["root","ul","outlined","text"]);const Eo=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function Io(e={}){const{boundaryCount:o=1,componentName:n="usePagination",count:t=1,defaultPage:g=1,disabled:m=!1,hideNextButton:B=!1,hidePrevButton:h=!1,onChange:_,page:y,showFirstButton:S=!1,showLastButton:N=!1,siblingCount:d=1}=e,r=Ae(e,Eo),[C,P]=Ht({controlled:y,default:g,name:n,state:"page"}),M=(u,T)=>{y||P(T),_&&_(u,T)},E=(u,T)=>{const i=T-u+1;return Array.from({length:i},(l,c)=>u+c)},j=E(1,Math.min(o,t)),A=E(Math.max(t-o+1,o+1),t),J=Math.max(Math.min(C-d,t-o-d*2-1),o+2),$=Math.min(Math.max(C+d,o+d*2+2),A.length>0?A[0]-2:t-1),F=[...S?["first"]:[],...h?[]:["previous"],...j,...J>o+2?["start-ellipsis"]:o+1<t-o?[o+1]:[],...E(J,$),...$<t-o-1?["end-ellipsis"]:t-o>o?[t-o]:[],...A,...B?[]:["next"],...N?["last"]:[]],p=u=>{switch(u){case"first":return 1;case"previous":return C-1;case"next":return C+1;case"last":return t;default:return null}},x=F.map(u=>typeof u=="number"?{onClick:T=>{M(T,u)},type:"page",page:u,selected:u===C,disabled:m,"aria-current":u===C?"true":void 0}:{onClick:T=>{M(T,p(u))},type:u,page:p(u),selected:!1,disabled:m||u.indexOf("ellipsis")===-1&&(u==="next"||u==="last"?C>=t:C<=1)});return q({items:x},r)}function Oo(e){return Rt("MuiPaginationItem",e)}const Q=_t("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),ht=Te(a.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),Tt=Te(a.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),Pt=Te(a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),Et=Te(a.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),No=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],Dt=(e,o)=>{const{ownerState:n}=e;return[o.root,o[n.variant],o[`size${re(n.size)}`],n.variant==="text"&&o[`text${re(n.color)}`],n.variant==="outlined"&&o[`outlined${re(n.color)}`],n.shape==="rounded"&&o.rounded,n.type==="page"&&o.page,(n.type==="start-ellipsis"||n.type==="end-ellipsis")&&o.ellipsis,(n.type==="previous"||n.type==="next")&&o.previousNext,(n.type==="first"||n.type==="last")&&o.firstLast]},_o=e=>{const{classes:o,color:n,disabled:t,selected:g,size:m,shape:B,type:h,variant:_}=e,y={root:["root",`size${re(m)}`,_,B,n!=="standard"&&`color${re(n)}`,n!=="standard"&&`${_}${re(n)}`,t&&"disabled",g&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[h]],icon:["icon"]};return At(y,Oo,o)},Ro=de("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:Dt})(({theme:e,ownerState:o})=>q({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,height:"auto",[`&.${Q.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},o.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},o.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)})),jo=de(Kt,{name:"MuiPaginationItem",slot:"Root",overridesResolver:Dt})(({theme:e,ownerState:o})=>q({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,[`&.${Q.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Q.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},transition:e.transitions.create(["color","background-color"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Q.selected}`]:{backgroundColor:(e.vars||e).palette.action.selected,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:le(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${Q.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:le(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},[`&.${Q.disabled}`]:{opacity:1,color:(e.vars||e).palette.action.disabled,backgroundColor:(e.vars||e).palette.action.selected}}},o.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},o.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)},o.shape==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius}),({theme:e,ownerState:o})=>q({},o.variant==="text"&&{[`&.${Q.selected}`]:q({},o.color!=="standard"&&{color:(e.vars||e).palette[o.color].contrastText,backgroundColor:(e.vars||e).palette[o.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[o.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[o.color].main}},[`&.${Q.focusVisible}`]:{backgroundColor:(e.vars||e).palette[o.color].dark}},{[`&.${Q.disabled}`]:{color:(e.vars||e).palette.action.disabled}})},o.variant==="outlined"&&{border:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${Q.selected}`]:q({},o.color!=="standard"&&{color:(e.vars||e).palette[o.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[o.color].mainChannel} / 0.5)`:le(e.palette[o.color].main,.5)}`,backgroundColor:e.vars?`rgba(${e.vars.palette[o.color].mainChannel} / ${e.vars.palette.action.activatedOpacity})`:le(e.palette[o.color].main,e.palette.action.activatedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[o.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:le(e.palette[o.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Q.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[o.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:le(e.palette[o.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity)}},{[`&.${Q.disabled}`]:{borderColor:(e.vars||e).palette.action.disabledBackground,color:(e.vars||e).palette.action.disabled}})})),Ao=de("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(e,o)=>o.icon})(({theme:e,ownerState:o})=>q({fontSize:e.typography.pxToRem(20),margin:"0 -8px"},o.size==="small"&&{fontSize:e.typography.pxToRem(18)},o.size==="large"&&{fontSize:e.typography.pxToRem(22)})),wo=b.forwardRef(function(o,n){const t=jt({props:o,name:"MuiPaginationItem"}),{className:g,color:m="standard",component:B,components:h={},disabled:_=!1,page:y,selected:S=!1,shape:N="circular",size:d="medium",slots:r={},type:C="page",variant:P="text"}=t,M=Ae(t,No),E=q({},t,{color:m,disabled:_,selected:S,shape:N,size:d,type:C,variant:P}),j=Lt(),A=_o(E),$=(j?{previous:r.next||h.next||Et,next:r.previous||h.previous||Pt,last:r.first||h.first||ht,first:r.last||h.last||Tt}:{previous:r.previous||h.previous||Pt,next:r.next||h.next||Et,first:r.first||h.first||ht,last:r.last||h.last||Tt})[C];return C==="start-ellipsis"||C==="end-ellipsis"?a.jsx(Ro,{ref:n,ownerState:E,className:je(A.root,g),children:"â€¦"}):a.jsxs(jo,q({ref:n,ownerState:E,component:B,disabled:_,className:je(A.root,g)},M,{children:[C==="page"&&y,$?a.jsx(Ao,{as:$,ownerState:E,className:A.icon}):null]}))}),Do=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Uo=e=>{const{classes:o,variant:n}=e;return At({root:["root",n],ul:["ul"]},Po,o)},$o=de("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[o.root,o[n.variant]]}})({}),Lo=de("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(e,o)=>o.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Mo(e,o,n){return e==="page"?`${n?"":"Go to "}page ${o}`:`Go to ${e} page`}const zo=b.forwardRef(function(o,n){const t=jt({props:o,name:"MuiPagination"}),{boundaryCount:g=1,className:m,color:B="standard",count:h=1,defaultPage:_=1,disabled:y=!1,getItemAriaLabel:S=Mo,hideNextButton:N=!1,hidePrevButton:d=!1,renderItem:r=x=>a.jsx(wo,q({},x)),shape:C="circular",showFirstButton:P=!1,showLastButton:M=!1,siblingCount:E=1,size:j="medium",variant:A="text"}=t,J=Ae(t,Do),{items:$}=Io(q({},t,{componentName:"Pagination"})),F=q({},t,{boundaryCount:g,color:B,count:h,defaultPage:_,disabled:y,getItemAriaLabel:S,hideNextButton:N,hidePrevButton:d,renderItem:r,shape:C,showFirstButton:P,showLastButton:M,siblingCount:E,size:j,variant:A}),p=Uo(F);return a.jsx($o,q({"aria-label":"pagination navigation",className:je(p.root,m),ownerState:F,ref:n},J,{children:a.jsx(Lo,{className:p.ul,ownerState:F,children:$.map((x,u)=>a.jsx("li",{children:r(q({},x,{color:B,"aria-label":S(x.type,x.page,x.selected),shape:C,size:j,variant:A}))},u))})}))});function Fo(e){return a.jsx(zo,{count:e.count,hidePrevButton:e.hideNextButton,hideNextButton:e.hideNextButton,page:e.page,siblingCount:0,boundaryCount:1,onChange:e.onChange})}function It(){const{innerWidth:e,innerHeight:o}=window;return{width:e,height:o}}function Ho(){const[e,o]=b.useState(It());return b.useEffect(()=>{function n(){o(It())}return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),e}function Ko(e){var T,i,l,c,f,k,v,w,R,Z,I,ee,se,ae,ce,ue,be,L,we,De,Ue,$e,Le,Me,ze,Fe,He,Ke,Ge,We,Ve,Ye,qe,Xe,Ze,Qe,Je,pe,et,tt;const[o,n]=b.useState([]),[t,g]=b.useState(),[m,B]=b.useState(!1),[h,_]=b.useState(!1),[y,S]=b.useState(0),{theme:N,referenceLanguage:d,readingLanguage:r}=b.useContext(Pe),{mainBGColor:C,altTextColor:P,backgroundColor:M,topTextColor:E,buttonColor:j,buttonTextColor:A}=Ee(N),J=localStorage.getItem(Ot)||Nt,$=b.useMemo(()=>{if(e.userHistory&&e.userHistory.length>0){const s=e.userHistory.filter(H=>H.bookId==e.bookId);if(s&&s.length>0)return s[0].readChapterIds}return[]},[e.userHistory]),F=e.subBookId;b.useEffect(()=>{e.bookTitle.en=="Qur'an"||e.bookTitle.en=="Zabur"?B(!1):e.openedSubBook==e.subBookId?B(!0):B(!1)},[e.openedSubBook]),b.useEffect(()=>{var W,G;const s=e.subBooks.filter(z=>z.subBookId===F);let H=0;if(s&&s.length>0&&(H=(W=s[0].chapterInfos)==null?void 0:W.length,g(s[0])),e.currentUser){const z=e.userHistory.filter(D=>D.bookId==e.bookId);if(z&&z.length>0){const D=z[0].subBooks.filter(te=>te.subBookId==F);D&&D.length>0&&S(Math.floor(((G=D[0])==null?void 0:G.readChapters)/H*100))}}if(e.subBooks&&e.subBooks.length>0){const z=e.subBooks.filter(D=>D.subBookId==F);if(z&&z.length>0){let D=z[0].chapterInfos;D.sort((te,ne)=>te.chapterNumber-ne.chapterNumber),n(D)}}},[e.subBooks,e.userHistory]),b.useEffect(()=>{if(e.subBookInfos&&e.subBookInfos.length>0){const s=e.subBookInfos.filter(H=>H.subBookId==F);s&&s.length>0?_(!0):_(!1)}},[]);const p=b.useCallback(s=>{_(H=>!H),e.onDownload(s)},[]),x=()=>{var s,H;if(t!=null&&t.noChapter){const W=(s=t==null?void 0:t.chapterInfos[0])==null?void 0:s.isTranslated,G=(H=t==null?void 0:t.chapterInfos[0])==null?void 0:H.isPublished;!(W!=null&&W[d])&&!(W!=null&&W[r])||!(G!=null&&G[d])&&!(G!=null&&G[r])?V.custom(z=>{var D,te,ne;return a.jsx(Y,{text:((ne=(te=(D=e.terms)==null?void 0:D.texts.find(Se=>Se.variable=="None Translated"))==null?void 0:te.text)==null?void 0:ne[r])||"",visible:z.visible})}):e.moveToReading(t==null?void 0:t.chapterInfos[0].chapterId,t.subBookId)}else B(!m),e.handleOpenedSubBook(e.subBookId)},u=(s,H)=>{H=="none"?V.custom(W=>{var G,z,D;return a.jsx(Y,{text:((D=(z=(G=e.terms)==null?void 0:G.texts.find(te=>te.variable=="None Translated"))==null?void 0:z.text)==null?void 0:D[r])||"",visible:W.visible})}):e.moveToReading(s,t.subBookId)};return a.jsxs(Vt,{id:e.id,children:[a.jsxs(Yt,{children:[a.jsxs(qt,{progress:y,progresscolor:j,onClick:x,children:[(t==null?void 0:t.subBookNumber)!=0&&a.jsxs(Xt,{istransliteration:((T=t==null?void 0:t.subBookTitle)==null?void 0:T[Ie])!=null?"true":"false",translatestatus:(t==null?void 0:t.noChapter)&&(!((l=(i=t==null?void 0:t.chapterInfos[0])==null?void 0:i.isTranslated)!=null&&l[d])&&!((f=(c=t==null?void 0:t.chapterInfos[0])==null?void 0:c.isTranslated)!=null&&f[r])||!((v=(k=t==null?void 0:t.chapterInfos[0])==null?void 0:k.isPublished)!=null&&v[d])&&!((R=(w=t==null?void 0:t.chapterInfos[0])==null?void 0:w.isPublished)!=null&&R[r])?"none":(!((I=(Z=t==null?void 0:t.chapterInfos[0])==null?void 0:Z.isTranslated)!=null&&I[d])||!((se=(ee=t==null?void 0:t.chapterInfos[0])==null?void 0:ee.isTranslated)!=null&&se[r]))&&((ce=(ae=t==null?void 0:t.chapterInfos[0])==null?void 0:ae.isPublished)!=null&&ce[d]||!((be=(ue=t==null?void 0:t.chapterInfos[0])==null?void 0:ue.isPublished)!=null&&be[r]))?"one":"both")||"",children:[((L=t==null?void 0:t.subBookTitle)==null?void 0:L[Ie])&&a.jsx(oe,{fontFamily:'"Baloo Da 2"',fontWeight:"bold",color:P,language:Oe,children:(t==null?void 0:t.subBookNumber)+". "+((we=t==null?void 0:t.subBookTitle)==null?void 0:we[Ie])}),a.jsx(oe,{fontFamily:'"Baloo Da 2"',fontWeight:"bold",color:P,language:Oe,direction:"rtl",children:(De=t==null?void 0:t.subBookTitle)==null?void 0:De[Oe]})]}),a.jsxs(Zt,{children:[a.jsxs(Qt,{translatestatus:t!=null&&t.noChapter&&(!(($e=(Ue=t==null?void 0:t.chapterInfos[0])==null?void 0:Ue.isTranslated)!=null&&$e[d])&&!((Me=(Le=t==null?void 0:t.chapterInfos[0])==null?void 0:Le.isTranslated)!=null&&Me[r])||!((Fe=(ze=t==null?void 0:t.chapterInfos[0])==null?void 0:ze.isPublished)!=null&&Fe[d])&&!((Ke=(He=t==null?void 0:t.chapterInfos[0])==null?void 0:He.isPublished)!=null&&Ke[r]))?"none":(!((We=(Ge=t==null?void 0:t.chapterInfos[0])==null?void 0:Ge.isTranslated)!=null&&We[d])||!((Ye=(Ve=t==null?void 0:t.chapterInfos[0])==null?void 0:Ve.isTranslated)!=null&&Ye[r]))&&((Xe=(qe=t==null?void 0:t.chapterInfos[0])==null?void 0:qe.isPublished)!=null&&Xe[d]||!((Qe=(Ze=t==null?void 0:t.chapterInfos[0])==null?void 0:Ze.isPublished)!=null&&Qe[r]))?"one":"both",children:[a.jsx(oe,{fontFamily:'"Baloo Da 2"',color:P,children:(Je=t==null?void 0:t.subBookTitle)==null?void 0:Je[J]}),(t==null?void 0:t.subBookNumber)==0&&a.jsx(Jt,{src:O.icon_intro})]}),e.currentUser&&y!==0&&!(t!=null&&t.noChapter)&&a.jsx(oe,{fontFamily:'"Baloo Da 2"',color:j,children:`${y}%`})]})]}),a.jsxs(pt,{isdownloaded:h?"true":"false",children:[a.jsx(xt,{src:h?N==K.DEFAULT||N==K.EASY_OCEAN?O.download_cancel:O.download_cancel_white:N==K.DEFAULT||N==K.EASY_OCEAN?O.download:O.download_white,onClick:()=>p(F)}),h&&a.jsx(xt,{src:N==K.DEFAULT||N==K.EASY_OCEAN?O.download_refresh:O.download_refresh_white,onClick:()=>e.onDownloadRefresh(F)})]})]}),m&&a.jsxs(eo,{style:{backgroundColor:M},children:[a.jsx(to,{children:a.jsx(oe,{fontFamily:"Inter",color:E,children:((tt=(et=(pe=e.terms)==null?void 0:pe.texts.find(s=>s.variable=="Chapter"))==null?void 0:et.text)==null?void 0:tt[r])||""})}),a.jsx(oo,{children:o==null?void 0:o.map((s,H)=>{var W,G,z,D,te,ne,Se,ot,st,at,nt,it,lt,rt,dt,ct;return s.chapterNumber==0?a.jsx(kt,{translatestatus:!((W=s==null?void 0:s.isTranslated)!=null&&W[d])&&!((G=s==null?void 0:s.isTranslated)!=null&&G[r])||!((z=s==null?void 0:s.isPublished)!=null&&z[d])&&!((D=s==null?void 0:s.isPublished)!=null&&D[r])?"none":(!((te=s==null?void 0:s.isTranslated)!=null&&te[d])||!((ne=s==null?void 0:s.isTranslated)!=null&&ne[r]))&&((Se=s==null?void 0:s.isPublished)!=null&&Se[d]||!((ot=s==null?void 0:s.isPublished)!=null&&ot[r]))?"one":"both",readalready:$&&$.length>0&&$.includes(s.chapterId)?"true":"false",style:{backgroundColor:C,color:P},readbgcolor:j,readtextcolor:A,onClick:()=>{var ge,xe,ke,me,fe,ve,ye,Be;return u(s.chapterId,!((ge=s==null?void 0:s.isTranslated)!=null&&ge[d])&&!((xe=s==null?void 0:s.isTranslated)!=null&&xe[r])||!((ke=s==null?void 0:s.isPublished)!=null&&ke[d])&&!((me=s==null?void 0:s.isPublished)!=null&&me[r])?"none":(!((fe=s.isTranslated)!=null&&fe[d])||!((ve=s==null?void 0:s.isTranslated)!=null&&ve[r]))&&((ye=s==null?void 0:s.isPublished)!=null&&ye[d]||!((Be=s==null?void 0:s.isPublished)!=null&&Be[r]))?"one":"both")},children:a.jsx(so,{src:O.icon_intro})},H):a.jsx(kt,{translatestatus:!((st=s==null?void 0:s.isTranslated)!=null&&st[d])&&!((at=s==null?void 0:s.isTranslated)!=null&&at[r])||!((nt=s==null?void 0:s.isPublished)!=null&&nt[d])&&!((it=s==null?void 0:s.isPublished)!=null&&it[r])?"none":(!((lt=s==null?void 0:s.isTranslated)!=null&&lt[d])||!((rt=s==null?void 0:s.isTranslated)!=null&&rt[r]))&&((dt=s==null?void 0:s.isPublished)!=null&&dt[d]||!((ct=s==null?void 0:s.isPublished)!=null&&ct[r]))?"one":"both",readalready:$&&$.length>0&&$.includes(s.chapterId)?"true":"false",style:{backgroundColor:C,color:P},readbgcolor:j,readtextcolor:A,onClick:()=>{var ge,xe,ke,me,fe,ve,ye,Be;return u(s.chapterId,!((ge=s==null?void 0:s.isTranslated)!=null&&ge[d])&&!((xe=s==null?void 0:s.isTranslated)!=null&&xe[r])||!((ke=s==null?void 0:s.isPublished)!=null&&ke[d])&&!((me=s==null?void 0:s.isPublished)!=null&&me[r])?"none":(!((fe=s.isTranslated)!=null&&fe[d])||!((ve=s.isTranslated)!=null&&ve[r]))&&(!((ye=s==null?void 0:s.isPublished)!=null&&ye[d])||!((Be=s==null?void 0:s.isPublished)!=null&&Be[r]))?"one":"both")},children:a.jsx(oe,{fontFamily:"Inter",fontWeight:"500",textAlign:"center",children:s.chapterNumber})},H)})})]})]})}function Go(e){const[o,n]=b.useState([]);return b.useEffect(()=>{let t=e.subBooks;t&&t.sort((g,m)=>g.subBookNumber-m.subBookNumber),n(t)},[e.subBooks]),a.jsx(a.Fragment,{children:o&&o.length>0&&o.map((t,g)=>a.jsx(Ko,{id:`subbook-${t.subBookId}`,bookId:e.bookId,bookTitle:e.bookTitle,bookImage:e.bookImage,subBooks:o,subBookId:t.subBookId,subBookInfos:e.subBookInfos,currentUser:e.currentUser,userHistory:e.userHistory,openedSubBook:e.openedSubBook,terms:e.terms,moveToReading:e.moveToReading,onDownload:e.onDownload,onDownloadRefresh:e.onDownloadRefresh,handleOpenedSubBook:e.handleOpenedSubBook},g))})}function Wo(e){const[o,n]=b.useState(""),[t,g]=b.useState([]),[m,B]=b.useState(1),[h,_]=b.useState([]),{theme:y,readingLanguage:S}=b.useContext(Pe),{backgroundColor:N,topTextColor:d,mainTextColor:r}=Ee(y),C=So(e.deviceHeight),P=m*C,M=P-C,E=e.currentUser&&t.slice(M,P);b.useEffect(()=>{var x,u,T,i,l,c;if(e.subBooks&&e.subBooks.length>0){const f=e.subBooks.map(k=>{var v;return{label:(v=k.subBookTitle)==null?void 0:v[S],value:k.subBookId}});f.unshift({label:((x=e.bookTitle)==null?void 0:x.en)=="Qur'an"||((u=e.bookTitle)==null?void 0:u.en)=="Zabur"?(i=(T=e.terms.texts.find(k=>k.variable=="All Chapters"))==null?void 0:T.text)==null?void 0:i[S]:(c=(l=e.terms.texts.find(k=>k.variable=="All SubBooks"))==null?void 0:l.text)==null?void 0:c[S],value:"all"}),_(f)}},[e.subBooks]),b.useEffect(()=>{h.length>0&&n(h[0].value)},[h]),b.useEffect(()=>{if(e.bookmark&&e.bookmark.length>0){const x=e.bookmark.filter(u=>u.subBookId===o);g(o==="all"||o===""?e.bookmark:x)}else g([]),B(0);m>1&&E.length==1&&B(x=>x-1)},[e.bookmark]);const j=(x,u)=>{B(u)},A=b.useCallback(x=>{const u=x.target.value;n(u);const T=e.bookmark.filter(i=>i.subBookId===u);g(u==="all"?e.bookmark:T)},[e.bookmark]),J=()=>{var x,u,T,i;return a.jsx(no,{style:{backgroundColor:N},children:a.jsx(Co,{label:((u=(x=e.terms.texts.find(l=>l.variable=="Filter"))==null?void 0:x.text)==null?void 0:u[S])||"",detail:a.jsxs(io,{children:[a.jsx(oe,{color:d,children:(i=(T=e.terms.texts.find(l=>l.variable=="Show"))==null?void 0:T.text)==null?void 0:i[S]}),a.jsx(ho,{label:"",options:h,value:o,backgroundColor:N,textColor:d,onChange:A})]})})})},$=()=>a.jsx(lo,{children:(E==null?void 0:E.length)>0&&E.map((x,u)=>{var T,i,l,c,f,k,v,w,R,Z,I,ee,se,ae,ce,ue,be;return a.jsxs(wt,{children:[a.jsxs(ro,{children:[a.jsxs(co,{onClick:()=>e.moveToReadingFromBookmark(x._id),children:[a.jsx(oe,{color:r,children:(T=x.subBookTitle)==null?void 0:T[S]}),a.jsx(oe,{color:r,children:x.bookTitle.en=="Qur'an"||x.bookTitle.en=="Zabur"?x.chapterNumber>0?`${(l=(i=e.terms.texts.find(L=>L.variable=="Surah Bookmark"))==null?void 0:i.text)==null?void 0:l[S]} ${x.chapterNumber}, ${(f=(c=e.terms.texts.find(L=>L.variable=="Aya"))==null?void 0:c.text)==null?void 0:f[S]} ${x.verseNumber}`:`${(v=(k=e.terms.texts.find(L=>L.variable=="Surah Bookmark"))==null?void 0:k.text)==null?void 0:v[S]} _ , ${(R=(w=e.terms.texts.find(L=>L.variable=="Aya"))==null?void 0:w.text)==null?void 0:R[S]} ${x.verseNumber}`:x.chapterNumber>0?`${(I=(Z=e.terms.texts.find(L=>L.variable=="Chapter Bookmark"))==null?void 0:Z.text)==null?void 0:I[S]} ${x.chapterNumber}, ${(se=(ee=e.terms.texts.find(L=>L.variable=="Aya"))==null?void 0:ee.text)==null?void 0:se[S]} ${x.verseNumber}`:`${(ce=(ae=e.terms.texts.find(L=>L.variable=="Chapter Bookmark"))==null?void 0:ae.text)==null?void 0:ce[S]} _ , ${(be=(ue=e.terms.texts.find(L=>L.variable=="Aya"))==null?void 0:ue.text)==null?void 0:be[S]} ${x.verseNumber}`})]}),a.jsx(uo,{src:y==K.DEFAULT||y==K.EASY_OCEAN||y==K.EASY_SUNRISE?O.black_bookmark:O.white_bookmark,onClick:()=>e.removeBookmark(x._id)})]}),a.jsx(bo,{})]},u)})}),F=()=>a.jsx(go,{buttoncolor:r,children:a.jsx(Fo,{count:e.currentUser?Math.ceil(t.length/C):0,page:m,hidePrevButton:!0,hideNextButton:!0,onChange:j})}),p=()=>{var x,u;return a.jsxs(xo,{style:{backgroundColor:N},children:[a.jsx(ko,{src:y==K.DEFAULT||y==K.BLACK_AND_WHITE?O.swipe:y==K.EASY_OCEAN?O.swipe_easyocean:O.swipe_white}),a.jsx(mo,{style:{color:d},children:(u=(x=e.terms.texts.find(T=>T.variable=="Bookmark Help"))==null?void 0:x.text)==null?void 0:u[S]})]})};return a.jsxs(ao,{children:[J(),$(),F(),p()]})}function Vo(e){var N,d,r,C;const[o,n]=b.useState(X),{theme:t,readingLanguage:g}=b.useContext(Pe),{mainBGColor:m,headerBGColor:B,buttonColor:h,buttonTextColor:_,mainTextColor:y}=Ee(t),S=P=>{e.currentUser?n(P):V.custom(M=>{var E,j;return a.jsx(Y,{text:((j=(E=e.terms.texts.find(A=>A.variable=="Bookmark Read Description"))==null?void 0:E.text)==null?void 0:j[g])||"",visible:M.visible})})};return a.jsx(fo,{style:{backgroundColor:B},children:a.jsxs(vo,{style:{backgroundColor:m},children:[a.jsxs(yo,{children:[a.jsxs(mt,{active:o==X?"true":"false",style:{backgroundColor:o==X?h:m},bordercolor:y,onClick:()=>S(X),children:[a.jsx(ft,{src:t==K.DEFAULT?O.index:t==K.EASY_OCEAN?o==X?O.index_active:O.index:o==X?O.index:O.index_active}),a.jsx(vt,{active:o==X?"true":"false",children:a.jsx(oe,{fontSize:16,fontWeight:"500",lineHeight:24,color:o==X?_:y,children:((d=(N=e.terms.texts.find(P=>P.variable=="Index"))==null?void 0:N.text)==null?void 0:d[g])||""})})]}),a.jsxs(mt,{active:o==X?"false":"true",style:{backgroundColor:o==Ne?h:m},bordercolor:y,onClick:()=>S(Ne),children:[a.jsx(ft,{src:t==K.DEFAULT?O.bookmark2_default:t==K.EASY_OCEAN?o==X?O.bookmark2_default:O.bookmark2_white:o==X?O.bookmark2_white:O.bookmark2_default}),a.jsx(vt,{active:o==X?"false":"true",children:a.jsx(oe,{fontSize:16,fontWeight:"500",lineHeight:24,color:o==Ne?_:y,children:((C=(r=e.terms.texts.find(P=>P.variable=="Bookmarks"))==null?void 0:r.text)==null?void 0:C[g])||""})})]})]}),o==X?a.jsx(Go,{bookId:e.bookId,bookTitle:e.bookTitle,bookImage:e.bookImage,subBooks:e.subBooks,subBookInfos:e.subBookInfos,currentUser:e.currentUser,userHistory:e.userHistory,openedSubBook:e.openedSubBook,terms:e.terms,moveToReading:e.moveToReading,onDownload:e.onDownload,onDownloadRefresh:e.onDownloadRefresh,handleOpenedSubBook:e.handleOpenedSubBook}):a.jsx(Wo,{bookTitle:e.bookTitle,subBooks:e.subBooks,currentUser:e.currentUser,bookmark:e.bookmark.filter(P=>P.bookId==e.bookId),deviceHeight:e.deviceHeight,terms:e.terms,moveToReadingFromBookmark:e.moveToReadingFromBookmark,removeBookmark:e.removeBookmark})]})})}const Yo=Mt,ie=zt,qo=1;class Xo{constructor(){ut(this,"db",null)}async initDB(){return new Promise((o,n)=>{const t=indexedDB.open(Yo,qo);t.onerror=()=>n(t.error),t.onsuccess=()=>{this.db=t.result,o()},t.onupgradeneeded=g=>{g.target.result.createObjectStore(ie,{keyPath:"subBookId"})}})}async saveSubBookInfo(o){return this.db||await this.initDB(),new Promise((n,t)=>{const B=this.db.transaction([ie],"readwrite").objectStore(ie).put(o);B.onerror=()=>t(B.error),B.onsuccess=()=>n()})}async getSubBookInfo(o){return this.db||await this.initDB(),new Promise((n,t)=>{const B=this.db.transaction([ie],"readonly").objectStore(ie).get(o);B.onerror=()=>t(B.error),B.onsuccess=()=>n(B.result)})}async removeSubBookInfo(o){return this.db||await this.initDB(),new Promise((n,t)=>{const B=this.db.transaction([ie],"readwrite").objectStore(ie).delete(o);B.onerror=()=>t(B.error),B.onsuccess=()=>n()})}}const he=new Xo,Zo=de(wt)({display:"flex",flexDirection:"column",margin:"auto",position:"relative",height:"100dvh"});function Qo(e){const[o,n]=b.useState(),[t,g]=b.useState(!1),[m,B]=b.useState(),[h,_]=b.useState(),y=Wt(),{height:S}=Ho(),{theme:N,readingLanguage:d}=b.useContext(Pe),{mainBGColor:r}=Ee(N),C=localStorage.getItem(Ot)||Nt,P=b.useCallback(()=>{e.currentBook&&Ct.fetchBookInfo(e.currentBook).then(i=>{var l,c,f;if(e.dispatch({type:U.ADD_BOOKINFO,payload:{bookInfo:i}}),n(i),e.currentUser&&!e.userHistory.some(v=>v.bookId==e.currentBook)&&i.subBooks){const v=i.subBooks.find(Z=>Z.subBookNumber==0),w=(l=v==null?void 0:v.chapterInfos[0])==null?void 0:l.chapterId,R=v==null?void 0:v.subBookId;(f=(c=v==null?void 0:v.chapterInfos[0])==null?void 0:c.isTranslated)!=null&&f[C]?j(w,R):V.custom(Z=>{var I,ee,se;return a.jsx(Y,{text:((se=(ee=(I=m==null?void 0:m.texts)==null?void 0:I.find(ae=>ae.variable=="None Translated"))==null?void 0:ee.text)==null?void 0:se[d])||"",type:Ce.BOOKMARK,visible:Z.visible})})}}).catch(i=>{V.custom(l=>a.jsx(Y,{text:i,type:Ce.BOOKMARK,visible:l.visible}))}).finally(()=>{g(!1)})},[e.currentBook,e.dispatch,e.userHistory,e.currentUser]),M=b.useCallback(async i=>{var l,c,f;try{const k=await Ct.fetchSubBookInfo(i);e.dispatch({type:U.ADD_SUBBOOKINFO,payload:{subBookInfo:k}}),e.dispatch({type:U.ADD_SUBBOOK,payload:{subBook:k}}),await he.saveSubBookInfo(k);const v=(l=e.bookInfos)==null?void 0:l.find(R=>(R==null?void 0:R.bookId)==e.currentBook),w=v&&((c=v==null?void 0:v.subBooks)==null?void 0:c.find(R=>(R==null?void 0:R.subBookId)==i));if(w){const R=(f=w==null?void 0:w.subBookTitle)==null?void 0:f.en;console.log("downloaded sub books: ",R),yt("Sub books","Downloaded sub books",R)}g(!1)}catch(k){V.custom(v=>a.jsx(Y,{text:k,visible:v.visible})),g(!1)}},[e.dispatch]);b.useEffect(()=>{var c,f;const i=e.terms.find(k=>k.pageTitle=="Index & Bookmark Page"),l=e.terms.find(k=>k.pageTitle=="Welcome Page");(c=i==null?void 0:i.isPublished)!=null&&c[d]?B(i):V.custom(k=>a.jsx(Y,{text:"The terminologies for this page are not published.",visible:k.visible})),(f=l==null?void 0:l.isPublished)!=null&&f[d]?_(l):V.custom(k=>a.jsx(Y,{text:"The terminologies for hamburgur menu are not published.",visible:k.visible}))},[e.terms]),b.useEffect(()=>{(async()=>{var l;g(!0),!((l=e.bookInfos)!=null&&l.length)||!e.bookInfos.some(c=>c.bookId===e.currentBook)?await P():(n(e.bookInfos.find(c=>c.bookId===e.currentBook)),g(!1))})(),e.currentUser&&St.fetchBookmarks().then(l=>{e.dispatch({type:U.SET_BOOKMARKS,payload:{bookmark:l}})}).catch(l=>{l.status===401&&l.response.data.message===bt&&(V.custom(c=>a.jsx(Y,{text:l.response.data.message,visible:c.visible})),Re.logout(),y("/login"))})},[e.currentBook,e.bookInfos,e.currentUser,e.dispatch]),b.useEffect(()=>{if(e.currentSubBook&&e.prevPage===_e.READING){const l=setTimeout(()=>{const c=document.getElementById(`subbook-${e.currentSubBook}`);c&&c.scrollIntoView({behavior:"smooth"})},100);return()=>clearTimeout(l)}},[e.currentSubBook,e.prevPage]);const E=()=>{V.custom(i=>{var l,c,f;return a.jsx(Y,{text:((f=(c=(l=m==null?void 0:m.texts)==null?void 0:l.find(k=>k.variable=="Not Built Yet"))==null?void 0:c.text)==null?void 0:f[d])||"",visible:i.visible})})},j=(i,l)=>{var v,w,R,Z;e.dispatch({type:U.SET_CURRENT_CHAPTER,payload:{currentChapter:i}}),e.dispatch({type:U.SET_CURRENT_SUBBOOK,payload:{currentSubBook:l}}),e.dispatch({type:U.SET_PREVIOUS_PAGE,payload:{prevPage:_e.BOOKS}});const c=(v=e.bookInfos)==null?void 0:v.find(I=>(I==null?void 0:I.bookId)==e.currentBook),f=c&&((w=c==null?void 0:c.subBooks)==null?void 0:w.find(I=>(I==null?void 0:I.subBookId)==l)),k=(R=f==null?void 0:f.chapterInfos)==null?void 0:R.find(I=>(I==null?void 0:I.chapterId)==i);if(f){const I=(Z=f==null?void 0:f.subBookTitle)==null?void 0:Z.en,ee=k==null?void 0:k.chapterNumber;console.log("read chapter: ",I,ee),yt("Chapter","Read Chapter",`${I}-${ee}`)}y("/reading")},A=()=>{y("/library"),e.dispatch({type:U.SET_PREVIOUS_PAGE,payload:{prevPage:_e.BOOKS}}),e.dispatch({type:U.SET_CURRENT_SUBBOOK,payload:{currentSubBook:""}})},J=b.useCallback(async i=>{g(!0),Bt()<gt?await he.getSubBookInfo(i)?(await he.removeSubBookInfo(i),e.dispatch({type:U.REMOVE_SUBBOOKINFO,payload:{subBookId:i}})):await M(i):V.custom(c=>{var f,k,v;return a.jsx(Y,{text:((v=(k=(f=m==null?void 0:m.texts)==null?void 0:f.find(w=>w.variable=="Not Enough Space"))==null?void 0:k.text)==null?void 0:v[d])||"",visible:c.visible})}),g(!1)},[M,e.dispatch]),$=b.useCallback(async i=>{g(!0),await he.removeSubBookInfo(i),e.dispatch({type:U.REMOVE_SUBBOOKINFO,payload:{subBookId:i}}),Bt()<gt?await M(i):V.custom(c=>{var f,k,v;return a.jsx(Y,{text:((v=(k=(f=m==null?void 0:m.texts)==null?void 0:f.find(w=>w.variable=="Not Enough Space"))==null?void 0:k.text)==null?void 0:v[d])||"",visible:c.visible})}),g(!1)},[M,e.dispatch]),F=b.useCallback(i=>{if(g(!0),e.bookmark&&e.bookmark.length>0){const l=e.bookmark.find(c=>c._id===i);if(l){const{chapterId:c,subBookId:f,verseId:k}=l;e.dispatch({type:U.SET_CURRENT_SUBBOOK,payload:{currentSubBook:f}}),e.dispatch({type:U.SET_CURRENT_CHAPTER,payload:{currentChapter:c}}),e.dispatch({type:U.SET_CURRENT_VERSE,payload:{currentVerse:k}}),y("/reading"),g(!1)}}},[e.currentBook,y,e.bookmark]),p=b.useCallback(i=>{g(!0),St.deleteBookmark(i).then(l=>{e.dispatch({type:U.REMOVE_BOOKMARK,payload:{bookmarkId:i}}),V.custom(c=>a.jsx(Y,{text:l.message,type:Ce.BOOKMARK,visible:c.visible})),g(!1)}).catch(l=>{l.status==401&&l.response.data.message==bt&&(V.custom(c=>a.jsx(Y,{text:l.response.data.message,type:Ce.BOOKMARK,visible:c.visible})),Re.logout(),y("/login")),g(!1)})},[e.dispatch]),x=b.useCallback(i=>{e.dispatch({type:U.SET_CURRENT_SUBBOOK,payload:{currentSubBook:e.currentSubBook===i?"":i}})},[e.currentSubBook,e.dispatch]),u=()=>{e.dispatch({type:U.RESET_USER}),e.dispatch({type:U.RESET_BOOK}),e.dispatch({type:U.RESET_PAGE_STATUS}),Re.logout()},T=()=>{y("/login")};return a.jsxs(Zo,{style:{backgroundColor:r},children:[a.jsx(Bo,{markImg:o&&Ft+o.bookImage,markTitle:o==null?void 0:o.bookTitle,isLogIn:!!e.currentUser,terms:m||{pageId:"",pageNumber:0,pageTitle:"",isCompleted:{},isPublished:{},texts:[]},welcomePageTerms:h||{pageId:"",pageNumber:0,pageTitle:"",isCompleted:{},isPublished:{},texts:[]},onLogoClick:()=>y("/"),onCloseClick:A,onLogin:e.currentUser?u:T,onSettings:()=>y("/settings"),onSearchClick:E}),a.jsx(Vo,{bookId:e.currentBook,bookTitle:o==null?void 0:o.bookTitle,bookImage:o==null?void 0:o.bookImage,subBooks:o==null?void 0:o.subBooks,deviceHeight:S,subBookInfos:e.subBookInfos,userHistory:e.userHistory,currentUser:e.currentUser,bookmark:e.bookmark,openedSubBook:e.currentSubBook,terms:m||{pageId:"",pageNumber:0,pageTitle:"",isCompleted:{},isPublished:{},texts:[]},moveToReading:j,moveToReadingFromBookmark:F,onDownload:J,onDownloadRefresh:$,removeBookmark:p,handleOpenedSubBook:x}),t&&a.jsx(To,{})]})}function Jo(e){return{userHistory:e.books.userHistory,bookmark:e.books.bookmark,subBookInfos:e.books.subBookInfos,bookInfos:e.books.bookInfos,terms:e.terms.terms,currentBook:e.pageStatus.currentBook,currentBookPageOpenTab:e.pageStatus.currentBookPageOpenTab,currentSubBook:e.pageStatus.currentSubBook,prevPage:e.pageStatus.prevPage,currentUser:e.user.currentUser,activeChapterId:e.books.activeChapterId}}const gs=Gt(Jo)(Qo);export{gs as default};

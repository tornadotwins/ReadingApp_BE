import{b as a,j as o,Q as S,af as se}from"./index-BPBmJKVk.js";import{S as O,g as H,aK as ae,aL as ie,aM as ce,s as c,B as b,c as le,u as de,d as A,_ as ue}from"./App-Dev0GCGR.js";import{I as C,T as k}from"./index-DlIwGATM.js";import{B as $}from"./Button-DOOr7d70.js";import{S as Q}from"./index-BOR57ny4.js";import{b as q}from"./book.service-B2LodF4F.js";import{L as he}from"./index-DLzK3n8H.js";import{C as be}from"./index-CwWiJf4K.js";import"./index-DwBTVcqI.js";import"./axios-BimPEqV4.js";function V(e){const{theme:i}=a.useContext(O),{textColor:l}=H(i);return o.jsxs(o.Fragment,{children:[o.jsx(ae,{children:o.jsx(ie,{value:e.value,size:e.size=="small"?"small":"medium",type:e.type,style:{color:l},bordercolor:l,onChange:e.onChange,onBlur:e.onBlur})}),e.error&&o.jsx(ce,{children:e.error})]})}const xe=c(b)({width:"100%",display:"flex",justifyContent:"center",alignItems:"center",boxSizing:"border-box"}),ge=c(b)(({backgroundcolor:e})=>({width:"100%",backgroundColor:e,boxSizing:"border-box",display:"flex"})),fe=c("img")({width:"100%",marginTop:"57px"}),ke=c(b)({display:"flex",alignItems:"baseline",justifyContent:"space-between",position:"absolute",left:"30px",top:"30px",width:"calc(100% - 60px)"}),me=c(b)({display:"flex",alignItems:"baseline"}),Se=c(b)({width:"70px",cursor:"pointer",position:"relative","& div":{position:"absolute",top:"28px",width:"100%",textAlign:"center",maxWidth:"65px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none"}}),Ce=c("img")({width:"100%",height:"100%"}),Be=c(b)({margin:0,marginLeft:"12px",position:"relative",top:"-20px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none"}),pe=c(b)({position:"absolute",top:"60px",left:"50%",transform:"translate(-50%, -50%)",cursor:"pointer"}),Ie=c("img")({width:"100%","&:active":{opacity:"0.8"}}),Y=c(b)(({backgroundcolor:e})=>({height:"calc(100dvh - 145px)",width:"100%",position:"absolute",top:"145px",padding:"0px 30px",backgroundColor:e,"@media screen and (orientation: landscape)":{height:"calc(100dvh - 145px)"}})),Z=c(b)(({backgroundcolor:e})=>({backgroundColor:e,height:"calc(100dvh - 145px)",position:"relative",zIndex:"1",display:"flex",flexDirection:"column",padding:"20px",overflowY:"scroll",paddingTop:"100px",justifySelf:"center","@media screen and (orientation: landscape)":{height:"calc(100dvh - 145px)"}})),w=c(b)({display:"flex",alignItems:"center",margin:"10px",maxWidth:"350px",minWidth:"300px","& .MuiBox-root:first-of-type":{width:"50%",paddingRight:"20px"},"& .MuiInputBase-root":{width:"100% !important",backgroundColor:"#FFF"},"& :nth-of-type(2)":{width:"50%","& .MuiBox-root":{paddingRight:"0px"},"& .MuiFormControl-root":{width:"60px","& .MuiInputBase-root":{width:"100% !important",backgroundColor:"#FFF"},"& .css-mat3fe-MuiInputBase-root-MuiOutlinedInput-root-MuiSelect-root":{width:"unset !important",backgroundColor:"#FFF"},"& .MuiSelect-select":{width:"100% !important",padding:"0px !important",backgroundColor:"#FFF"},"& input":{width:"100%",padding:"8px 12px",backgroundColor:"#FFF",textAlign:"center"}}}}),L=c(b)({display:"flex",justifyContent:"space-between",alignItems:"center"}),J=c(b)(({bordercolor:e})=>({display:"flex",justifyContent:"center",marginTop:"30px","& button":{border:`1px solid ${e}`}})),ye=e=>{var v;const{theme:i,readingLanguage:l}=a.useContext(O),{logoTextColor:u,mainBGColor:j}=H(i);return o.jsxs(ge,{backgroundcolor:j,children:[o.jsx(fe,{src:i==S.DEFAULT||i==S.DARK?C.book_subtract:i==S.BLACK_AND_WHITE?C.book_subtract_BAW:i==S.SAPPHIRE?C.book_subtract_sapphire:C.book_subtract_easyocean}),o.jsx(ke,{children:o.jsxs(me,{children:[o.jsx(Se,{onClick:e.onClickCover,children:o.jsx(Ce,{src:e.bookCover})}),o.jsx(Be,{children:o.jsx(k,{fontFamily:"Buenard",fontWeight:"700",fontSize:36,lineHeight:47,textAlign:"center",color:u,children:(v=e.bookTitle)==null?void 0:v[l||"en"]})})]})}),o.jsx(pe,{children:o.jsx(Ie,{src:i==S.DEFAULT||i==S.DARK?C.close2:i==S.BLACK_AND_WHITE?C.close2_BAW:i==S.SAPPHIRE?C.close2_sapphire:C.close2_easyocean,onClick:e.onClickClose})})]})};function je(e){const{theme:i}=a.useContext(O),{headerBGColor:l,logoTextColor:u,mainBGColor:j}=H(i),v=()=>{var h,B,T,E;return!e.isSpecialBook&&o.jsx(Y,{backgroundcolor:l,children:o.jsxs(Z,{backgroundcolor:l,children:[o.jsxs(w,{children:[o.jsx(k,{color:u,textAlign:"right",children:"Go to sub book: "}),o.jsx(Q,{label:"",options:e.subBookOptions,value:e.subBook,onChange:m=>e.onSubBookChange(m.target.value)})]}),o.jsxs(w,{color:u,children:[o.jsx(k,{color:u,textAlign:"right",children:"Go to chapter: "}),o.jsxs(L,{children:[o.jsx(V,{type:"Number",value:e.chapterNumber,onChange:e.onChapterChange}),o.jsx(k,{color:u,fontSize:13,children:`(${(((B=(h=e.selectedSubBookInfo)==null?void 0:h.chapterInfos)==null?void 0:B.length)||0).toString()} chapters)`})]})]}),o.jsxs(w,{children:[o.jsx(k,{color:u,textAlign:"right",children:"Go to aya: "}),o.jsxs(L,{children:[o.jsx(V,{type:"Number",value:e.verseNumber,onChange:e.onVerseChange}),o.jsx(k,{color:u,fontSize:13,children:`(${(((E=(T=e.selectedChapterInfo)==null?void 0:T.verses)==null?void 0:E.length)||0).toString()} ayat)`})]})]}),o.jsx(J,{bordercolor:j,children:o.jsx($,{label:"Go",onClick:e.onGo})})]})})},F=()=>{var h,B;return e.isSpecialBook&&o.jsx(Y,{backgroundcolor:l,children:o.jsxs(Z,{backgroundcolor:l,children:[o.jsxs(w,{children:[o.jsx(k,{color:u,textAlign:"right",children:"Go to Surah: "}),o.jsx(Q,{label:"",options:e.subBookOptions,value:e.subBook,onChange:T=>e.onSubBookChange(T.target.value)})]}),o.jsxs(w,{children:[o.jsx(k,{color:u,textAlign:"right",children:"Go to aya: "}),o.jsxs(L,{children:[o.jsx(V,{type:"Number",value:e.verseNumber,onChange:e.onVerseChange}),o.jsx(k,{color:u,fontSize:13,children:`(${(((B=(h=e.selectedChapterInfo)==null?void 0:h.verses)==null?void 0:B.length)||0).toString()} ayat)`})]})]}),o.jsx(J,{bordercolor:j,children:o.jsx($,{label:"Go",onClick:e.onGo})})]})})};return o.jsxs(o.Fragment,{children:[F(),v()]})}function ve(e){const[i,l]=a.useState(!1),[u,j]=a.useState({en:"",ar:""}),[v,F]=a.useState(""),[h,B]=a.useState(),[T,E]=a.useState([]),[m,z]=a.useState(e.currentSubBook),[N,M]=a.useState("1"),[D,R]=a.useState("1"),[p,X]=a.useState(),[I,P]=a.useState(),G=de();a.useEffect(()=>{const n=e.bookInfos.find(s=>s.bookId==e.currentBook);B(n);const t=(n==null?void 0:n.bookTitle)||{en:"",ar:""},r=(n==null?void 0:n.bookImage)||"";j(t),F(se+r)},[e.bookInfos]);const ee=()=>o.jsx(ye,{bookCover:v,bookTitle:u,onClickCover:()=>G("/library"),onClickClose:()=>G(-1)});a.useEffect(()=>{const n=e.bookInfos.find(t=>t.bookId==e.currentBook);if(n!=null&&n.subBooks){const t=n.subBooks.map(r=>{var s;return{label:(s=r.subBookTitle)==null?void 0:s.en,value:r.subBookId}});E(t)}else E([])},[e.bookInfos,e.currentBook]);const oe=()=>{var d,y,_,g,W,U,K;const n=(d=e.bookInfos)==null?void 0:d.find(f=>f.bookId==e.currentBook),t=(y=n==null?void 0:n.subBooks)==null?void 0:y.find(f=>f.subBookId==m),r=(_=t==null?void 0:t.chapterInfos)==null?void 0:_.find(f=>f.chapterNumber==Number(N)),s=r==null?void 0:r.chapterId,x=((K=(U=(W=(g=e.chapterInfos)==null?void 0:g.find(f=>f.chapterId==s))==null?void 0:W.verses)==null?void 0:U.find(f=>f.verseNumber==Number(D)))==null?void 0:K.verseId)||"";e.dispatch({type:A.SET_CURRENT_SUBBOOK,payload:{currentSubBook:m}}),e.dispatch({type:A.SET_CURRENT_CHAPTER,payload:{currentChapter:s}}),e.dispatch({type:A.SET_CURRENT_VERSE,payload:{currentVerse:x}}),G("/reading")},te=n=>{var t;p&&Number(n)<=((t=p.chapterInfos)==null?void 0:t.length)&&M(n)},ne=n=>{var t;I&&Number(n)<=((t=I.verses)==null?void 0:t.length)&&R(n)};a.useEffect(()=>{var x,d,y,_;const n=(x=e.bookInfos)==null?void 0:x.find(g=>g.bookId==e.currentBook),t=(d=n==null?void 0:n.subBooks)==null?void 0:d.find(g=>g.subBookId==e.currentSubBook),r=(y=t==null?void 0:t.chapterInfos)==null?void 0:y.find(g=>g.chapterId==e.currentChapter),s=(_=I==null?void 0:I.verses)==null?void 0:_.find(g=>g.verseId==e.currentVerse);z(e.currentSubBook),M(((r==null?void 0:r.chapterNumber)||1).toString()),R((s!=null&&s.verseNumber?(s==null?void 0:s.verseNumber)+1:1).toString())},[e.currentSubBook,e.currentChapter,e.currentVerse,e.bookInfos,I]),a.useEffect(()=>{var r,s;const n=(r=e.bookInfos)==null?void 0:r.find(x=>x.bookId==e.currentBook),t=(s=n==null?void 0:n.subBooks)==null?void 0:s.find(x=>x.subBookId==m);X(t),M("1"),R("1")},[m]),a.useEffect(()=>{N&&(()=>{var s,x;const t=(s=p==null?void 0:p.chapterInfos)==null?void 0:s.find(d=>d.chapterNumber==Number(N));t!=null&&t.chapterId&&q.fetchVerses(t.chapterId);const r=(x=e.chapterInfos)==null?void 0:x.find(d=>d.chapterId==(t==null?void 0:t.chapterId));r?(P(r),l(!1)):t!=null&&t.chapterId?q.fetchVerses(t==null?void 0:t.chapterId).then(d=>{e.dispatch({type:A.ADD_CHAPTERINFO,payload:{chapterInfo:d}}),P(d),l(!1)}).catch(d=>{ue.custom(y=>o.jsx(be,{text:d,offset:70,visible:y.visible})),l(!1)}):l(!1)})()},[p,m,N]);const re=()=>{var n,t;return o.jsx(je,{subBookOptions:T,subBook:m,chapterNumber:N,verseNumber:D,selectedSubBookInfo:p,selectedChapterInfo:I,isSpecialBook:((n=h==null?void 0:h.bookTitle)==null?void 0:n.en)=="Qur'an"||((t=h==null?void 0:h.bookTitle)==null?void 0:t.en)=="Zabur",onSubBookChange:r=>z(r),onChapterChange:r=>te(r.target.value),onVerseChange:r=>ne(r.target.value),onGo:oe})};return o.jsxs(xe,{children:[ee(),re(),i&&o.jsx(he,{})]})}const Te=e=>({bookInfos:e.books.bookInfos,subBooks:e.books.subBooks,chapterInfos:e.books.chapterInfos,currentBook:e.pageStatus.currentBook,currentSubBook:e.pageStatus.currentSubBook,currentChapter:e.pageStatus.currentChapter,currentVerse:e.pageStatus.currentVerse}),Le=le(Te)(ve);export{Le as default};

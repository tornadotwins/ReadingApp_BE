import{j as t,a as c}from"./createTheme-fJ5dSSTW.js";import{O as pe,P as he,R as ye,U as a,q as T,T as y,I as R,s,B as d,t as me,K as fe,u as Ce,F as p,A as B,H as I,Q as Se,E as we,w as be}from"./App-CaXAlDue.js";import{j as P,d as je}from"./journey.services-D06kxDvV.js";import{a as ve,I as D,g as Be}from"./images-M0PcT3Ux.js";import{T as Ie,B as Te}from"./index-T3QODVv0.js";import{b as U,J as ke,A as Ee,o as De,S as Je}from"./index-CmQlESKK.js";import{S as N}from"./index-DzM1rMAl.js";import{d as Ae,a as Le}from"./ArrowDownward-Dge7l5q7.js";import{b as Oe}from"./book.services-Boz4u9QW.js";const _e=pe("MuiBox",["root"]),l=he({defaultClassName:_e.root,generateClassName:ye.generate}),Fe=a(l)({position:"relative",minHeight:"100vh",width:"100%","& >.MuiBox-root:first-of-type":{backgroundColor:"#1B7695","& >.MuiBox-root":{color:"#F6FCFC"}}}),Me=a(l)({width:"100%",height:"calc(100% - 73px)",margin:"auto",marginTop:"73px"}),Re=a(l)({margin:"20px 40px"}),Pe=a(l)({width:"600px",display:"flex",justifyContent:"space-between",alignItems:"center",margin:"20px 40px 0px 40px","& .MuiFormControl-root":{width:"unset",marginLeft:"15px"},"& .MuiBox-root":{fontFamily:'"Baloo Da 2" !important'},"@media screen and (max-width: 670px)":{width:"unset"}}),Ue=a(l)({display:"flex",alignItems:"center",margin:"20px 40px 0px 40px","& > .MuiBox-root: first-of-type":{marginRight:"20px"},"@media screen and (max-width: 800px)":{flexDirection:"column",width:"100%"}}),H=a(l)({display:"flex",justifyContent:"center",alignItems:"center",width:"160px !important",padding:"5px 10px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:"#FFAA5D",cursor:"pointer",button:{width:"100%"},"&:hover":{backgroundColor:"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",fontWeight:"600 !important",textTransform:"none","&:hover":{backgroundColor:"#EE994C"}}}),He=a(l)({display:"flex",alignItems:"start"}),ze=a(l)({display:"flex",flexDirection:"column",width:"600px",margin:"20px 40px 0px 40px"}),Ne=a(l)({display:"flex",alignItems:"center",cursor:"pointer",transform:".25s all ease","& svg":{fill:"#155D74",marginRight:"10px"},"& .MuiBox-root":{userSelect:"none"},"&:hover":{"& .MuiBox-root":{color:"#266E85"},"& svg":{fill:"#266E85"}}}),We=a(l)({display:"flex",flexDirection:"column",alignItems:"center",boxSizing:"border-box",width:"100%",marginTop:"10px"}),$e=a(l)({display:"flex",flexDirection:"column",width:"400px",margin:"20px 40px 0px 40px"}),Ge=a(l)({display:"flex",alignItems:"center",width:"100%",marginBottom:"20px","& .MuiBox-root":{userSelect:"none"}}),Ye=a(l)({display:"flex",width:"100%",boxSizing:"border-box",border:"1px solid #000"}),Ke=a(l)({width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}),qe=a(l)({width:"150px",display:"flex",alignItems:"center","& .MuiFormControl-root":{width:"unset",marginLeft:"0px !important"},"& .MuiBox-root":{fontFamily:'"Baloo Da 2" !important'},"@media screen and (max-width: 670px)":{width:"unset"}});a(l)({width:"120px",display:"flex",alignItems:"center",justifyContent:"space-between"});const Qe=a(l)(({isdisable:e})=>({display:"flex",justifyContent:"center",alignItems:"center",width:"160px !important",marginRight:"0px !important",padding:"5px 10px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",cursor:e=="true"?"not-allowed":"pointer",button:{width:"100%"},"&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",fontWeight:"600 !important",textTransform:"none","&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"}}}));function Xe(e){return t.jsxs(Ke,{children:[t.jsx(qe,{children:t.jsx(N,{label:"",options:e.availableLanguages,value:e.currentLanguage,backgroundColor:"#fff",textColor:"#155D74",onChange:e.handleLanguageChange})}),t.jsx(Qe,{isdisable:e.enableSaveBtn?"false":"true",children:t.jsx(T,{label:"Save Changes",disabled:!e.enableSaveBtn,onClick:e.handleSavePreference})})]})}const Ve=a(l)({backgroundColor:"#F1F5FB",color:"#155D74",boxSizing:"border-box",padding:"10px",margin:"10px 0px",border:"1px solid #3C7493",borderRadius:"5px",width:"100%"}),J=a(l)({display:"flex",justifyContent:"space-between",alignItems:"center",margin:"10px 0px"}),A=a(l)({display:"flex",alignItems:"center",marginRight:"15px",minWidth:"100px","& .MuiBox-root":{clear:"both",display:"inline-block",overflow:"hidden",whiteSpace:"nowrap"},"& > .MuiBox-root: first-of-type":{marginRight:"5px"},"@media screen and (max-width: 480px)":{minWidth:"70px",marginRight:"5px"}}),z=a(l)({display:"flex",width:"100%",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",backgroundColor:"#FFF",fontFamily:"Inter",fontSize:"16px",lineHeight:"24px",fontWeight:"500",color:"#000",outline:"none","& .MuiBox-root":{padding:"0",width:"100%","& textarea":{width:"100%",fontFamily:"Inter",fontSize:"16px",padding:"7px 10px",border:"1px solid #155D74",borderRadius:"4px"}},"& .MuiFormControl-root":{width:"100% !important",borderRadius:"4px","& .MuiInputBase-input":{fontFamily:"Inter",'&[type="text"]':{paddingLeft:"10px",paddingRight:"10px"}},"& .MuiInputBase-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.6)"}},'& input[type="file"]':{cursor:"pointer",minWidth:"50px"},"& p":{display:"none"},"@media screen and (max-width: 600px)":{flexDirection:"column"},"@media screen and (max-width: 460px)":{"& .MuiInputBase-root input":{textOverflow:"ellipsis",overflow:"hiddeon",whiteSpace:"nowrap"}}}),Ze=a(l)({display:"flex",justifyContent:"start",alignItems:"center",width:"100%",borderRadius:"4px",border:"1px solid #155D74","& .MuiInputBase-root":{width:"100%",backgroundColor:"#FFF"}}),et=a(l)(({isdisable:e})=>({display:"flex",justifySelf:"end",alignItems:"center",width:"160px !important",padding:"3px 8px",boxSizing:"border-box",border:"1px solid #474747",borderRadius:"5px",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",cursor:e=="true"?"not-allowed":"pointer",button:{width:"100%"},"&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",fontWeight:"600 !important",textTransform:"none","&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"}}})),tt=a(l)({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"}),nt=a(l)({display:"flex",alignItems:"center"}),L=a(l)(({isdisabled:e})=>({display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",padding:"5px",border:"1px solid #155D74",borderRadius:"4px",marginLeft:"5px",opacity:e=="true"?".8":"1","&:hover":{cursor:e=="true"?"not-allowed":"pointer",backgroundColor:e=="true"?"":"#155D74","& svg":{fill:e=="true"?"":"white"},"& .MuiBox-root":{color:e=="true"?"":"white"}}}));function ot(e){return t.jsxs(tt,{children:[t.jsx(y,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.title}),t.jsxs(nt,{children:[t.jsx(L,{isdisabled:e.disableMoveUp?"true":"false",onClick:()=>e.disableMoveUp?{}:e.onMoveUp(e.blockIndex),children:t.jsx(Ae,{})}),t.jsx(L,{isdisabled:e.disableMoveDown?"true":"false",onClick:()=>e.disableMoveDown?{}:e.onMoveDown(e.blockIndex),children:t.jsx(Le,{})}),t.jsx(L,{isdisabled:e.disableDelete?"true":"false",onClick:()=>e.disableDelete?{}:e.onDelete(),children:t.jsx(y,{children:"Delete"})})]})]})}function rt(e){return t.jsxs(Ve,{children:[t.jsx(ot,{title:e.isArticle?"Article Block":"Directory Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(J,{children:[t.jsx(A,{children:t.jsx(y,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:ve(e.language)+" Title:"})}),t.jsx(z,{children:t.jsx(R,{type:"text",placeholder:"Enter Title",value:e.title,onChange:h=>e.onTitleChange(h.target.value)})})]}),t.jsxs(J,{children:[t.jsx(A,{children:t.jsx(y,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Series Title:"})}),t.jsx(z,{children:t.jsx(R,{type:"text",placeholder:"Enter Series Title",value:e.seriesTitle,onChange:h=>e.onSeriesTitleChange(h.target.value)})})]}),t.jsxs(J,{children:[t.jsx(A,{children:t.jsx(y,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Series Logo:"})}),t.jsx(Ze,{children:t.jsx(N,{label:"",value:e.seriesLogo,options:e.seriesLogoOptions,onChange:h=>e.onSeriesLogoChange(h)})})]}),t.jsx(et,{isdisable:e.disableOpen?"true":"false",children:t.jsx(T,{label:e.isArticle?"Open Article":"Open Directory",disabled:e.disableOpen,onClick:e.onOpen})})]})}const it=s(d)({display:"flex",flexDirection:"column",margin:"auto",position:"relative",height:"100dvh"}),at=s(d)({display:"flex",position:"relative",width:"100%"}),lt=s("img")({width:"100%",marginTop:"57px"}),st=s(d)({display:"flex",alignItems:"baseline",justifyContent:"space-between",position:"absolute",left:"30px",top:"30px",width:"calc(100% - 60px)"}),dt=s(d)({display:"flex",flexDirection:"column"}),ct=s(d)({width:"40px",cursor:"pointer",position:"relative","& div":{position:"absolute",top:"28px",width:"100%",textAlign:"center",maxWidth:"65px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none"}}),ut=s("img")({width:"100%",height:"100%"}),xt=s(d)({margin:0,position:"relative",top:"-20px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none"});s(d)(({hamburgercolor:e})=>({position:"absolute",top:"12px",right:"15px",width:"46px","& .hamburger-react":{width:"46px !important",color:e},"& .hamburger-react ~ .MuiBox-root ":{border:`1px solid ${e}`},"@media (max-height: 639px)":{top:"8px",right:"10px"},"@media screen and (orientation: landscape)":{right:"15px"}}));const gt=s("img")({position:"relative",top:"10px",cursor:"pointer","&:active":{opacity:"0.8"}}),pt=s(d)({position:"absolute",top:"30px",left:"50%",transform:"translate(-50%, -50%)",cursor:"pointer"}),ht=s("img")({width:"100%","&:active":{opacity:"0.8"}});s("img")({position:"absolute",top:"18px",right:"30px",cursor:"pointer","&:active":{opacity:"0.8"}});const yt=s(d)({height:"calc(100dvh - 185px)",width:"calc(100% - 60px)",position:"absolute",top:"145px",padding:"0px 30px",backgroundColor:"rgb(21, 93, 116)","@media screen and (orientation: landscape)":{height:"calc(100dvh - 145px)"}}),mt=s(d)({backgroundColor:"#FFF",height:"calc(100dvh - 185px) !important",position:"relative",zIndex:"1",display:"flex",flexDirection:"column",padding:"20px",overflowY:"scroll","@media screen and (orientation: landscape)":{height:"calc(100dvh - 145px)"}});s(d)(({showbtn:e})=>({width:"100%",display:e==="true"?"none":"flex",alignItems:"center",marginBottom:"10px",svg:{fill:"#1B7695"}}));const ft=s(d)({padding:0,boxSizing:"border-box",display:"flex",flexDirection:"column"}),Ct=s(d)({backgroundColor:"#F0F5FB",padding:"9px 11px",marginBottom:"10px",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",cursor:"pointer"});s(d)({width:"calc(100% - 65px)",display:"flex",flexDirection:"column",alignItems:"center",marginRight:"20px"});const St=s(d)({width:"100%",display:"flex",alignItems:"center"}),wt=s(d)({width:"15px",height:"15px",marginRight:"10px"}),bt=s("img")({width:"100%",height:"100%"}),jt=s(d)({width:"100%","& .MuiBox-root":{width:"100%",display:"-webkit-box",justifyContent:"center",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:"2",WebkitBoxOrient:"vertical"}});s(d)(({isdownloaded:e})=>({width:"45px",display:"flex",alignItems:"center",justifyContent:e=="true"?"space-between":"flex-end",cursor:"pointer"}));s("img")({width:"16px",height:"16px"});function vt(e){var h;return t.jsxs(it,{children:[t.jsxs(at,{children:[t.jsx(lt,{src:D.img_header_bg}),t.jsxs(st,{children:[t.jsxs(dt,{children:[t.jsx(ct,{children:t.jsx(ut,{src:U+e.markImg})}),t.jsx(xt,{children:t.jsx(y,{fontFamily:"Buenard",fontWeight:"700",fontSize:36,lineHeight:47,textAlign:"center",color:"#FFF",children:e.markTitle})})]}),t.jsx(gt,{src:D.icon_search}),t.jsx(pt,{children:t.jsx(ht,{src:D.icon_close})})]})]}),t.jsx(yt,{children:t.jsx(mt,{children:t.jsx(ft,{children:(h=e.journeyItems)==null?void 0:h.map((w,k)=>t.jsxs(Ct,{children:[t.jsxs(St,{children:[t.jsx(wt,{children:t.jsx(bt,{src:U+w.logo})}),t.jsx(y,{fontFamily:"Inter",fontWeight:"400",fontSize:12,lineHeight:24,color:"#899093",children:w.seriesTitle})]}),t.jsx(jt,{children:t.jsx(y,{fontFamily:"Inter",fontWeight:"700",fontSize:16,lineHeight:24,color:"#000",children:w.title})})]},k))})})})]})}const Bt=[{toolName:"Western",onClick:()=>{}},{toolName:"Arabic",onClick:()=>{}}];function It(e){const[h,w]=c.useState([]),[k,f]=c.useState(!1),[x,O]=c.useState(""),[b,W]=c.useState(e.currentJourneyTitle||ke),[$,C]=c.useState(!1),[g,m]=c.useState([]),[G,Y]=c.useState([]),[j,E]=c.useState(1),K=fe(),q=Ce(),_=c.useCallback(()=>{var r;if(!((r=e.currentUser)!=null&&r.roles))return[];const n=e.currentUser.roles.reduce((o,i)=>{if(i.role!=="none"){const u=Be(i.language);o.some(v=>v.value===u)||o.push({value:u,label:i.language})}return o},[]);return e.currentLanguage||e.dispatch({type:p.SET_CURRENT_LANGUAGE,payload:{language:n[0].value}}),n},[e.currentUser]);c.useEffect(()=>{const n=_();w(n),n.length>0&&!n.some(r=>r.value===x)&&O(n[0].value)},[e.currentUser,x,_]);const Q=()=>{localStorage.removeItem(Ee),e.dispatch({type:p.RESET_USER}),e.dispatch({type:p.RESET_BOOK}),e.dispatch({type:p.RESET_APP_TEXT_PAGES})},X=()=>t.jsx(be,{isLoggedIn:!0,username:e.currentUser.username,isAdmin:e.currentUser.isAdmin,isJourneyPage:!0,onLogOut:Q}),V=n=>{W(n),e.dispatch({type:p.SET_JOURNEY_BOOK,payload:{journeyTitle:n}}),e.dispatch({type:p.SET_JOURNEY_DEPTH,payload:{depth:1}}),E(1)},Z=()=>t.jsx(Re,{children:t.jsx(Te,{books:De.map(n=>({bookTitle:n.bookTitle,onClick:()=>V(n.value)})),selectedBook:b})}),ee=n=>{const r=n.target.value;O(r)},te=()=>{f(!0);const n=g.map(o=>({id:o.id,number:o.blockIndex,parent:e.parentJourneyId,parentModel:j==1?"Book":"Journey",depth:j,isArticle:o.type=="article",image:{url:o.seriesLogo,alt:"Series Logo"},seriesTitle:{[x]:o.seriesTitle},title:{[x]:o.title}})),r={languageCode:x,journeyCards:n};P.saveJourneyStage(r).then(o=>{const i=o.map(u=>{var S,v;return{id:u._id||`${u.isArticle?"article":"directory"}-${Date.now()}`,blockIndex:u.number,type:u.isArticle?"article":"directory",title:(S=u.title)==null?void 0:S[x],seriesTitle:(v=u.seriesTitle)==null?void 0:v[x],seriesLogo:u.image.url}});m(i),B.success("Successfully saved.",{position:"top-right",draggable:!0,theme:"colored",transition:I,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),f(!1)}).catch(o=>{B.error(o,{position:"top-right",draggable:!0,theme:"colored",transition:I,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),f(!1)})},ne=()=>t.jsx(Pe,{children:t.jsx(Xe,{availableLanguages:h,currentLanguage:x,enableSaveBtn:$,handleLanguageChange:ee,handleSavePreference:te})}),F=n=>{const o={id:`${n?"article":"directory"}-${Date.now()}`,blockIndex:g.length,type:n?"article":"directory",title:"",seriesTitle:"",seriesLogo:""};C(!0),m([...g,o])},oe=n=>{const r=g.filter(o=>o.id!==n);C(!0),m(r)};c.useEffect(()=>{g.length>0?C(!0):C(!1)},[g]);const M=(n,r)=>{C(!0),m(o=>{const i=[...o];return r==="up"&&n>0&&([i[n],i[n-1]]=[i[n-1],i[n]]),r==="down"&&n<i.length-1&&([i[n],i[n+1]]=[i[n+1],i[n]]),i})},re=(n,r)=>{C(!0),m(g.map(o=>o.id==n?{...o,title:r}:o))},ie=(n,r)=>{C(!0),m(g.map(o=>o.id==n?{...o,seriesTitle:r}:o))},ae=(n,r)=>{C(!0),m(o=>o.map(i=>i.id===n?{...i,seriesLogo:r}:i))};c.useEffect(()=>{e.parentJourneyId||E(1)},[]);const le=(n,r,o)=>{e.dispatch({type:p.SET_JOURNEY_PARENT_ID,payload:{parentId:n}}),e.dispatch({type:p.SET_JOUREY_PARENT_TITLE,payload:{title:r}}),o?(q("/admin/articleoverview"),e.dispatch({type:p.SET_JOURNEY_DEPTH,payload:{depth:j}})):E(i=>i+1)},se=()=>t.jsxs(Ue,{children:[t.jsx(H,{children:t.jsx(T,{label:"Add Article",onClick:()=>F(!0)})}),t.jsx(H,{children:t.jsx(T,{label:"Add Directory",onClick:()=>F(!1)})})]});c.useEffect(()=>{(async()=>{f(!0);try{const r=await Oe.getBookInfoByTitle(b);e.dispatch({type:p.SET_JOURNEY_PARENT_ID,payload:{parentId:r.bookId}}),e.dispatch({type:p.SET_JOURNEY_IMAGE,payload:{image:r.markImage}})}catch{B.error("Failed to fetch journey book information",{position:"top-right",draggable:!0,theme:"colored",transition:I,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),f(!1)}})()},[b]),c.useEffect(()=>{f(!0),P.getJourneyStage(e.parentJourneyId).then(n=>{if(n.cards&&n.cards.length>0){const o=n.cards.map(i=>{var u,S;return{id:i._id||`${i.isArticle?"article":"directory"}-${Date.now()}`,blockIndex:i.number,type:i.isArticle?"article":"directory",title:(u=i.title)==null?void 0:u[x],seriesTitle:(S=i.seriesTitle)==null?void 0:S[x],seriesLogo:i.image.url}});m(o)}else m([]);f(!1)}).catch(n=>{B.error(n,{position:"top-right",draggable:!0,theme:"colored",transition:I,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),f(!1)})},[e.parentJourneyId]);const de=()=>{},ce=()=>t.jsxs(ze,{children:[j>1&&t.jsxs(Ne,{onClick:de,children:[t.jsx(je,{}),t.jsx(y,{color:"#155D74",fontFamily:"Inter",fontWeight:"500",fontSize:16,lineHeight:24,children:"Back"})]}),t.jsx(We,{children:g.map((n,r)=>t.jsx(rt,{blockId:n.id,isArticle:n.type=="article",blockIndex:r,language:x,title:n.title,seriesTitle:n.seriesTitle,seriesLogo:n.seriesLogo,seriesLogoOptions:Je,disableOpen:n.id.startsWith("directory")||n.id.startsWith("article"),onTitleChange:o=>re(n.id,o),onSeriesTitleChange:o=>ie(n.id,o),onSeriesLogoChange:o=>ae(n.id,o.target.value),onDelete:()=>oe(n.id),onMoveUp:()=>M(r,"up"),onMoveDown:()=>M(r,"down"),onOpen:()=>le(n.id,n.title||n.seriesTitle,n.type==="article")},n.id))})]});c.useEffect(()=>{const n=g.map(r=>({title:r.title,seriesTitle:r.seriesTitle,logo:r.seriesLogo}));Y(n)},[g]);const ue=()=>t.jsxs($e,{children:[t.jsx(Ge,{children:t.jsx(y,{color:"#155D74",fontFamily:"Inter",fontWeight:"500",fontSize:16,lineHeight:24,children:"Journey Preview"})}),t.jsx(Ye,{children:t.jsx(vt,{markImg:e.journeyBookImage,markTitle:b,journeyItems:G,language:x})})]}),xe=()=>t.jsxs(He,{children:[ce(),ue()]}),ge=()=>t.jsxs(Me,{children:[t.jsx(Ie,{tools:Bt}),Z(),ne(),se(),xe()]});return t.jsxs(t.Fragment,{children:[t.jsxs(Fe,{flexDirection:K?"column":"row",children:[X(),ge()]}),t.jsx(Se,{}),k&&t.jsx(we,{})]})}function Tt(e){return{dispatch:e}}function kt(e){return{currentUser:e.user.currentUser,currentLanguage:e.book.language,currentJourneyTitle:e.journeys.journeyTitle,parentJourneyId:e.journeys.parentId,parentJourneyTitle:e.journeys.parentJourneyTitle,journeyBookImage:e.journeys.journeyBookImage}}const Rt=me(kt,Tt)(It);export{Rt as default};

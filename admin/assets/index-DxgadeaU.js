import{a as h,j as t,O as Se}from"./createTheme-eHT6QdmW.js";import{aq as Ke,T as B,ar as qe,r as je,s as d,B as g,I as ce,q as O,t as Ge,O as Je,K as Qe,u as Xe,A as le,H as ae,E as Ze,Q as Ye,w as et,F as V}from"./App-pKm6ZYhu.js";import{A as tt,S as be}from"./index-BlX6r2TR.js";import{g as ot,a as re}from"./images-ChYA1EJR.js";import{A as nt,i as lt,k as at,n as rt}from"./index-CJlhuXw8.js";import{S as ve}from"./index-CP8lAAC1.js";import{T as it,B as st}from"./index-C9k-xuI-.js";import{F as ct}from"./index-0VSiKrVA.js";import{b as Ce}from"./book.services-BpW7wcOd.js";function dt(e,i=166){let x;function C(...j){const v=()=>{e.apply(this,j)};clearTimeout(x),x=setTimeout(v,i)}return C.clear=()=>{clearTimeout(x)},C}function ut(e){return e&&e.ownerDocument||document}function we(e){return ut(e).defaultView||window}function gt(e,i){typeof e=="function"?e(i):e&&(e.current=i)}const ye=typeof window<"u"?h.useLayoutEffect:h.useEffect;function ht(...e){return h.useMemo(()=>e.every(i=>i==null)?null:i=>{e.forEach(x=>{gt(x,i)})},e)}function X(e){return parseInt(e,10)||0}const xt={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function pt(e){return e==null||Object.keys(e).length===0||e.outerHeightStyle===0&&!e.overflowing}const ft=h.forwardRef(function(i,x){const{onChange:C,maxRows:j,minRows:v=1,style:w,value:A,...D}=i,{current:z}=h.useRef(A!=null),u=h.useRef(null),T=ht(x,u),H=h.useRef(null),l=h.useRef(null),s=h.useCallback(()=>{const y=u.current,f=we(y).getComputedStyle(y);if(f.width==="0px")return{outerHeightStyle:0,overflowing:!1};const b=l.current;b.style.width=f.width,b.value=y.value||i.placeholder||"x",b.value.slice(-1)===`
`&&(b.value+=" ");const S=f.boxSizing,F=X(f.paddingBottom)+X(f.paddingTop),P=X(f.borderBottomWidth)+X(f.borderTopWidth),G=b.scrollHeight;b.value="x";const U=b.scrollHeight;let R=G;v&&(R=Math.max(Number(v)*U,R)),j&&(R=Math.min(Number(j)*U,R)),R=Math.max(R,U);const oe=R+(S==="border-box"?F+P:0),ne=Math.abs(R-G)<=1;return{outerHeightStyle:oe,overflowing:ne}},[j,v,i.placeholder]),p=h.useCallback(()=>{const y=s();if(pt(y))return;const M=y.outerHeightStyle,f=u.current;H.current!==M&&(H.current=M,f.style.height=`${M}px`),f.style.overflow=y.overflowing?"hidden":""},[s]);ye(()=>{const y=()=>{p()};let M;const f=dt(y),b=u.current,S=we(b);S.addEventListener("resize",f);let F;return typeof ResizeObserver<"u"&&(F=new ResizeObserver(y),F.observe(b)),()=>{f.clear(),cancelAnimationFrame(M),S.removeEventListener("resize",f),F&&F.disconnect()}},[s,p]),ye(()=>{p()});const m=y=>{z||p(),C&&C(y)};return t.jsxs(h.Fragment,{children:[t.jsx("textarea",{value:A,onChange:m,ref:T,rows:v,style:w,...D}),t.jsx("textarea",{"aria-hidden":!0,className:i.className,readOnly:!0,ref:l,tabIndex:-1,style:{...xt.shadow,...w,paddingTop:0,paddingBottom:0}})]})});function mt(e){const i=x=>{e.onKeyDown&&e.onKeyDown(x)};return t.jsxs(t.Fragment,{children:[t.jsxs(Ke,{children:[e.label&&t.jsx(B,{fontFamily:'"Baloo Da 2"',fontWeight:"400",fontSize:16,lineHeight:24,textAlign:"center",children:e.label}),t.jsx(ft,{required:e.required,type:e.type,value:e.value,minRows:e.minLength,inputref:e.reference,placeholder:e.placeholder,onKeyDown:i,onChange:e.onChange})]}),e.error&&t.jsx(qe,{children:e.error})]})}var de={},bt=Se;Object.defineProperty(de,"__esModule",{value:!0});var Ie=de.default=void 0,vt=bt(je()),Ct=t;Ie=de.default=(0,vt.default)((0,Ct.jsx)("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward");var ue={},wt=Se;Object.defineProperty(ue,"__esModule",{value:!0});var Be=ue.default=void 0,yt=wt(je()),St=t;Be=ue.default=(0,yt.default)((0,St.jsx)("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"}),"ArrowDownward");const ee=d(g)({backgroundColor:"#F0F5FB",border:"1px solid #1B7695",borderRadius:"4px",padding:"10px",boxSizing:"border-box",fontFamily:"Inter",width:"100%",marginBottom:"10px"}),jt=d(g)({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"}),It=d(g)({display:"flex",alignItems:"center"}),ie=d(g)({display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",padding:"5px",border:"1px solid #155D74",borderRadius:"4px",marginLeft:"5px","&:hover":{cursor:"pointer",backgroundColor:"#155D74","& svg":{fill:"white"},"& .MuiBox-root":{color:"white"}}}),K=d(g)({display:"flex",alignItems:"start",marginTop:"10px"}),q=d(g)({display:"flex",alignItems:"center",marginRight:"15px",minWidth:"100px","& .MuiBox-root":{clear:"both",display:"inline-block",overflow:"hidden",whiteSpace:"nowrap"},"& > .MuiBox-root: first-of-type":{marginRight:"5px"}}),Y=d(g)(({hastextarea:e,isdisabled:i})=>({display:"flex",width:"100%",boxSizing:"border-box",border:e=="true"?"none":"1px solid #155D74",borderRadius:"4px",backgroundColor:e=="true"?"transparent":"#FFF",fontFamily:"Inter",fontSize:"16px",lineHeight:"24px",fontWeight:"500",color:"#000",outline:"none","& .MuiBox-root":{padding:"0",width:"100%","& textarea":{width:"100%",fontFamily:"Inter",fontSize:"16px",padding:"7px 10px",border:"1px solid #155D74",borderRadius:"4px"}},"& .MuiFormControl-root":{width:"100% !important",borderRadius:"4px","& .MuiInputBase-input":{fontFamily:"Inter",'&[type="text"]':{all:i=="true"&&"unset",paddingLeft:"10px",paddingRight:"10px"}},"& .MuiInputBase-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.6)"}},'& input[type="file"]':{cursor:"pointer"}})),Bt=d(g)({margin:"20px 0px 10px 0px"}),ke=d(g)({marginTop:"16px","& img":{maxWidth:"100%",maxHeight:"200px",objectFit:"contain",border:"1px solid #ccc",borderRadius:"4px"}}),kt=d(g)({display:"flex",alignItems:"center",justifyContent:"space-between",boxSizing:"border-box"}),Dt=d(g)({display:"flex",alignItems:"center"}),se=d(g)(({isdisabled:e})=>({display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",marginRight:"5px",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",cursor:e=="true"?"not-allowed !important":"pointer","& .MuiBox-root":{textTransform:"capitalize"},"&:hover":{cursor:"pointer",backgroundColor:e=="true"?"#A1A1A1":"#EE994C","& .MuiBox-root":{color:e=="true"?"#474747":"#FFF !important",backgroundColor:e=="true"?"#A1A1A1":"#EE994C"}}})),Mt=d(g)({display:"flex",flexDirection:"column",boxSizing:"border-box",marginTop:"10px"}),At=d(g)({display:"flex",flexDirection:"column",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",width:"100%"});function te(e){return t.jsxs(jt,{children:[t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.title}),t.jsxs(It,{children:[t.jsx(ie,{onClick:()=>e.onMoveUp(e.blockIndex),children:t.jsx(Ie,{})}),t.jsx(ie,{onClick:()=>e.onMoveDown(e.blockIndex),children:t.jsx(Be,{})}),t.jsx(ie,{onClick:e.onDelete,children:t.jsx(B,{children:"Delete"})})]})]})}function De(e){return t.jsxs(ee,{children:[t.jsx(te,{title:"Title Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsxs(q,{children:[t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.language}),t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Title:"})]}),t.jsx(Y,{children:t.jsx(ce,{type:"text",placeholder:"Enter Title",value:e.inputVal,onChange:i=>e.onInputChange(i.target.value)})})]})]})}function Me(e){return t.jsxs(ee,{children:[t.jsx(te,{title:"Text Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsxs(q,{children:[t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.language}),t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Text:"})]}),t.jsx(Y,{hastextarea:"true",children:t.jsx(mt,{placeholder:"Enter Text",value:e.inputVal,minLength:3,onChange:i=>e.onInputChange(i.target.value)})})]})]})}function Ae(e){const[i,x]=h.useState(e.url||""),C=j=>{var w;const v=(w=j.target.files)==null?void 0:w[0];if(v){const A=new FileReader;A.onload=D=>{var u;const z=(u=D.target)==null?void 0:u.result;x(URL.createObjectURL(v)),e.onImageInputChange(z)},A.readAsDataURL(v)}};return t.jsxs(ee,{children:[t.jsx(te,{title:"Image Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Image URL:"})}),t.jsxs(Y,{isdisabled:"true",children:[t.jsx(ce,{value:i,placeholder:"Image URL",disable:!0,onChange:()=>{}}),t.jsx(ct,{type:".png, .jpg, .jpeg",onChange:C})]})]}),t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Alt Text:"})}),t.jsx(Y,{children:t.jsx(ce,{type:"text",placeholder:"Enter Alt Text",value:e.alt,onChange:j=>e.onAltInputChange(j.target.value)})})]}),i&&t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Preview:"})}),t.jsx(ke,{children:t.jsx("img",{src:i,alt:e.alt||"Selected image"})})]})]})}function Tt(e){const i=ot(e.language),[x,C]=h.useState([]);h.useEffect(()=>{var p,m,y,M;const l=[],s=(p=e.value)==null?void 0:p.content;if((m=e.value)!=null&&m.title){const f={id:`title-${Date.now()}-${Math.random()}`,blockIndex:1,type:"title",value:(M=(y=e.value)==null?void 0:y.title)==null?void 0:M[i]};l.push(f)}s==null||s.map((f,b)=>{if(f.url){const S={id:`image-${Date.now()}-${Math.random()}`,blockIndex:b+2,type:"image",value:{url:f.url,alt:f.alt}};l.push(S)}else if(f.isTitle){const S={id:`title-${Date.now()}-${Math.random()}`,blockIndex:b+2,type:"title",value:f==null?void 0:f[i]};l.push(S)}else{const S={id:`text-${Date.now()}-${Math.random()}`,blockIndex:b+2,type:"text",value:f==null?void 0:f[i]};l.push(S)}}),C(l)},[]),h.useEffect(()=>{e.onChange(x)},[x]);const j=()=>t.jsx(te,{title:"Collapsible Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),v=l=>t.jsx(Bt,{children:t.jsx(B,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"bold",children:l})}),w=l=>{const p={id:`${l}-${Date.now()}-${Math.random()}`,blockIndex:x.length+1,type:l,value:l=="image"?{url:"",alt:""}:""};C([...x,p])},A=l=>{const s=x.filter(p=>p.id!==l);C(s)},D=()=>t.jsx(kt,{children:t.jsxs(Dt,{children:[t.jsx(se,{children:t.jsx(O,{label:"Add Title",onClick:()=>w("title")})}),t.jsx(se,{isdisabled:x.length==0?"true":"false",children:t.jsx(O,{label:"Add Text",disabled:!x||x.length==0,onClick:()=>w("text")})}),t.jsx(se,{isdisabled:x.length==0?"true":"false",children:t.jsx(O,{label:"Add Image",disabled:!x||x.length==0,onClick:()=>w("image")})})]})}),z=(l,s)=>{C(x.map(p=>p.id==l?{...p,value:s}:p))},u=(l,s)=>{C(p=>p.map(m=>m.id===l?{...m,value:{...m.value,...s}}:m))},T=(l,s)=>{C(p=>{const m=[...p];return s==="up"&&l>0&&([m[l],m[l-1]]=[m[l-1],m[l]]),s==="down"&&l<m.length-1&&([m[l],m[l+1]]=[m[l+1],m[l]]),m})},H=()=>t.jsx(Mt,{children:x.map((l,s)=>{switch(l.type){case"title":return t.jsx(De,{language:e.language,inputVal:l.value,blockIndex:s,onInputChange:p=>z(l.id,p),onDelete:()=>A(l.id),onMoveUp:()=>T(s,"up"),onMoveDown:()=>T(s,"down")},s);case"text":return t.jsx(Me,{language:e.language,inputVal:l.value,blockIndex:s,onInputChange:p=>z(l.id,p),onDelete:()=>A(l.id),onMoveUp:()=>T(s,"up"),onMoveDown:()=>T(s,"down")},s);case"image":return t.jsx(Ae,{url:l.value.url,alt:l.value.alt,blockIndex:s,onImageInputChange:p=>u(l.id,{url:p}),onAltInputChange:p=>u(l.id,{alt:p}),onDelete:()=>A(l.id),onMoveUp:()=>T(s,"up"),onMoveDown:()=>T(s,"down")},s)}return null})});return t.jsxs(ee,{children:[j(),v("Title: "),v("Content Items: "),D(),H()]})}const Rt=d(g)({position:"relative",minHeight:"calc(100vh - 37px)",width:"100%","& >.MuiBox-root:first-of-type":{backgroundColor:"#1B7695","& >.MuiBox-root":{color:"#F6FCFC"}}}),Ft=d(g)({width:"100%",height:"calc(100% - 73px)",margin:"auto",marginTop:"73px"}),Et=d(g)({margin:"20px 40px"}),Ot=d(g)({margin:"20px 40px",display:"flex",alignItems:"center","@media screen and (max-width: 800px)":{display:"block"}}),zt=d(g)({display:"flex",justifyContent:"space-between",alignItems:"center","& > .MuiFormControl-root":{marginRight:"20px"},"@media screen and (max-width: 650px)":{display:"block","& > .MuiFormControl-root":{alignItems:"start","& .MuiInputBase-root":{width:"100%"}}}}),Pt=d(g)({margin:"20px 40px",display:"flex",alignItems:"center","& > .MuiBox-root":{width:"120px",marginRight:"50px"},"@media screen and (max-width: 800px)":{display:"block"}}),_t=d(g)(({isdisable:e})=>({display:"flex",justifyContent:"center",alignItems:"center",width:"160px !important",marginRight:"0px !important",padding:"5px 10px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",cursor:e=="true"?"not-allowed":"pointer",button:{width:"100%"},"&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",fontWeight:"600 !important",textTransform:"none","&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"}}})),Lt=d(g)({width:"100%",padding:"20px 40px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"space-between","@media screen and (max-width: 800px)":{flexDirection:"column"}}),Ht=d(g)({display:"flex",alignItems:"center","@media screen and (max-width: 800px)":{flexDirection:"column",width:"100%"}}),Z=d(g)({display:"flex",justifyContent:"center",alignItems:"center",marginRight:"20px !important",padding:"5px 10px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:"#FFAA5D",cursor:"pointer",button:{width:"100%"},"&:hover":{backgroundColor:"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",textTransform:"none","&:hover":{backgroundColor:"#EE994C"}},"@media screen and (max-width: 800px)":{width:"100%",marginRight:"0px !important",marginBottom:"10px"}}),Ut=d(g)({display:"flex",justifyContent:"center",alignItems:"center",padding:"5px 10px",width:"150px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:"#FFAA5D",cursor:"pointer",button:{width:"100%"},"&:hover":{backgroundColor:"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",textTransform:"none","&:hover":{backgroundColor:"#EE994C"}},"@media screen and (max-width: 800px)":{width:"100%"}}),Wt=d(g)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boxSizing:"border-box",width:"100%"}),$t=d(g)({display:"flex",flexDirection:"column",alignItems:"center",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",backgroundColor:"#F0F5FB",padding:"10px",width:"300px",marginBottom:"10px","& > .MuiBox-root: first-of-type":{marginBottom:"20px"},"@media screen and (max-width: 700px)":{width:"100%"}}),Nt=d(g)({display:"flex",alignItems:"center",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),Vt=d(g)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),Kt=d(g)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),qt=d("img")({width:"250px"}),Gt=d(g)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px",width:"100%"}),Jt=d(g)({display:"flex",margin:"20px 40px",boxSizing:"border-box",justifyContent:"space-between",gap:"20px","@media screen and (max-width: 700px)":{flexDirection:"column"}});function Qt(e){var i,x,C,j;return t.jsx(At,{children:t.jsx(tt,{label:((x=(i=e.value)==null?void 0:i.title)==null?void 0:x[e.language])||"",detail:(j=(C=e.value)==null?void 0:C.content)==null?void 0:j.map((v,w)=>v.isTitle?t.jsx(B,{color:"#474747",fontSize:16,fontWeight:"700",children:v==null?void 0:v[e.language]},w):v.url?t.jsx(ke,{children:t.jsx("img",{src:v.url})},w):t.jsx(B,{color:"#474747",fontSize:16,fontWeight:"500",children:v==null?void 0:v[e.language]},w))})})}const Xt=[{toolName:"Western",onClick:()=>{}},{toolName:"Arabic",onClick:()=>{}}];function Zt(e){var pe,fe,me;const i=Je(),[x,C]=h.useState(!1),[j,v]=h.useState(e.currentBook),[w,A]=h.useState((pe=i.state.subBookInfo)==null?void 0:pe.subBookId),[D,z]=h.useState(i.state.chapterId),[u,T]=h.useState(e.currentLanguage),[H,l]=h.useState([]),[s,p]=h.useState(((fe=i.state.subBookInfo.chapterInfos[0].chapterIsCompleted)==null?void 0:fe[u])||!1),[m,y]=h.useState(((me=i.state.subBookInfo.chapterInfos[0].chapterIsPublished)==null?void 0:me[u])||!1),[M,f]=h.useState(!1),[b,S]=h.useState([]),[F,P]=h.useState(!1),G=Qe(),U=Xe(),R=h.useMemo(()=>i.state.languages,[i]);h.useEffect(()=>{var c,I;const o=e.bookInfos.find(r=>r.bookTitle.en==e.currentBook),n=(c=o==null?void 0:o.subBooks)==null?void 0:c.find(r=>r.subBookId==w),a=(n==null?void 0:n.chapterInfos)&&(n==null?void 0:n.chapterInfos[0].chapterNumber)==0&&((I=n==null?void 0:n.chapterInfos[0])==null?void 0:I.chapterId)||"";z(a)},[w]),h.useEffect(()=>{C(!0),S([]),Ce.getIntroVerses(D).then(o=>{var a,c,I;p(((a=o.isCompleted)==null?void 0:a[u])||!1),y(((c=o.isPublished)==null?void 0:c[u])||!1);const n=[];o.verses&&o.verses.length>0&&((I=o.verses)==null||I.map(r=>{var L,W;const k=r.number;if(!r.isCollapse&&r.title){const E={id:r.id||`title-${Date.now()}-${Math.random()}`,type:"title",blockIndex:k,value:(L=r.title)==null?void 0:L[u]};n.push(E)}else if(!r.isCollapse&&r.text){const E={id:r.id||`text-${Date.now()}-${Math.random()}`,type:"text",blockIndex:k,value:(W=r.text)==null?void 0:W[u]};n.push(E)}else if(!r.isCollapse&&r.image){const E={id:r.id||`image-${Date.now()}-${Math.random()}`,type:"image",blockIndex:k,value:r.image};n.push(E)}else if(r.isCollapse){const E={id:r.id||`collapsible-${Date.now()}-${Math.random()}`,type:"collapsible",blockIndex:k,value:r};n.push(E)}})),S(n),C(!1)}).catch(o=>{console.log(`warning/error while getting intro information: 
`,o),le.warning("No introduction information for the chapter.",{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),C(!1)})},[D,u]);const oe=()=>{localStorage.removeItem(nt),e.dispatch({type:V.RESET_USER}),e.dispatch({type:V.RESET_BOOK}),e.dispatch({type:V.RESET_APP_TEXT_PAGES}),U("/admin")},ne=()=>t.jsx(et,{isLoggedIn:!0,username:e.currentUser.username,isAdmin:e.currentUser.isAdmin,onLogOut:oe}),Te=o=>{v(o),U("/admin/bookoverview"),e.dispatch({type:V.SET_BOOK,payload:{bookTitle:o}})},Re=()=>t.jsx(Et,{children:t.jsx(st,{books:lt.map(o=>({bookTitle:o.bookTitle,onClick:()=>{Te(o.value)}})),selectedBook:j})});h.useEffect(()=>{var n;const o=e.bookInfos.find(a=>a.bookTitle.en==e.currentBook);if(o){const c=Array.from(new Set(o.subBooks.map(I=>I.subBookId))).map(I=>o.subBooks.find(r=>r.subBookId===I)).map(I=>{var r;return{label:(r=I.subBookTitle)==null?void 0:r[u],value:I.subBookId}});l(c),A(((n=i.state.subBookInfo)==null?void 0:n.subBookId)||c[0].value)}},[e.currentBook]);const Fe=o=>{const n=o.target.value;A(n)},Ee=o=>{const n=o.target.value;T(n)},Oe=()=>t.jsx(Ot,{children:t.jsxs(zt,{children:[(j==at||j==rt)&&t.jsx(ve,{label:"",options:H,value:H.find(o=>o.value===w)?w:"",backgroundColor:"#fff",textColor:"#155D74",onChange:Fe}),t.jsx(ve,{label:"",options:R,value:u,backgroundColor:"#fff",textColor:"#155D74",onChange:Ee})]})}),ge=(o,n)=>{p(o),o&&y(n),!o&&y(!1)},ze=o=>{const n={chapterAudio:o.audio,chapterId:o._id,chapterNumber:o.chapterNumber,chapterTranslated:o.isTranslated,chapterIsCompleted:o.isCompleted,chapterIsPublished:o.isPublished,subBookId:o.subBook},a=e.bookInfos.map(c=>({...c,subBooks:c.subBooks.map(I=>({...I,chapterInfos:I.chapterInfos.map(r=>r.chapterId===D?{...r,...n}:r)}))}));e.dispatch({type:V.SET_BOOKINFOS,payload:{bookInfos:a}})},Pe=h.useCallback(()=>{const o=[];b.map((a,c)=>{var I;switch(a.type){case"title":{const r=a.value,k={chapter:D,title:{[u]:r},text:{},image:{},number:c+1,isCollapse:!1,content:[]};o.push(k);break}case"text":{const r=a.value,k={chapter:D,title:{},text:{[u]:r},image:{},number:c+1,isCollapse:!1,content:[]};o.push(k);break}case"image":{const r=a.value,k=r.url,L=r.alt,W={chapter:D,title:{},text:{},image:{url:k,alt:L},number:c+1,isCollapse:!1,content:[]};o.push(W);break}case"collapsible":{let r={chapter:D,title:{},text:{},image:{},number:c+1,isCollapse:!0,content:[]};const k=[],L=a.value,W=(I=L[0])==null?void 0:I.value;r={...r,title:{[u]:W}};for(const E of Object.keys(L).slice(1)){const $=L[E];if($.type=="title"){const N={[u]:$.value,isTitle:!0};k.push(N)}else if($.type=="text"){const N={[u]:$.value,isTitle:!1};k.push(N)}else if($.type=="image"){const N=$.value,Ve={url:N.url,alt:N.alt};k.push(Ve)}}r={...r,content:k},o.push(r);break}}});const n={languageCode:u,subBookId:w,chapterId:D,isCompleted:{[u]:s},isPublished:{[u]:m},verses:o};Ce.updateIntroData(n).then(a=>{ze(a),le.success("Successfully updated.",{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),C(!1)}).catch(a=>{le.error(a.message,{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),C(!1)})},[b,s,m]),_e=()=>t.jsxs(Pt,{children:[t.jsx(be,{label:"Complete",value:s,disable:b.length==0,onChange:()=>ge(!s,m)}),t.jsx(be,{label:"Publish",value:m,disable:!s,onChange:()=>ge(s,!m)}),t.jsx(_t,{isdisable:F?"false":"true",children:t.jsx(O,{label:"Save Changes",disabled:!F,onClick:Pe})})]}),J=o=>{const a={id:`${o}-${Date.now()}`,blockIndex:b.length,type:o,value:o=="image"?{url:"",alt:""}:""};P(!0),S([...b,a])},Q=o=>{const n=b.filter(a=>a.id!==o);P(!0),S(n)},Le=()=>t.jsxs(Lt,{children:[t.jsxs(Ht,{children:[t.jsx(Z,{children:t.jsx(O,{label:"Add Title",onClick:()=>J("title")})}),t.jsx(Z,{children:t.jsx(O,{label:"Add Text",onClick:()=>J("text")})}),t.jsx(Z,{children:t.jsx(O,{label:"Add Image",onClick:()=>J("image")})}),t.jsx(Z,{children:t.jsx(O,{label:"Add Collapsible",onClick:()=>J("collapsible")})})]}),t.jsx(Ut,{children:t.jsx(O,{label:M?"Hide Preview":"Show Preview",onClick:()=>f(!M)})})]}),he=(o,n)=>{P(!0),S(b.map(a=>a.id==o?{...a,value:n}:a))},xe=(o,n)=>{P(!0),S(a=>a.map(c=>c.id===o?{...c,value:{...c.value,...n}}:c))},He=(o,n)=>{P(!0),S(a=>a.map(c=>c.id==o?{...c,value:{...c.value,...n}}:c))},_=(o,n)=>{P(!0),S(a=>{const c=[...a];return n==="up"&&o>0&&([c[o],c[o-1]]=[c[o-1],c[o]]),n==="down"&&o<c.length-1&&([c[o],c[o+1]]=[c[o+1],c[o]]),c})},Ue=()=>t.jsx(Wt,{children:b.map((o,n)=>{switch(o.type){case"title":return t.jsx(De,{language:re(u),inputVal:o.value,blockIndex:n,onInputChange:a=>he(o.id,a),onDelete:()=>Q(o.id),onMoveUp:()=>_(n,"up"),onMoveDown:()=>_(n,"down")},o.id);case"text":return t.jsx(Me,{language:re(u),inputVal:o.value,blockIndex:n,onInputChange:a=>he(o.id,a),onDelete:()=>Q(o.id),onMoveUp:()=>_(n,"up"),onMoveDown:()=>_(n,"down")},o.id);case"image":return t.jsx(Ae,{url:o.value.url,alt:o.value.alt,blockIndex:n,onImageInputChange:a=>xe(o.id,{url:a}),onAltInputChange:a=>xe(o.id,{alt:a}),onDelete:()=>Q(o.id),onMoveUp:()=>_(n,"up"),onMoveDown:()=>_(n,"down")},o.id);case"collapsible":return t.jsx(Tt,{language:re(u),blockIndex:n,value:o.value,onChange:a=>He(o.id,a),onDelete:()=>Q(o.id),onMoveUp:()=>_(n,"up"),onMoveDown:()=>_(n,"down")},o.id);default:return null}})}),We=()=>b&&b.length>0&&M&&t.jsxs($t,{children:[t.jsx(B,{color:"#155D74",fontSize:18,fontWeight:"bold",textAlign:"left",fontFamily:"Inter",hasUnderline:!0,children:"PREVIEW"}),b.map((o,n)=>{switch(o.type){case"title":return t.jsx(Nt,{children:t.jsx(B,{color:"black",fontWeight:"bold",textAlign:"left",fontFamily:"Inter",children:o.value})},n);case"text":return t.jsx(Vt,{children:t.jsx(B,{color:"black",fontSize:16,fontWeight:"400",fontFamily:"Inter",children:o.value})},n);case"image":return t.jsx(Kt,{children:t.jsx(qt,{src:o.value.url,alt:o.value.alt})},n);case"collapsible":return t.jsx(Gt,{children:t.jsx(Qt,{language:u,blockIndex:o.blockIndex,value:o.value,onChange:()=>{},onDelete:()=>{},onMoveDown:()=>{},onMoveUp:()=>{}})},n)}})]}),$e=()=>t.jsxs(Jt,{children:[Ue(),We()]}),Ne=()=>t.jsxs(Ft,{children:[t.jsx(it,{tools:Xt}),Re(),Oe(),_e(),Le(),$e()]});return t.jsxs(t.Fragment,{children:[t.jsxs(Rt,{flexDirection:G?"column":"row",children:[ne(),Ne()]}),x&&t.jsx(Ze,{}),t.jsx(Ye,{})]})}function Yt(e){return{dispatch:e}}function eo(e){return{currentUser:e.user.currentUser,bookInfos:e.book.bookInfos,chapterInfos:e.book.chapterInfos,currentBook:e.book.book,currentLanguage:e.book.language}}const uo=Ge(eo,Yt)(Zt);export{uo as default};

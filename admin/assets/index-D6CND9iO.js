import{a as x,j as t,O as Se}from"./createTheme-BSndqwJN.js";import{aq as Ke,T as D,ar as qe,r as je,s as u,B as h,I as ce,q as P,t as Ge,O as Je,K as Qe,u as Xe,A as le,H as ae,E as Ze,Q as Ye,w as et,F as V}from"./App-DSghd2TB.js";import{A as tt,S as be}from"./index-Cq9zJNbW.js";import{g as nt,a as re}from"./images-DLw5nS4g.js";import{A as ot,i as lt,k as at,n as rt}from"./index-BzhnpL16.js";import{S as ve}from"./index-Byz23Ard.js";import{T as it,B as st}from"./index-BFoWyhqB.js";import{F as ct}from"./index-CAEWVDMo.js";import{b as Ce}from"./book.services-DsYPDpUw.js";function dt(e,i=166){let p;function C(...k){const g=()=>{e.apply(this,k)};clearTimeout(p),p=setTimeout(g,i)}return C.clear=()=>{clearTimeout(p)},C}function ut(e){return e&&e.ownerDocument||document}function we(e){return ut(e).defaultView||window}function ht(e,i){typeof e=="function"?e(i):e&&(e.current=i)}const ye=typeof window<"u"?x.useLayoutEffect:x.useEffect;function gt(...e){return x.useMemo(()=>e.every(i=>i==null)?null:i=>{e.forEach(p=>{ht(p,i)})},e)}function X(e){return parseInt(e,10)||0}const xt={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function pt(e){return e==null||Object.keys(e).length===0||e.outerHeightStyle===0&&!e.overflowing}const ft=x.forwardRef(function(i,p){const{onChange:C,maxRows:k,minRows:g=1,style:S,value:T,...M}=i,{current:_}=x.useRef(T!=null),d=x.useRef(null),R=gt(p,d),H=x.useRef(null),a=x.useRef(null),c=x.useCallback(()=>{const j=d.current,m=we(j).getComputedStyle(j);if(m.width==="0px")return{outerHeightStyle:0,overflowing:!1};const v=a.current;v.style.width=m.width,v.value=j.value||i.placeholder||"x",v.value.slice(-1)===`
`&&(v.value+=" ");const B=m.boxSizing,E=X(m.paddingBottom)+X(m.paddingTop),z=X(m.borderBottomWidth)+X(m.borderTopWidth),G=v.scrollHeight;v.value="x";const U=v.scrollHeight;let F=G;g&&(F=Math.max(Number(g)*U,F)),k&&(F=Math.min(Number(k)*U,F)),F=Math.max(F,U);const ne=F+(B==="border-box"?E+z:0),oe=Math.abs(F-G)<=1;return{outerHeightStyle:ne,overflowing:oe}},[k,g,i.placeholder]),f=x.useCallback(()=>{const j=c();if(pt(j))return;const A=j.outerHeightStyle,m=d.current;H.current!==A&&(H.current=A,m.style.height=`${A}px`),m.style.overflow=j.overflowing?"hidden":""},[c]);ye(()=>{const j=()=>{f()};let A;const m=dt(j),v=d.current,B=we(v);B.addEventListener("resize",m);let E;return typeof ResizeObserver<"u"&&(E=new ResizeObserver(j),E.observe(v)),()=>{m.clear(),cancelAnimationFrame(A),B.removeEventListener("resize",m),E&&E.disconnect()}},[c,f]),ye(()=>{f()});const b=j=>{_||f(),C&&C(j)};return t.jsxs(x.Fragment,{children:[t.jsx("textarea",{value:T,onChange:b,ref:R,rows:g,style:S,...M}),t.jsx("textarea",{"aria-hidden":!0,className:i.className,readOnly:!0,ref:a,tabIndex:-1,style:{...xt.shadow,...S,paddingTop:0,paddingBottom:0}})]})});function mt(e){const i=p=>{e.onKeyDown&&e.onKeyDown(p)};return t.jsxs(t.Fragment,{children:[t.jsxs(Ke,{children:[e.label&&t.jsx(D,{fontFamily:'"Baloo Da 2"',fontWeight:"400",fontSize:16,lineHeight:24,textAlign:"center",children:e.label}),t.jsx(ft,{required:e.required,type:e.type,value:e.value,minRows:e.minLength,inputref:e.reference,placeholder:e.placeholder,onKeyDown:i,onChange:e.onChange})]}),e.error&&t.jsx(qe,{children:e.error})]})}var de={},bt=Se;Object.defineProperty(de,"__esModule",{value:!0});var Be=de.default=void 0,vt=bt(je()),Ct=t;Be=de.default=(0,vt.default)((0,Ct.jsx)("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward");var ue={},wt=Se;Object.defineProperty(ue,"__esModule",{value:!0});var Ie=ue.default=void 0,yt=wt(je()),St=t;Ie=ue.default=(0,yt.default)((0,St.jsx)("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"}),"ArrowDownward");const ee=u(h)({backgroundColor:"#F0F5FB",border:"1px solid #1B7695",borderRadius:"4px",padding:"10px",boxSizing:"border-box",fontFamily:"Inter",width:"100%",marginBottom:"10px"}),jt=u(h)({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"}),Bt=u(h)({display:"flex",alignItems:"center"}),ie=u(h)({display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",padding:"5px",border:"1px solid #155D74",borderRadius:"4px",marginLeft:"5px","&:hover":{cursor:"pointer",backgroundColor:"#155D74","& svg":{fill:"white"},"& .MuiBox-root":{color:"white"}}}),K=u(h)({display:"flex",alignItems:"start",marginTop:"10px"}),q=u(h)({display:"flex",alignItems:"center",marginRight:"15px",minWidth:"100px","& .MuiBox-root":{clear:"both",display:"inline-block",overflow:"hidden",whiteSpace:"nowrap"},"& > .MuiBox-root: first-of-type":{marginRight:"5px"}}),Y=u(h)(({hastextarea:e,isdisabled:i})=>({display:"flex",width:"100%",boxSizing:"border-box",border:e=="true"?"none":"1px solid #155D74",borderRadius:"4px",backgroundColor:e=="true"?"transparent":"#FFF",fontFamily:"Inter",fontSize:"16px",lineHeight:"24px",fontWeight:"500",color:"#000",outline:"none","& .MuiBox-root":{padding:"0",width:"100%","& textarea":{width:"100%",fontFamily:"Inter",fontSize:"16px",padding:"7px 10px",border:"1px solid #155D74",borderRadius:"4px"}},"& .MuiFormControl-root":{width:"100% !important",borderRadius:"4px","& .MuiInputBase-input":{fontFamily:"Inter",'&[type="text"]':{all:i=="true"&&"unset",paddingLeft:"10px",paddingRight:"10px"}},"& .MuiInputBase-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.6)"}},'& input[type="file"]':{cursor:"pointer"}})),It=u(h)({margin:"20px 0px 10px 0px"}),ke=u(h)({marginTop:"16px","& img":{maxWidth:"100%",maxHeight:"200px",objectFit:"contain",border:"1px solid #ccc",borderRadius:"4px"}}),kt=u(h)({display:"flex",alignItems:"center",justifyContent:"space-between",boxSizing:"border-box"}),Dt=u(h)({display:"flex",alignItems:"center"}),se=u(h)(({isdisabled:e})=>({display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",marginRight:"5px",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",cursor:e=="true"?"not-allowed !important":"pointer","& .MuiBox-root":{textTransform:"capitalize"},"&:hover":{cursor:"pointer",backgroundColor:e=="true"?"#A1A1A1":"#EE994C","& .MuiBox-root":{color:e=="true"?"#474747":"#FFF !important",backgroundColor:e=="true"?"#A1A1A1":"#EE994C"}}})),Mt=u(h)({display:"flex",flexDirection:"column",boxSizing:"border-box",marginTop:"10px"}),At=u(h)({display:"flex",flexDirection:"column",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",width:"100%"});function te(e){return t.jsxs(jt,{children:[t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.title}),t.jsxs(Bt,{children:[t.jsx(ie,{onClick:()=>e.onMoveUp(e.blockIndex),children:t.jsx(Be,{})}),t.jsx(ie,{onClick:()=>e.onMoveDown(e.blockIndex),children:t.jsx(Ie,{})}),t.jsx(ie,{onClick:e.onDelete,children:t.jsx(D,{children:"Delete"})})]})]})}function De(e){return t.jsxs(ee,{children:[t.jsx(te,{title:"Title Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsxs(q,{children:[t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.language}),t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Title:"})]}),t.jsx(Y,{children:t.jsx(ce,{type:"text",placeholder:"Enter Title",value:e.inputVal,onChange:i=>e.onInputChange(i.target.value)})})]})]})}function Me(e){return t.jsxs(ee,{children:[t.jsx(te,{title:"Text Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsxs(q,{children:[t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.language}),t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Text:"})]}),t.jsx(Y,{hastextarea:"true",children:t.jsx(mt,{placeholder:"Enter Text",value:e.inputVal,minLength:3,onChange:i=>e.onInputChange(i.target.value)})})]})]})}function Ae(e){const[i,p]=x.useState(e.url||""),C=k=>{var S;const g=(S=k.target.files)==null?void 0:S[0];if(g){const T=new FileReader;T.onload=M=>{var d;const _=(d=M.target)==null?void 0:d.result;p(URL.createObjectURL(g)),e.onImageInputChange(_)},T.readAsDataURL(g)}};return t.jsxs(ee,{children:[t.jsx(te,{title:"Image Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Image URL:"})}),t.jsxs(Y,{isdisabled:"true",children:[t.jsx(ce,{value:i,placeholder:"Image URL",disable:!0,onChange:()=>{}}),t.jsx(ct,{type:".png, .jpg, .jpeg",onChange:C})]})]}),t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Alt Text:"})}),t.jsx(Y,{children:t.jsx(ce,{type:"text",placeholder:"Enter Alt Text",value:e.alt,onChange:k=>e.onAltInputChange(k.target.value)})})]}),i&&t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Preview:"})}),t.jsx(ke,{children:t.jsx("img",{src:i,alt:e.alt||"Selected image"})})]})]})}function Tt(e){const i=nt(e.language),[p,C]=x.useState([]);x.useEffect(()=>{var f,b,j,A;const a=[],c=(f=e.value)==null?void 0:f.content;if((b=e.value)!=null&&b.title){const m={id:`title-${Date.now()}-${Math.random()}`,blockIndex:1,type:"title",value:(A=(j=e.value)==null?void 0:j.title)==null?void 0:A[i]};a.push(m)}c==null||c.map((m,v)=>{if(m.url){const B={id:`image-${Date.now()}-${Math.random()}`,blockIndex:v+2,type:"image",value:{url:m.url,alt:m.alt}};a.push(B)}else if(m.isTitle){const B={id:`title-${Date.now()}-${Math.random()}`,blockIndex:v+2,type:"title",value:m==null?void 0:m[i]};a.push(B)}else{const B={id:`text-${Date.now()}-${Math.random()}`,blockIndex:v+2,type:"text",value:m==null?void 0:m[i]};a.push(B)}}),C(a)},[]),x.useEffect(()=>{e.onChange(p)},[p]);const k=()=>t.jsx(te,{title:"Collapsible Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),g=a=>t.jsx(It,{children:t.jsx(D,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"bold",children:a})}),S=a=>{const f={id:`${a}-${Date.now()}-${Math.random()}`,blockIndex:p.length+1,type:a,value:a=="image"?{url:"",alt:""}:""};C([...p,f])},T=a=>{const c=p.filter(f=>f.id!==a);C(c)},M=()=>t.jsx(kt,{children:t.jsxs(Dt,{children:[t.jsx(se,{children:t.jsx(P,{label:"Add Title",onClick:()=>S("title")})}),t.jsx(se,{isdisabled:p.length==0?"true":"false",children:t.jsx(P,{label:"Add Text",disabled:!p||p.length==0,onClick:()=>S("text")})}),t.jsx(se,{isdisabled:p.length==0?"true":"false",children:t.jsx(P,{label:"Add Image",disabled:!p||p.length==0,onClick:()=>S("image")})})]})}),_=(a,c)=>{C(p.map(f=>f.id==a?{...f,value:c}:f))},d=(a,c)=>{C(f=>f.map(b=>b.id===a?{...b,value:{...b.value,...c}}:b))},R=(a,c)=>{C(f=>{const b=[...f];return c==="up"&&a>0&&([b[a],b[a-1]]=[b[a-1],b[a]]),c==="down"&&a<b.length-1&&([b[a],b[a+1]]=[b[a+1],b[a]]),b})},H=()=>t.jsx(Mt,{children:p.map((a,c)=>{switch(a.type){case"title":return t.jsx(De,{language:e.language,inputVal:a.value,blockIndex:c+1,onInputChange:f=>_(a.id,f),onDelete:()=>T(a.id),onMoveUp:()=>R(c,"up"),onMoveDown:()=>R(c,"down")},c);case"text":return t.jsx(Me,{language:e.language,inputVal:a.value,blockIndex:c+1,onInputChange:f=>_(a.id,f),onDelete:()=>T(a.id),onMoveUp:()=>R(c,"up"),onMoveDown:()=>R(c,"down")},c);case"image":return t.jsx(Ae,{url:a.value.url,alt:a.value.alt,blockIndex:c+1,onImageInputChange:f=>d(a.id,{url:f}),onAltInputChange:f=>d(a.id,{alt:f}),onDelete:()=>T(a.id),onMoveUp:()=>R(c,"up"),onMoveDown:()=>R(c,"down")},c)}return null})});return t.jsxs(ee,{children:[k(),g("Title: "),g("Content Items: "),M(),H()]})}const Rt=u(h)({position:"relative",minHeight:"calc(100vh - 37px)",width:"100%","& >.MuiBox-root:first-of-type":{backgroundColor:"#1B7695","& >.MuiBox-root":{color:"#F6FCFC"}}}),Ft=u(h)({width:"100%",height:"calc(100% - 73px)",margin:"auto",marginTop:"73px"}),Et=u(h)({margin:"20px 40px"}),zt=u(h)({margin:"20px 40px",display:"flex",alignItems:"center","@media screen and (max-width: 800px)":{display:"block"}}),Ot=u(h)({display:"flex",justifyContent:"space-between",alignItems:"center","& > .MuiFormControl-root":{marginRight:"20px"},"@media screen and (max-width: 650px)":{display:"block","& > .MuiFormControl-root":{alignItems:"start","& .MuiInputBase-root":{width:"100%"}}}}),Pt=u(h)({margin:"20px 40px",display:"flex",alignItems:"center","& > .MuiBox-root":{width:"120px",marginRight:"50px"},"@media screen and (max-width: 800px)":{display:"block"}}),_t=u(h)(({isdisable:e})=>({display:"flex",justifyContent:"center",alignItems:"center",width:"160px !important",marginRight:"0px !important",padding:"5px 10px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",cursor:e=="true"?"not-allowed":"pointer",button:{width:"100%"},"&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",fontWeight:"600 !important",textTransform:"none","&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"}}})),Lt=u(h)({width:"100%",padding:"20px 40px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"space-between","@media screen and (max-width: 800px)":{flexDirection:"column"}}),Ht=u(h)({display:"flex",alignItems:"center","@media screen and (max-width: 800px)":{flexDirection:"column",width:"100%"}}),Z=u(h)({display:"flex",justifyContent:"center",alignItems:"center",marginRight:"20px !important",padding:"5px 10px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:"#FFAA5D",cursor:"pointer",button:{width:"100%"},"&:hover":{backgroundColor:"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",textTransform:"none","&:hover":{backgroundColor:"#EE994C"}},"@media screen and (max-width: 800px)":{width:"100%",marginRight:"0px !important",marginBottom:"10px"}}),Ut=u(h)({display:"flex",justifyContent:"center",alignItems:"center",padding:"5px 10px",width:"150px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:"#FFAA5D",cursor:"pointer",button:{width:"100%"},"&:hover":{backgroundColor:"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",textTransform:"none","&:hover":{backgroundColor:"#EE994C"}},"@media screen and (max-width: 800px)":{width:"100%"}}),Wt=u(h)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boxSizing:"border-box",width:"100%"}),$t=u(h)({display:"flex",flexDirection:"column",alignItems:"center",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",backgroundColor:"#F0F5FB",padding:"10px",width:"300px",marginBottom:"10px","& > .MuiBox-root: first-of-type":{marginBottom:"20px"},"@media screen and (max-width: 700px)":{width:"100%"}}),Nt=u(h)({display:"flex",alignItems:"center",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),Vt=u(h)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),Kt=u(h)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),qt=u("img")({width:"250px"}),Gt=u(h)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px",width:"100%"}),Jt=u(h)({display:"flex",margin:"20px 40px",boxSizing:"border-box",justifyContent:"space-between",gap:"20px","@media screen and (max-width: 700px)":{flexDirection:"column"}});function Qt(e){var i,p,C,k;return t.jsx(At,{children:t.jsx(tt,{label:e.title||((p=(i=e.value)==null?void 0:i.title)==null?void 0:p[e.language])||"",detail:(k=e.contents&&e.contents.length>0?e.contents:(C=e.value)==null?void 0:C.content)==null?void 0:k.map((g,S)=>g!=null&&g.isTitle?t.jsx(D,{color:"#474747",fontSize:16,fontWeight:"700",fontFamily:"Inter",children:g==null?void 0:g[e.language]},S):g!=null&&g.url?t.jsx(ke,{children:t.jsx("img",{src:g==null?void 0:g.url})},S):t.jsx(D,{color:"#474747",fontSize:16,fontWeight:"500",fontFamily:"Inter",children:g==null?void 0:g[e.language]},S))})})}const Xt=[{toolName:"Western",onClick:()=>{}},{toolName:"Arabic",onClick:()=>{}}];function Zt(e){var pe,fe,me;const i=Je(),[p,C]=x.useState(!1),[k,g]=x.useState(e.currentBook),[S,T]=x.useState((pe=i.state.subBookInfo)==null?void 0:pe.subBookId),[M,_]=x.useState(i.state.chapterId),[d,R]=x.useState(e.currentLanguage),[H,a]=x.useState([]),[c,f]=x.useState(((fe=i.state.subBookInfo.chapterInfos[0].chapterIsCompleted)==null?void 0:fe[d])||!1),[b,j]=x.useState(((me=i.state.subBookInfo.chapterInfos[0].chapterIsPublished)==null?void 0:me[d])||!1),[A,m]=x.useState(!1),[v,B]=x.useState([]),[E,z]=x.useState(!1),G=Qe(),U=Xe(),F=x.useMemo(()=>i.state.languages,[i]);x.useEffect(()=>{var s,y;const n=e.bookInfos.find(l=>l.bookTitle.en==e.currentBook),o=(s=n==null?void 0:n.subBooks)==null?void 0:s.find(l=>l.subBookId==S),r=(o==null?void 0:o.chapterInfos)&&(o==null?void 0:o.chapterInfos[0].chapterNumber)==0&&((y=o==null?void 0:o.chapterInfos[0])==null?void 0:y.chapterId)||"";_(r)},[S]),x.useEffect(()=>{C(!0),B([]),Ce.getIntroVerses(M).then(n=>{var r,s,y;f(((r=n.isCompleted)==null?void 0:r[d])||!1),j(((s=n.isPublished)==null?void 0:s[d])||!1);const o=[];n.verses&&n.verses.length>0&&((y=n.verses)==null||y.map(l=>{var w,W;const I=l.number;if(!l.isCollapse&&l.title){const O={id:l.id||`title-${Date.now()}-${Math.random()}`,type:"title",blockIndex:I,value:(w=l.title)==null?void 0:w[d]};o.push(O)}else if(!l.isCollapse&&l.text){const O={id:l.id||`text-${Date.now()}-${Math.random()}`,type:"text",blockIndex:I,value:(W=l.text)==null?void 0:W[d]};o.push(O)}else if(!l.isCollapse&&l.image){const O={id:l.id||`image-${Date.now()}-${Math.random()}`,type:"image",blockIndex:I,value:l.image};o.push(O)}else if(l.isCollapse){const O={id:l.id||`collapsible-${Date.now()}-${Math.random()}`,type:"collapsible",blockIndex:I,value:l};o.push(O)}})),B(o),C(!1)}).catch(n=>{console.log(`warning/error while getting intro information: 
`,n),le.warning("No introduction information for the chapter.",{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),C(!1)})},[M,d]);const ne=()=>{localStorage.removeItem(ot),e.dispatch({type:V.RESET_USER}),e.dispatch({type:V.RESET_BOOK}),e.dispatch({type:V.RESET_APP_TEXT_PAGES}),U("/admin")},oe=()=>t.jsx(et,{isLoggedIn:!0,username:e.currentUser.username,isAdmin:e.currentUser.isAdmin,onLogOut:ne}),Te=n=>{g(n),U("/admin/bookoverview"),e.dispatch({type:V.SET_BOOK,payload:{bookTitle:n}})},Re=()=>t.jsx(Et,{children:t.jsx(st,{books:lt.map(n=>({bookTitle:n.bookTitle,onClick:()=>{Te(n.value)}})),selectedBook:k})});x.useEffect(()=>{var o;const n=e.bookInfos.find(r=>r.bookTitle.en==e.currentBook);if(n){const s=Array.from(new Set(n.subBooks.map(y=>y.subBookId))).map(y=>n.subBooks.find(l=>l.subBookId===y)).map(y=>{var l;return{label:(l=y.subBookTitle)==null?void 0:l[d],value:y.subBookId}});a(s),T(((o=i.state.subBookInfo)==null?void 0:o.subBookId)||s[0].value)}},[e.currentBook]);const Fe=n=>{const o=n.target.value;T(o)},Ee=n=>{const o=n.target.value;R(o)},ze=()=>t.jsx(zt,{children:t.jsxs(Ot,{children:[(k==at||k==rt)&&t.jsx(ve,{label:"",options:H,value:H.find(n=>n.value===S)?S:"",backgroundColor:"#fff",textColor:"#155D74",onChange:Fe}),t.jsx(ve,{label:"",options:F,value:d,backgroundColor:"#fff",textColor:"#155D74",onChange:Ee})]})}),he=(n,o)=>{f(n),n&&j(o),!n&&j(!1),z(!0)},Oe=n=>{const o={chapterAudio:n.audio,chapterId:n._id,chapterNumber:n.chapterNumber,chapterTranslated:n.isTranslated,chapterIsCompleted:n.isCompleted,chapterIsPublished:n.isPublished,subBookId:n.subBook},r=e.bookInfos.map(s=>({...s,subBooks:s.subBooks.map(y=>({...y,chapterInfos:y.chapterInfos.map(l=>l.chapterId===M?{...l,...o}:l)}))}));e.dispatch({type:V.SET_BOOKINFOS,payload:{bookInfos:r}})},Pe=x.useCallback(()=>{C(!0);const n=[];v.map((r,s)=>{var y;switch(r.type){case"title":{const l=r.value,I={chapter:M,title:{[d]:l},text:{},image:{},number:s+1,isCollapse:!1,content:[]};n.push(I);break}case"text":{const l=r.value,I={chapter:M,title:{},text:{[d]:l},image:{},number:s+1,isCollapse:!1,content:[]};n.push(I);break}case"image":{const l=r.value,I=l.url,w=l.alt,W={chapter:M,title:{},text:{},image:{url:I,alt:w},number:s+1,isCollapse:!1,content:[]};n.push(W);break}case"collapsible":{let l={chapter:M,title:{},text:{},image:{},number:s+1,isCollapse:!0,content:[]};const I=[],w=r.value,W=(y=w[0])==null?void 0:y.value;l={...l,title:{[d]:W}};for(const O of Object.keys(w).slice(1)){const $=w[O];if($.type=="title"){const N={[d]:$.value,isTitle:!0};I.push(N)}else if($.type=="text"){const N={[d]:$.value,isTitle:!1};I.push(N)}else if($.type=="image"){const N=$.value,Ve={url:N.url,alt:N.alt};I.push(Ve)}}l={...l,content:I},n.push(l);break}}});const o={languageCode:d,subBookId:S,chapterId:M,isCompleted:{[d]:c},isPublished:{[d]:b},verses:n};Ce.updateIntroData(o).then(r=>{Oe(r),le.success("Successfully updated.",{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),C(!1)}).catch(r=>{le.error(r.message,{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),C(!1)})},[v,c,b]),_e=()=>t.jsxs(Pt,{children:[t.jsx(be,{label:"Complete",value:c,disable:v.length==0,onChange:()=>he(!c,b)}),t.jsx(be,{label:"Publish",value:b,disable:!c,onChange:()=>he(c,!b)}),t.jsx(_t,{isdisable:E?"false":"true",children:t.jsx(P,{label:"Save Changes",disabled:!E,onClick:Pe})})]}),J=n=>{const r={id:`${n}-${Date.now()}`,blockIndex:v.length,type:n,value:n=="image"?{url:"",alt:""}:""};z(!0),B([...v,r])},Q=n=>{const o=v.filter(r=>r.id!==n);z(!0),B(o)},Le=()=>t.jsxs(Lt,{children:[t.jsxs(Ht,{children:[t.jsx(Z,{children:t.jsx(P,{label:"Add Title",onClick:()=>J("title")})}),t.jsx(Z,{children:t.jsx(P,{label:"Add Text",onClick:()=>J("text")})}),t.jsx(Z,{children:t.jsx(P,{label:"Add Image",onClick:()=>J("image")})}),t.jsx(Z,{children:t.jsx(P,{label:"Add Collapsible",onClick:()=>J("collapsible")})})]}),t.jsx(Ut,{children:t.jsx(P,{label:A?"Hide Preview":"Show Preview",onClick:()=>m(!A)})})]}),ge=(n,o)=>{z(!0),B(v.map(r=>r.id==n?{...r,value:o}:r))},xe=(n,o)=>{z(!0),B(r=>r.map(s=>s.id===n?{...s,value:{...s.value,...o}}:s))},He=(n,o)=>{z(!0),B(r=>r.map(s=>s.id==n?{...s,value:{...s.value,...o}}:s))},L=(n,o)=>{z(!0),B(r=>{const s=[...r];return o==="up"&&n>0&&([s[n],s[n-1]]=[s[n-1],s[n]]),o==="down"&&n<s.length-1&&([s[n],s[n+1]]=[s[n+1],s[n]]),s})},Ue=()=>t.jsx(Wt,{children:v.map((n,o)=>{switch(n.type){case"title":return t.jsx(De,{language:re(d),inputVal:n.value,blockIndex:o,onInputChange:r=>ge(n.id,r),onDelete:()=>Q(n.id),onMoveUp:()=>L(o,"up"),onMoveDown:()=>L(o,"down")},n.id);case"text":return t.jsx(Me,{language:re(d),inputVal:n.value,blockIndex:o,onInputChange:r=>ge(n.id,r),onDelete:()=>Q(n.id),onMoveUp:()=>L(o,"up"),onMoveDown:()=>L(o,"down")},n.id);case"image":return t.jsx(Ae,{url:n.value.url,alt:n.value.alt,blockIndex:o,onImageInputChange:r=>xe(n.id,{url:r}),onAltInputChange:r=>xe(n.id,{alt:r}),onDelete:()=>Q(n.id),onMoveUp:()=>L(o,"up"),onMoveDown:()=>L(o,"down")},n.id);case"collapsible":return t.jsx(Tt,{language:re(d),blockIndex:o,value:n.value,onChange:r=>He(n.id,r),onDelete:()=>Q(n.id),onMoveUp:()=>L(o,"up"),onMoveDown:()=>L(o,"down")},n.id);default:return null}})}),We=()=>v&&v.length>0&&A&&t.jsxs($t,{children:[t.jsx(D,{color:"#155D74",fontSize:18,fontWeight:"bold",textAlign:"left",fontFamily:"Inter",hasUnderline:!0,children:"PREVIEW"}),v.map((n,o)=>{var r;switch(n.type){case"title":return t.jsx(Nt,{children:t.jsx(D,{color:"black",fontWeight:"bold",textAlign:"left",fontFamily:"Inter",children:n.value})},o);case"text":return t.jsx(Vt,{children:t.jsx(D,{color:"black",fontSize:16,fontWeight:"400",fontFamily:"Inter",children:n.value})},o);case"image":return t.jsx(Kt,{children:t.jsx(qt,{src:n.value.url,alt:n.value.alt})},o);case"collapsible":{const s=Object.values(n.value),y=(r=s[0])==null?void 0:r.value,l=[];for(let I=1;I<s.length;I++){const w=s[I];(w==null?void 0:w.type)=="title"?l.push({[d]:w==null?void 0:w.value,isTitle:!0}):(w==null?void 0:w.type)=="text"?l.push({[d]:w==null?void 0:w.value,isTitle:!1}):l.push(w==null?void 0:w.value)}return t.jsx(Gt,{children:t.jsx(Qt,{language:d,blockIndex:n.blockIndex,value:n.value,title:y,contents:l,onChange:()=>{},onDelete:()=>{},onMoveDown:()=>{},onMoveUp:()=>{}})},o)}}})]}),$e=()=>t.jsxs(Jt,{children:[Ue(),We()]}),Ne=()=>t.jsxs(Ft,{children:[t.jsx(it,{tools:Xt}),Re(),ze(),_e(),Le(),$e()]});return t.jsxs(t.Fragment,{children:[t.jsxs(Rt,{flexDirection:G?"column":"row",children:[oe(),Ne()]}),p&&t.jsx(Ze,{}),t.jsx(Ye,{})]})}function Yt(e){return{dispatch:e}}function en(e){return{currentUser:e.user.currentUser,bookInfos:e.book.bookInfos,chapterInfos:e.book.chapterInfos,currentBook:e.book.book,currentLanguage:e.book.language}}const un=Ge(en,Yt)(Zt);export{un as default};

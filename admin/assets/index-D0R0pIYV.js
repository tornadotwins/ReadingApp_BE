import{O as Me,j as c,a as l}from"./createTheme-C_Nmnn35.js";import{r as $e,s as y,B as O,t as jt,W as Ft,K as At,u as Lt,A as U,X as It,H as V,F as v,Y as Dt,Z as Pt,Q as vt,E as Ht,_ as Ut,$ as Vt,a0 as Mt,a1 as $t,w as Kt,T as z,q as Wt,a2 as Gt}from"./App-DaaHOIBI.js";import{u as ue,w as qt,P as zt,r as Qt,U as Yt}from"./index-D6V-S6iA.js";import{u as re,B as Te,i as Be,b as Xt,o as Zt,k as Ee,v as ye}from"./index-CaI9eg9J.js";import{d as Jt,S as eo}from"./index-BJ9K7FKf.js";import{d as to}from"./CloudUpload-B4pWLRZn.js";import{b as de}from"./book.services-BuwRYMQE.js";import{t as oo}from"./translator.services-BQDpZOCP.js";import{b as he,a as G}from"./images-B-3euPqr.js";import{S as Oe}from"./index-CFdtRtyq.js";import{T as ro}from"./index-jBYCsr-c.js";import{T as ao,B as no}from"./index-C21iL05o.js";import"./index-7HhkekAX.js";import"./index-Bgjcn6g-.js";import"./TableContainer-BZzF7qxI.js";var Ke={exports:{}};(function(s,pe){(function(L,$){$()})(re,function(){function L(o,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function $(o,d,m){var p=new XMLHttpRequest;p.open("GET",o),p.responseType="blob",p.onload=function(){q(p.response,d,m)},p.onerror=function(){console.error("could not download file")},p.send()}function x(o){var d=new XMLHttpRequest;d.open("HEAD",o,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function k(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(d)}}var R=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof re=="object"&&re.global===re?re:void 0,h=R.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),q=R.saveAs||(typeof window!="object"||window!==R?function(){}:"download"in HTMLAnchorElement.prototype&&!h?function(o,d,m){var p=R.URL||R.webkitURL,S=document.createElement("a");d=d||o.name||"download",S.download=d,S.rel="noopener",typeof o=="string"?(S.href=o,S.origin===location.origin?k(S):x(S.href)?$(o,d,m):k(S,S.target="_blank")):(S.href=p.createObjectURL(o),setTimeout(function(){p.revokeObjectURL(S.href)},4e4),setTimeout(function(){k(S)},0))}:"msSaveOrOpenBlob"in navigator?function(o,d,m){if(d=d||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(L(o,m),d);else if(x(o))$(o,d,m);else{var p=document.createElement("a");p.href=o,p.target="_blank",setTimeout(function(){k(p)})}}:function(o,d,m,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof o=="string")return $(o,d,m);var S=o.type==="application/octet-stream",me=/constructor/i.test(R.HTMLElement)||R.safari,I=/CriOS\/[\d]+/.test(navigator.userAgent);if((I||S&&me||h)&&typeof FileReader<"u"){var Q=new FileReader;Q.onloadend=function(){var D=Q.result;D=I?D:D.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=D:location=D,p=null},Q.readAsDataURL(o)}else{var K=R.URL||R.webkitURL,H=K.createObjectURL(o);p?p.location=H:location.href=H,p=null,setTimeout(function(){K.revokeObjectURL(H)},4e4)}});R.saveAs=q.saveAs=q,s.exports=q})})(Ke);var so=Ke.exports,Ne={},io=Me;Object.defineProperty(Ne,"__esModule",{value:!0});var We=Ne.default=void 0,lo=io($e()),co=c;We=Ne.default=(0,lo.default)((0,co.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download");var we={},uo=Me;Object.defineProperty(we,"__esModule",{value:!0});var Ge=we.default=void 0,ho=uo($e()),po=c;Ge=we.default=(0,ho.default)((0,po.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload");const mo=y(O)({position:"relative",minHeight:"calc(100vh - 37px)",width:"100%","& >.MuiBox-root:first-of-type":{backgroundColor:"#1B7695","& >.MuiBox-root":{color:"#F6FCFC"}}}),go=y(O)({width:"100%",height:"calc(100% - 73px)",margin:"auto",marginTop:"73px"}),bo=y(O)({margin:"20px 40px"}),fo=y(O)({backgroundColor:"#F0F5FB",margin:"20px 40px",padding:"20px",boxSiaing:"border-box"}),xo=y(O)({margin:"20px 40px",display:"flex",justifyContent:"center",boxSizing:"border-box"}),So=y(O)({margin:"20px 40px",display:"flex",alignItems:"center","@media screen and (max-width: 800px)":{display:"block"}}),Co=y(O)({height:"40px",display:"flex",alignItems:"center",cursor:"pointer",marginRight:"250px",transitionDuration:".25s","&:hover":{transform:"scale(1.1)"},"& .MuiSvgIcon-root":{width:"16px",marginRight:"10px",fill:"#155D74"},"@media screen and (max-width: 1050px)":{marginRight:"100px"},"@media screen and (max-width: 900px)":{marginRight:"30px"}}),ko=y(O)({display:"flex",justifyContent:"space-between",alignItems:"center","& >.MuiBox-root":{minWidth:"100px",marginRight:"20px"},"& > .MuiFormControl-root":{marginRight:"20px"},"@media screen and (max-width: 900px)":{"& >.MuiBox-root":{minWidth:"50px",marginRight:"10px"}},"@media screen and (max-width: 650px)":{display:"block","& > .MuiFormControl-root":{alignItems:"start","& .MuiInputBase-root":{width:"100%"}}}});y(O)({border:"1px solid #1B7695",backgroundColor:"#F0F5FB",boxSizing:"border-box",padding:"20px",margin:"20px 40px"});y(O)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"300px","& >.MuiBox-root>:nth-of-type(2)":{marginRight:"25px"}});const _o=y(O)({display:"flex",alignItems:"center",margin:"50px 40px 20px 40px"}),Ve=y(O)(({active:s})=>({display:"flex",alignItems:"center",justifyContent:"center",width:"120px",padding:"5px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:s=="true"?"#1B7695":"#F0F5FB",color:s=="true"?"#FFF":"#474747",cursor:"pointer","& .MuiSvgIcon-root":{fill:s=="true"?"#FFF":"#474747",marginRight:"10px"}})),To=y(O)({display:"flex",justifyContent:"right",alignItems:"center",boxSizing:"border-box",margin:"20px 40px"}),Bo=y(O)(({isdisable:s})=>({display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"25px",padding:"0px 10px",boxSizing:"border-box",backgroundColor:"#FFAA5D",cursor:s=="true"?"not-allowed":"pointer","&:hover":{backgroundColor:s=="true"?"#FFAA5D":"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",textTransform:"none","&:hover":{backgroundColor:s=="true"?"#FFAA5D":"#EE994C"}}})),Eo=y(O)({width:"90%",height:"calc(100% - 73px)",margin:"auto",marginTop:"20px"}),yo=[{toolName:"Western",onClick:()=>{}},{toolName:"Arabic",onClick:()=>{}}];function Oo(s){const pe=Ft(),L=pe.state,[$,x]=l.useState(!1),[k,R]=l.useState(null),[h,q]=l.useState(null),[o,d]=l.useState(L.chapterInfo),[m,p]=l.useState([]),[S,me]=l.useState(null),[I,Q]=l.useState(),[K,H]=l.useState([]),[D,Y]=l.useState([]),[ge,X]=l.useState([]),[w,Re]=l.useState([]),[be,je]=l.useState([]),[qe,fe]=l.useState(""),[ae,ze]=l.useState([]),[ne,Fe]=l.useState([]),[T,Qe]=l.useState(s.currentBook),[P,Ae]=l.useState(L.subBookInfo.subBookId),[N,se]=l.useState(L.chapterId),[u,Le]=l.useState(s.currentLanguage||"en"),[_,Ye]=l.useState(L.isImport),[Xe,xe]=l.useState(!1),[Se,ie]=l.useState(!1),[Ze,Ie]=l.useState(0),[Je,Ce]=l.useState(0),[et,Z]=l.useState(""),[tt,le]=l.useState(""),[ot,De]=l.useState(""),[rt,ce]=l.useState(""),ke=l.useMemo(()=>pe.state.languages,[s.currentUser]),at=At(),_e=Lt(),Pe=l.useCallback(async e=>(x(!0),await de.getChapterInfoByChapterId(e)),[N]),J=l.useCallback(()=>{var n,i,C,E,B,b,W;const e=(n=k==null?void 0:k.subBooks)==null?void 0:n.find(g=>g.subBookId==P);let t=[],a=[];const r=((i=k==null?void 0:k.bookTitle)==null?void 0:i.en)=="Qur'an"||((C=k==null?void 0:k.bookTitle)==null?void 0:C.en)=="Zabur";if(u=="en")r?(t=["SubBook_English","SubBook_Transliteration","Chapter_Number","Verse_Number","Verse_English"],a=m==null?void 0:m.map(g=>{var f,j,F,A,M;return{SubBook_English:((f=e==null?void 0:e.subBookTitle)==null?void 0:f.en)||"",SubBook_Transliteration:((j=e==null?void 0:e.subBookTitle)==null?void 0:j.transliteration)||"",Chapter_Number:((F=o==null?void 0:o.chapterNumber)==null?void 0:F.toString())||"1",Verse_Number:((A=g==null?void 0:g.verseNumber)==null?void 0:A.toString())||"1",Verse_English:((M=g==null?void 0:g.verseText)==null?void 0:M.en)||""}})):(t=["SubBook_English","Chapter_Number","Verse_Number","Verse_English"],a=m==null?void 0:m.map(g=>{var f,j,F,A;return{SubBook_English:((f=e==null?void 0:e.subBookTitle)==null?void 0:f.en)||"",Chapter_Number:((j=o==null?void 0:o.chapterNumber)==null?void 0:j.toString())||"1",Verse_Number:((F=g==null?void 0:g.verseNumber)==null?void 0:F.toString())||"1",Verse_English:((A=g==null?void 0:g.verseText)==null?void 0:A.en)||""}}));else{const g=G(u);r?(t=["SubBook_English",`SubBook_${g}`,"SubBook_Transliteration","Chapter_Number","Verse_Number",`Verse_${g}`],a=(B=(E=m[0])==null?void 0:E.verseText)!=null&&B[u]?m==null?void 0:m.map(f=>{var j,F,A,M,ee,te,oe,Ue;return{SubBook_English:((j=e==null?void 0:e.subBookTitle)==null?void 0:j.en)||"",[`SubBook_${g}`]:((F=e==null?void 0:e.subBookTitle)==null?void 0:F[u])||((A=e==null?void 0:e.subBookTitle)==null?void 0:A.en)||"",SubBook_Transliteration:r&&((M=e==null?void 0:e.subBookTitle)==null?void 0:M.transliteration)||"",Chapter_Number:((ee=o==null?void 0:o.chapterNumber)==null?void 0:ee.toString())||"1",Verse_Number:((te=f==null?void 0:f.verseNumber)==null?void 0:te.toString())||"1",[`Verse_${g}`]:((oe=f==null?void 0:f.verseText)==null?void 0:oe[u])||((Ue=f==null?void 0:f.verseText)==null?void 0:Ue.en)||""}}):[]):(t=["SubBook_English",`SubBook_${g}`,"Chapter_Number","Verse_Number",`Verse_${g}`],a=(W=(b=m[0])==null?void 0:b.verseText)!=null&&W[u]?m==null?void 0:m.map(f=>{var j,F,A,M,ee,te,oe;return{SubBook_English:((j=e==null?void 0:e.subBookTitle)==null?void 0:j.en)||"",[`SubBook_${g}`]:((F=e==null?void 0:e.subBookTitle)==null?void 0:F[u])||((A=e==null?void 0:e.subBookTitle)==null?void 0:A.en)||"",Chapter_Number:((M=o==null?void 0:o.chapterNumber)==null?void 0:M.toString())||"1",Verse_Number:((ee=f==null?void 0:f.verseNumber)==null?void 0:ee.toString())||"1",[`Verse_${g}`]:((te=f==null?void 0:f.verseText)==null?void 0:te[u])||((oe=f==null?void 0:f.verseText)==null?void 0:oe.en)||""}}):[])}H(t||[]),Y(a||[])},[k,o,m,P,u,_]),nt=l.useCallback(()=>{const e=`${T}-${he(P,ae)}-${he(N,ne)}`,t=ue.json_to_sheet(D),a=ue.book_new();ue.book_append_sheet(a,t,"Sheet1");const r=qt(a,{bookType:"xlsx",type:"array"}),n=new Blob([r],{type:"application/octet-stream"});so.saveAs(n,`${e}.xlsx`),U.success(It,{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3})},[D,K]);l.useEffect(()=>{window.scrollTo({top:0})},[]),l.useEffect(()=>{(async()=>{var t;x(!0);try{const a=s.bookInfos.find(r=>r.bookTitle.en==T);if(a){R(a);const n=Array.from(new Set(a.subBooks.map(i=>i.subBookId))).map(i=>a.subBooks.find(C=>C.subBookId===i)).map(i=>{var C,E,B;return{label:((C=i.subBookTitle)==null?void 0:C[u])||((E=i.subBookTitle)==null?void 0:E.en)||((B=i.subBookTitle)==null?void 0:B.ar)||"No title for sub book",value:i.subBookId}});ze(n),n.some(i=>i.value===P)||Ae(((t=n[0])==null?void 0:t.value)||"")}if(N){const r=s.chapterInfos.find(n=>n.chapterId==N);r?d(r):Pe(N).then(n=>{d(n),s.dispatch({type:v.ADD_CHAPTERINFO,payload:{chapterInfo:n}}),x(!1)}).catch(()=>{x(!1)})}J()}catch{U.error("Failed to load book information",{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3})}finally{x(!1)}})()},[T]),l.useEffect(()=>{var r,n,i,C,E,B;const e=s.bookInfos.find(b=>(b==null?void 0:b.bookTitle.en)==s.currentBook),t=e==null?void 0:e.subBooks.find(b=>b.subBookId==P);t&&q(t),Z(((r=t==null?void 0:t.subBookTitle)==null?void 0:r[u])||""),le(((n=t==null?void 0:t.subBookTitle)==null?void 0:n.ar)||""),ce(((i=t==null?void 0:t.subBookTitle)==null?void 0:i.en)||""),De(((C=t==null?void 0:t.subBookTitle)==null?void 0:C.transliteration)||"");const a=(B=(E=t==null?void 0:t.chapterInfos)==null?void 0:E.filter(b=>b.chapterNumber!==0))==null?void 0:B.map(b=>({value:b.chapterId,label:b.chapterNumber.toString()}));a&&L.chapterId?(Fe(a),se(L.chapterId)):a&&(Fe(a),se(a[0].value)),J()},[P,s.currentBook]),l.useEffect(()=>{H([]),Y([]);const e=s.chapterInfos.find(t=>t.chapterId==N);e?(d(e),p((e==null?void 0:e.verses)||[])):Pe(N).then(t=>{d(t),p(t.verses||[]),s.dispatch({type:v.ADD_CHAPTERINFO,payload:{chapterInfo:t}}),x(!1)}).catch(()=>{H([]),Y([]),Ie(0),Ce(0),xe(!1),ie(!1),U.warning("Chapter is empty. Click Import to add verses.",{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),x(!1)}),L.chapterId="",J()},[s.chapterInfos,N]),l.useEffect(()=>{var a,r,n,i,C,E,B;Ce(0),J();const e=((a=o==null?void 0:o.chapterIsCompleted)==null?void 0:a[u])||!1,t=((r=o==null?void 0:o.chapterIsPublished)==null?void 0:r[u])||!1;xe(e),ie(t),Ie(((n=o==null?void 0:o.verses)==null?void 0:n.length)||0),(i=o.verses)==null||i.map(b=>Ce(W=>{var g;return(g=b==null?void 0:b.verseText)!=null&&g[u]?W+1:W})),Z(((C=h==null?void 0:h.subBookTitle)==null?void 0:C[u])||""),le(((E=h==null?void 0:h.subBookTitle)==null?void 0:E.ar)||""),ce(((B=h==null?void 0:h.subBookTitle)==null?void 0:B.en)||""),se(o.chapterId)},[m,k,h,o,u]),l.useEffect(()=>{_||J()},[_]),l.useEffect(()=>{const e=(I==null?void 0:I.target.files)&&(I==null?void 0:I.target.files[0]);e&&me(e)},[I,_]),l.useEffect(()=>{var e;if(_){je([]);const t=w[0],a=(e=ke.find(r=>r.value==u))==null?void 0:e.label;a!="English"&&X(r=>[...r,"SubBook_English"]),t&&Object.keys(t).forEach(r=>{r=="SubBook_Transliteration"&&X(n=>[...n,r]),a&&r.includes(a)&&X(n=>[...n,r])}),X(r=>[...r,"Chapter_Number","Verse_Number"]),w.forEach(r=>{const n={};n.SubBook_English=r.SubBook_English,Object.keys(r).forEach(i=>{i.includes(a)&&(n[i]=r[i]),i=="SubBook_Transliteration"&&a=="English"&&(n[i]=r[i])}),n.Chapter_Number=r.Chapter_Number,n.Verse_Number=r.Verse_Number,je(i=>[...i,n])})}},[w,u,_]),l.useEffect(()=>{if(_){if(X([]),!S)return;const e=S.name,t=e.substr(e.lastIndexOf(".")+1).toLowerCase();t==="csv"?ft(S):["xlsx","xls"].includes(t)?xt(S):console.error("Unsupported file format")}},[S,u,_]),l.useEffect(()=>{if(_){const e=["SubBook_English",`SubBook_${G(u)}`,"Chapter_Number","Verse_Number",`Verse_${G(u)}`].filter((a,r,n)=>a&&n.indexOf(a)===r);let t="";if(w.length>1){const a=Object.keys(w[0]),r=e.filter(b=>!a.includes(b));r.forEach(b=>t+=`${b}, `),t&&(t=`You missed the ${r.length>=2?"fields":"field"}: `+t);const n=w[0][`SubBook_${G(u)}`];w.find(b=>b[`SubBook_${G(u)}`]!=n)&&(t=Ut);const C=w[0].SubBook_Transliteration;w.find(b=>b.SubBook_Transliteration!=C)&&(t=Vt);const B=ge.includes("SubBook_Transliteration");s.currentBook==Te||s.currentBook==Be?(B||(t=Mt),w.some(W=>W.Chapter_Number!="1")&&(t=$t),fe(t)):(B&&(t=Dt),fe(t))}w.length==0&&(t=Pt,fe(t))}},[D,ge,_,u,w,be]);const st=e=>{Qe(e),_e("/admin/bookoverview"),s.dispatch({type:v.SET_BOOK,payload:{bookTitle:e}})},it=e=>{const t=e.target.value;Ae(t)},lt=e=>{const t=e.target.value;se(t)},ct=e=>{const t=e.target.value;Le(t),H([]),Y([]),s.dispatch({type:v.SET_CURRENT_LANGUAGE,payload:{language:t}})},ve=e=>{const t={chapterAudio:e.audio,chapterId:e._id,chapterNumber:e.chapterNumber,chapterTranslated:e.isTranslated,chapterIsCompleted:e.isCompleted,chapterIsPublished:e.isPublished,subBookId:e.subBook,verses:e.verses};d(t);const a=s.bookInfos.map(r=>({...r,subBooks:r.subBooks.map(n=>({...n,chapterInfos:n.chapterInfos.map(i=>i.chapterId===N?{...i,...t}:i)}))}));s.dispatch({type:v.SET_BOOKINFOS,payload:{bookInfos:a}}),s.dispatch({type:v.UPDATE_CHAPTERINFOS,payload:{chapterInfo:t}})},ut=e=>{const t={chapterInfos:(h==null?void 0:h.chapterInfos)||[],subBookId:(h==null?void 0:h.subBookId)||"",subBookNumber:(h==null?void 0:h.subBookNumber)||1,subBookTitle:e.title,noChapter:!0},a=s.bookInfos.map(r=>({...r,subBooks:r.subBooks.map(n=>n.subBookId==P?{...n,...t}:n)}));s.dispatch({type:v.SET_BOOKINFOS,payload:{bookInfos:a}})},dt=async e=>{xe(e),ie(e&&Se),x(!0);const t={chapterNumber:o.chapterNumber||1,subBook:o.subBookId||"",audio:o.chapterAudio,isTranslated:o.chapterTranslated,isCompleted:{...o.chapterIsCompleted,[u]:e},isPublished:{...o.chapterIsPublished,[u]:e&&Se}};de.updateChapterInfo({chapterId:N,newChapterInfo:t}).then(a=>{ve(a),x(!1)}).catch(()=>{U.error("Failed to complete the chapter",{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),x(!1)})},ht=async e=>{ie(e);const t={chapterNumber:o.chapterNumber||1,subBook:o.subBookId||"",audio:o.chapterAudio,isTranslated:o.chapterTranslated,isCompleted:o.chapterIsCompleted,isPublished:{...o.chapterIsPublished,[u]:e}};de.updateChapterInfo({chapterId:N,newChapterInfo:t}).then(a=>{ve(a),x(!1)}).catch(()=>{U.error("Failed to publish the chapter",{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),x(!1)})},pt=e=>{u=="en"?ce(e):u=="ar"&&le(e),Z(e)},mt=e=>{u=="ar"&&Z(e),le(e)},gt=e=>{u=="en"&&Z(e),ce(e)},bt=(e,t,a,r)=>{const n={[`${u}`]:e,ar:t,transliteration:a,en:r},i={...h,subBookTitle:n},C={title:i.subBookTitle,number:i.subBookNumber||1,book:(k==null?void 0:k.bookId)||"",noChapter:!0};h!=null&&h.subBookId?(x(!0),de.updateSubBookInfo({subBookId:h==null?void 0:h.subBookId,newSubBookInfo:C}).then(E=>{ut(E),x(!1)}).catch(()=>{U.error("Failed to update the summary of chapter",{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),x(!1)})):U.error(Gt,{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3})},He=e=>{Ye(e),H([]),Y([])},ft=e=>{try{const t=new FileReader;t.onload=a=>{var n;const r=(n=a.target)==null?void 0:n.result;if(!r){console.error("Failed to read file");return}zt.parse(r,{complete:i=>{if(i.errors.length>0){console.error("CSV parsing errors:",i.errors);return}const C=i.data;Re(C)},header:!0,skipEmptyLines:!0,transformHeader:i=>i.trim(),transform:i=>i.trim()})},t.onerror=a=>{console.error("Error reading file:",a)},t.readAsText(e)}catch(t){console.error("Error parsing CSV file:",t)}},xt=l.useCallback(async e=>{try{const t=new FileReader;t.onload=a=>{var B;const r=(B=a.target)==null?void 0:B.result;if(!r){console.error("Failed to read file");return}const n=Qt(r,{type:"array"}),i=n.SheetNames[0],C=n.Sheets[i],E=ue.sheet_to_json(C);Re(E)},t.onerror=a=>{console.error("Error reading file:",a)},t.readAsArrayBuffer(e)}catch(t){console.error("Error parsing Excel file:",t)}},[S]),St=l.useCallback(()=>{x(!0),oo.saveBook({bookInfos:be,bookTitle:s.currentBook,language:G(u)}).then(()=>{x(!1),U.success("Saved successfully!",{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3})}).catch(()=>{U.error("Failed to save book",{position:"top-right",draggable:!0,theme:"colored",transition:V,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),x(!1)})},[u,be]),Ct=()=>{localStorage.removeItem(Xt),s.dispatch({type:v.RESET_USER}),s.dispatch({type:v.RESET_BOOK}),s.dispatch({type:v.RESET_APP_TEXT_PAGES}),_e("/admin")},kt=()=>c.jsx(Kt,{isLoggedIn:!0,username:s.currentUser.username,isAdmin:s.currentUser.isAdmin,isTranslationPage:!0,onLogOut:Ct}),_t=()=>c.jsx(bo,{children:c.jsx(no,{books:Zt.map(e=>({bookTitle:e.bookTitle,onClick:()=>{st(e.value)}})),selectedBook:T})}),Tt=()=>_&&c.jsx(fo,{children:c.jsx(z,{color:"red",fontFamily:"'Baloo Da 2'",fontWeight:"bold",children:T==Te||T==Be?`For ${T} you can upload only one chapter at once`:`For ${T} you can upload multiple chapters of the same sub-book at once`})}),Bt=()=>c.jsxs(So,{children:[c.jsxs(Co,{onClick:()=>_e("/admin/bookoverview"),children:[c.jsx(Jt,{}),c.jsx(z,{fontFamily:"Inter",color:"#155D74",fontWeight:"500",children:"overview"})]}),!_&&c.jsxs(ko,{children:[c.jsx(z,{fontFamily:"Inter",color:"#155D74",fontWeight:"500",children:T==Ee||T==ye?"Go to: ":"Go to Surah: "}),c.jsx(Oe,{label:"",options:ae,value:ae.find(e=>e.value===P)?P:"",backgroundColor:"#fff",textColor:"#155D74",onChange:it}),(T==Ee||T==ye)&&c.jsx(Oe,{label:"",options:ne,value:ne.find(e=>e.value===N)?N:"",backgroundColor:"#fff",textColor:"#155D74",onChange:lt}),c.jsx(Oe,{label:"",options:ke,value:u,backgroundColor:"#fff",textColor:"#155D74",onChange:ct})]})]}),Et=()=>!_&&c.jsx(eo,{currentUser:s.currentUser,currentBook:s.currentBook,totalCountVerse:Ze,languageCountVerse:Je,isComplete:Xe,isPublish:Se,isSpecialBook:T==Te||T==Be,currentLanguage:u,arabicChapterTitle:tt,englishChapterTitle:rt,transliteration:ot,currentChapterTitle:et,handleComplete:e=>dt(e),handlePublish:e=>ht(e),handleCurrentChapterTitleChange:e=>pt(e),handleArabicChapterTitleChange:e=>mt(e),handleTransliterationChapterTitleChange:e=>De(e),handleEnglishChapterTitleChange:e=>gt(e),handleUpdateChapterSummary:bt}),yt=()=>c.jsxs(_o,{children:[c.jsxs(Ve,{active:_?"false":"true",onClick:()=>He(!1),children:[c.jsx(Ge,{}),c.jsx(z,{fontFamily:"'Baloo Da 2'",children:"Database"})]}),c.jsxs(Ve,{active:_?"true":"false",onClick:()=>He(!0),children:[c.jsx(to,{}),c.jsx(z,{fontFamily:"'Baloo Da 2'",children:"Import"})]})]}),Ot=()=>!_&&c.jsxs(To,{children:[c.jsx(z,{fontFamily:"Inter",color:"#155D74",fontWeight:"500",children:`${T} - 
            ${he(P,ae)} 
            ${T==Ee||T==ye?he(N,ne):""}`}),c.jsx(Bo,{isdisable:K.length?"false":"true",children:c.jsx(Wt,{label:"Export to Excel",disabled:!K.length,icon:c.jsx(We,{}),onClick:nt})})]}),Nt=()=>!_&&c.jsx(xo,{children:c.jsx(ro,{headers:K,rows:D})}),wt=()=>_&&c.jsx(Eo,{children:c.jsx(Yt,{language:u,languageLabel:G(u),languages:ke,file:S,parsedData:w,headers:ge,error:qe,onChangeLanguage:e=>Le(e.target.value),onChangeFile:e=>Q(e),onUpload:St})}),Rt=()=>c.jsxs(go,{children:[c.jsx(ao,{tools:yo}),_t(),yt(),Bt(),Tt(),Et(),Ot(),Nt(),wt()]});return c.jsxs(c.Fragment,{children:[c.jsxs(mo,{flexDirection:at?"column":"row",children:[kt(),Rt()]}),c.jsx(vt,{}),$&&c.jsx(Ht,{})]})}function No(s){return{dispatch:s}}function wo(s){return{currentUser:s.user.currentUser,bookInfos:s.book.bookInfos,chapterInfos:s.book.chapterInfos,currentBook:s.book.book,currentLanguage:s.book.language}}const Wo=jt(wo,No)(Oo);export{Wo as default};

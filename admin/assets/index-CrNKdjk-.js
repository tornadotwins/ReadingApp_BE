import{j as a,a as d}from"./createTheme-DG-pJtVH.js";import{s as i,z as g,h as m,I as K,A as q,D as J,E as Q,_ as V,X as c,H as f,J as C,W as $,a0 as Y,N as Z}from"./App-CInRyRO6.js";import{T as ee,B as te}from"./index-BSihr0nO.js";import{I as ae,g as ne,a as oe}from"./images-H-PMvrKq.js";import{o as se,A as re,i as ie}from"./index-B_DB3_MX.js";import{S as v}from"./index-CYdy_Lba.js";import{A as le}from"./index-D4i4iPnM.js";import{t as B}from"./translator.services-BMXKGnXG.js";const ge=i(g)({width:"100%"}),ue=i(g)({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"5px 0px","& >:first-of-type":{minWidth:"200px"}}),de=i(g)({display:"flex",alignItems:"center","& > .MuiBox-root: first-of-type":{minWidth:"200px",width:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}),ce=i(g)({display:"flex",alignItems:"center"}),he=i(g)({display:"flex",justifyContent:"end",width:"300px",padding:"0px","& >.MuiBox-root":{width:"100%",padding:"0px !important","& >.MuiFormControl-root":{width:"100%",border:"1px solid #155D74","& input":{fontFamily:'"Baloo Da 2" !important',color:"#155D74"}}}}),xe=i("img")({width:"20px",height:"20px",marginRight:"10px","&:hover":{cursor:"pointer"}});function me(e){return a.jsxs(ge,{children:[e.terms.map((h,u)=>{var y,S;return a.jsxs(ue,{children:[a.jsxs(de,{children:[a.jsx(m,{fontFamily:"'Baloo Da 2'",fontWeight:"400",fontSize:16,lineHeight:24,color:"#A1A1A1",children:h.variable}),a.jsxs(ce,{children:[a.jsx(xe,{src:ae.icon_preview}),a.jsx(m,{fontFamily:"'Baloo Da 2'",fontWeight:"400",fontSize:16,lineHeight:24,color:"#155D74",children:(y=h.text)==null?void 0:y[e.defaultLanguage]})]})]}),a.jsx(he,{children:a.jsx(K,{value:(S=h.text)==null?void 0:S[e.currentLanguage],onChange:b=>e.onInputChange(h._id,b.target.value)})})]},u)}),a.jsx(m,{color:"#A1A1A1",textAlign:"center",fontFamily:"'Baloo Da 2'",children:"Of course this list goes on as long as it is but itâ€™s short here for the design"})]})}const pe=i(g)({borderBottom:"1px solid #155D74",display:"flex",alignItems:"center",justifyContent:"space-between",boxSizing:"border-box",padding:"10px 0px"}),fe=i(g)({display:"flex",alignItems:"center","& >:first-of-type":{minWidth:"200px"}}),Ce=i(g)(({isdisable:e})=>({display:"flex",justifyContent:"space-between",alignItems:"center",width:"300px","& .MuiButtonBase-root":{width:"140px",boxSizing:"border-box",padding:"8px 14px",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",borderRadius:"0px",border:"1px solid #474747",textTransform:"none !important",cursor:e=="true"?"not-allowed":"pointer","& .MuiBox-root":{fontWeight:"500 !important"}}}));function ye(e){return a.jsxs(pe,{children:[a.jsxs(fe,{children:[a.jsx(m,{color:"#A1A1A1",fontFamily:"'Baloo Da 2'",children:"Variable"}),a.jsx(v,{label:"",options:e.languages,value:e.defaultLanguage,backgroundColor:"#fff",textColor:"#155D74",onChange:h=>e.onChangeDefaultLanguage(h.target.value)})]}),a.jsxs(Ce,{isdisable:e.disable?"true":"false",children:[a.jsx(m,{fontFamily:"'Baloo Da 2'",fontWeight:"700",color:"#155D74",children:e.currentLanguageLabel}),a.jsx(q,{label:"Save Changes",disabled:e.disable,onClick:()=>e.onSave(e.pageId)})]})]})}const Se=i(g)({border:"1px solid #1B7695",backgroundColor:"#F0F5FB",boxSizing:"border-box",padding:"20px",margin:"20px 40px","& .MuiAccordionSummary-content > .MuiBox-root":{justifyContent:"space-between !important"},"& .MuiAccordionDetails-root":{paddingLeft:"25px !important",paddingBottom:"0px !important"},"& .MuiAccordionSummary-content > .MuiBox-root :nth-of-type(2)":{padding:"0px !important"}});function be(e){return a.jsx(Se,{children:a.jsx(le,{label:e.pageName,hasSwitches:!0,summaryIcon:!0,currentUser:e.currentUser,currentLanguage:e.currentLanguage,pageId:e.pageId,isComplete:e.isComplete,isPublish:e.isPublish,onChangeAppTextPageStatus:e.onChangeAppTextPageStatus,detail:a.jsxs(a.Fragment,{children:[a.jsx(ye,{languages:e.languages,language:e.currentLanguage,currentLanguage:e.currentLanguage,currentLanguageLabel:e.currentLanguageLabel,defaultLanguage:e.defaultLanguage,pageId:e.pageId,disable:!e.hasChangedText,onChangeDefaultLanguage:e.onChangeDefaultLanguage,onSave:e.onSave}),a.jsx(me,{defaultLanguage:e.defaultLanguage,currentLanguage:e.currentLanguage,terms:e.terms,onInputChange:e.onChangeInput})]})})})}const Te=i(g)({position:"relative",minHeight:"100vh",width:"100%","& >.MuiBox-root:first-of-type":{backgroundColor:"#1B7695","& >.MuiBox-root":{color:"#F6FCFC"}}}),Le=i(g)({width:"100%",height:"calc(100% - 73px)",margin:"auto",marginTop:"73px"}),Ae=i(g)({margin:"20px 40px"}),Be=i(g)({width:"650px",display:"flex",justifyContent:"center",alignItems:"center",margin:"20px 40px 0px 40px","& .MuiFormControl-root":{width:"unset",marginLeft:"15px"},"& .MuiBox-root":{fontFamily:'"Baloo Da 2" !important'},"@media screen and (max-width: 670px)":{width:"unset"}}),Ie=[{toolName:"Western",onClick:()=>{}},{toolName:"Arabic",onClick:()=>{}}];function Pe(e){const[h,u]=d.useState(!1),[y,S]=d.useState(se),[b,E]=d.useState([]),[p,I]=d.useState(e.currentLanguage),[_,D]=d.useState("en"),[T,L]=d.useState(e.appTextPages),[k,A]=d.useState([]),P=Q(),O=V(),w=()=>{localStorage.removeItem(re),e.dispatch({type:c.RESET_USER}),e.dispatch({type:c.RESET_BOOK}),e.dispatch({type:c.RESET_APP_TEXT_PAGES}),P("/admin")},F=()=>a.jsx(Z,{isLoggedIn:!0,username:e.currentUser.username,isAdmin:e.currentUser.isAdmin,onLogOut:w}),U=t=>{S(t),e.dispatch({type:c.SET_BOOK,payload:{bookTitle:t}}),P("/admin/bookoverview")},H=()=>a.jsx(Ae,{children:a.jsx(te,{books:ie.map(t=>({bookTitle:t.bookTitle,onClick:()=>U(t.value)})),selectedBook:y})}),j=d.useCallback(()=>{var o;if(!((o=e.currentUser)!=null&&o.roles))return[];const t=e.currentUser.roles.reduce((s,n)=>{if(n.role!=="none"){const r=ne(n.language);s.some(x=>x.value===r)||s.push({value:r,label:n.language})}return s},[]);return e.currentLanguage||e.dispatch({type:c.SET_CURRENT_LANGUAGE,payload:{language:t[0].value}}),t},[e.currentUser]);d.useEffect(()=>{const t=j();E(t),t.length>0&&!t.some(o=>o.value===p)&&I(t[0].value)},[e.currentUser,p,j]);const M=t=>{const o=t.target.value;I(o),e.dispatch({type:c.SET_CURRENT_LANGUAGE,payload:{language:o}})},R=()=>a.jsxs(Be,{children:[a.jsx(m,{color:"#155D74",fontWeight:"700",fontFamily:"'Baloo Da 2'",children:"App text:"}),a.jsx(v,{label:"",options:b,value:p,backgroundColor:"#fff",textColor:"#155D74",onChange:M})]});d.useEffect(()=>{const t=async()=>await B.getAllAppTexts();e.appTextPages&&e.appTextPages.length==0&&(u(!0),t().then(o=>{e.dispatch({type:c.SET_APP_TEXT_PAGES,payload:{appTextPages:o}}),o.map(s=>A(n=>[...n,{pageId:s.pageId,isChanged:!1}])),u(!1)}).catch(o=>{f.error(o instanceof Error?o.message:String(o),{position:"top-right",draggable:!0,theme:"colored",transition:C,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),u(!1)}))},[]),d.useEffect(()=>{L(e.appTextPages)},[e.appTextPages]);const N=(t,o)=>{var n;L(r=>r.map(l=>({...l,texts:l.texts.map(x=>x._id===t?{...x,text:{...x.text,[p]:o}}:x)})));const s=(n=T.find(r=>r.texts.find(l=>l._id==t)))==null?void 0:n.pageId;A(r=>r.map(l=>l.pageId==s?{...l,isChanged:!0}:l))},W=t=>{L(s=>s.map(n=>n.pageId===t.pageId?{...n,isCompleted:t.isCompleted,isPublished:t.isPublished}:n));const o={pageId:t.pageId,updates:{isCompleted:t.isCompleted,isPublished:t.isPublished}};u(!0),B.updateAppTextPage(o).then(s=>{f.success("Successfully updated!",{position:"top-right",draggable:!0,theme:"colored",transition:C,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3});const n=e.appTextPages.map(r=>r.pageId==t.pageId?{...r,isCompleted:t.isCompleted,isPublished:t.isPublished}:r);e.dispatch({type:c.SET_APP_TEXT_PAGES,payload:{appTextPages:n}}),u(!1)}).catch(s=>{f.error(s instanceof Error?s.message:String(s),{position:"top-right",draggable:!0,theme:"colored",transition:C,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),u(!1)})},G=t=>{const o=T.find(n=>n.pageId==t),s={texts:(o==null?void 0:o.texts)||[]};u(!0),B.updateAppTexts(s).then(n=>{e.dispatch({type:c.SET_APP_TEXT_PAGES,payload:{appTextPages:T}}),A(r=>r.map(l=>l.pageId==t?{...l,isChanged:!1}:l)),f.success("Successfully updated!",{position:"top-right",draggable:!0,theme:"colored",transition:C,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),u(!1)}).catch(n=>{f.error(n instanceof Error?n.message:String(n),{position:"top-right",draggable:!0,theme:"colored",transition:C,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),u(!1)})},z=()=>T.map((t,o)=>{var s;return a.jsx(be,{pageName:t.pageTitle,defaultLanguage:_,languages:b,currentLanguage:e.currentLanguage,currentLanguageLabel:oe(p),currentUser:e.currentUser,pageId:t.pageId,terms:t.texts,isComplete:t.isCompleted,isPublish:t.isPublished,hasChangedText:((s=k.find(n=>n.pageId==t.pageId))==null?void 0:s.isChanged)||!1,onChangeDefaultLanguage:n=>D(n),onChangeInput:(n,r)=>N(n,r),onChangeAppTextPageStatus:n=>W(n),onSave:n=>G(n)},o)}),X=()=>a.jsxs(Le,{children:[a.jsx(ee,{tools:Ie}),H(),R(),z()]});return a.jsxs(Te,{flexDirection:O?"column":"row",children:[F(),X(),h&&a.jsx($,{}),a.jsx(Y,{})]})}function je(e){return{dispatch:e}}function ve(e){return{currentUser:e.user.currentUser,bookInfos:e.book.bookInfos,currentLanguage:e.book.language,currentBook:e.book.book,appTextPages:e.translator.appTextPages}}const He=J(ve,je)(Pe);export{He as default};

import{B as re,j as a,a as n}from"./createTheme-o4roE7n_.js";import{C as le,s as b,z as p,D as ie,a4 as ue,a2 as ce,E as de,H,J as U,X as v,W as ge,N as be,h as F}from"./App-B0cV1x-y.js";import{b as K,T as pe,B as he}from"./book.services-uDr5WzW_.js";import{A as fe,B as me,i as Se,h as ke,j as Be}from"./index-IXN8ucxO.js";import{S as I}from"./index-UgLQGlWr.js";import{a as xe}from"./index-ChHads2x.js";import{T as Ce}from"./index-BlVolTix.js";import"./TableContainer-rimpAPI9.js";var y={},ve=re;Object.defineProperty(y,"__esModule",{value:!0});var V=y.default=void 0,Te=ve(le()),_e=a;V=y.default=(0,Te.default)((0,_e.jsx)("path",{d:"M21 11H6.83l3.58-3.59L9 6l-6 6 6 6 1.41-1.41L6.83 13H21z"}),"KeyboardBackspace");const Ie=b(p)({position:"relative",minHeight:"calc(100vh - 37px)",width:"100%","& >.MuiBox-root:first-of-type":{backgroundColor:"#1B7695","& >.MuiBox-root":{color:"#F6FCFC"}}}),ye=b(p)({width:"100%",height:"calc(100% - 73px)",margin:"auto",marginTop:"73px"}),Oe=b(p)({margin:"20px 40px"}),Ee=b(p)({margin:"20px 40px",display:"flex",justifyContent:"center",boxSizing:"border-box"}),je=b(p)({margin:"20px 40px",display:"flex",alignItems:"center"}),Ne=b(p)({display:"flex",alignItems:"center",cursor:"pointer",marginRight:"250px","& .MuiSvgIcon-root":{width:"16px",marginRight:"10px",fill:"#155D74"}}),we=b(p)({display:"flex",justifyContent:"space-between",alignItems:"center","& >.MuiBox-root":{minWidth:"50px",marginRight:"20px"},"& > .MuiFormControl-root":{marginRight:"20px"}}),Le=[{bookTitle:"App Text",value:"App Text"},{bookTitle:me,value:"Qur'an"},{bookTitle:Se,value:"Injil"},{bookTitle:ke,value:"Zabur"},{bookTitle:Be,value:"Tawrat"}],Ae=[{toolName:"Western",onClick:()=>{}},{toolName:"Arabic",onClick:()=>{}}];function Re(l){const O=ue(),k=O.state,[M,h]=n.useState(!1),[d,E]=n.useState(null),[f,j]=n.useState(k.chapterInfo),[N,w]=n.useState([]),[P,L]=n.useState([]),[q,B]=n.useState([]),[A,T]=n.useState([]),[m,R]=n.useState([]),[x,W]=n.useState(k.bookTitle),[i,S]=n.useState(k.subBookInfo.subBookId),[g,_]=n.useState(k.chapterId),[u,G]=n.useState(l.currentLanguage),$=n.useMemo(()=>O.state.languages,[l.currentUser]),z=ce(),D=de(),J=n.useCallback(e=>{h(!0),K.getBookInfoByTitle(e).then(o=>{E(o);const t=Array.from(new Set(o.subBooks.map(s=>s.subBookId))).map(s=>o.subBooks.find(c=>c.subBookId===s)).map(s=>{var c;return{label:(c=s.subBookTitle)==null?void 0:c[u],value:s.subBookId}});T(t),S(t.length?t[0].value:""),t.length>0&&!i&&S(t[0].value),m.length>0&&!g&&_(m[0].value),h(!1)}).catch(o=>{H.error(o instanceof Error?o.message:String(o),{position:"top-right",draggable:!0,theme:"colored",transition:U,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),h(!1)})},[]),Q=n.useCallback(e=>{h(!0),K.getChapterInfoByChapterId(e).then(o=>{j(o),w(o.verses),l.dispatch({type:v.ADD_CHAPTERINFO,payload:{chapterInfo:o}}),h(!1)}).catch(o=>{H.error(o instanceof Error?o.message:String(o),{position:"top-right",draggable:!0,theme:"colored",transition:U,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),h(!1)})},[]),C=n.useCallback(()=>{const e=d==null?void 0:d.subBooks.find(o=>o.subBookId==i);if(console.log({activeBookInfo:d,selectedSubBook:i}),u=="en"){L(["SubBook_English","Chapter_Number","Verse_Number","Verse_English"]);const o=N.map(r=>({SubBook_English:(e==null?void 0:e.subBookTitle.en)||"",Chapter_Number:(f==null?void 0:f.chapterNumber.toString())||"1",Verse_Number:r.verseNumber.toString()||"1",Verse_English:r.verseText.en||""}));B(o||[])}else{const o=xe(u);L(["SubBook_English",`SubBook_${o}`,"Chapter_Number","Verse_Number",`Verse_${o}`]);const r=N.map(t=>{var s,c;return{SubBook_English:(e==null?void 0:e.subBookTitle.en)||"",[`SubBook_${o}`]:((s=e==null?void 0:e.subBookTitle)==null?void 0:s[u])||(e==null?void 0:e.subBookTitle.en)||"",Chapter_Number:(f==null?void 0:f.chapterNumber.toString())||"1",Verse_Number:t.verseNumber.toString()||"1",[`Verse_${o}`]:((c=t.verseText)==null?void 0:c[u])||t.verseText.en||""}});B(r||[])}},[]);n.useEffect(()=>{const e=l.bookInfos.find(o=>o.bookTitle.en==x);if(e){E(e);const r=Array.from(new Set(e.subBooks.map(t=>t.subBookId))).map(t=>e.subBooks.find(s=>s.subBookId===t)).map(t=>{var s;return{label:(s=t.subBookTitle)==null?void 0:s[u],value:t.subBookId}});T(r),S(r.some(t=>t.value==i)?i:r.length?r[0].value:""),r.length>0&&!i&&S(r[0].value),m.length>0&&!g&&_(m[0].value)}else J(x);C()},[x]),n.useEffect(()=>{var t;const e=l.bookInfos.find(s=>s.subBooks.find(c=>c.subBookId==i)),o=e==null?void 0:e.subBooks.find(s=>s.subBookId==i),r=(t=o==null?void 0:o.chapterInfos)==null?void 0:t.map(s=>({value:s.chapterId,label:s.chapterNumber.toString()}));R(r||[]),C()},[i]),n.useEffect(()=>{const e=l.chapterInfos.find(o=>o.chapterId==g);e?(j(e),w(e.verses)):Q(g),C()},[g]),n.useEffect(()=>{const e=d==null?void 0:d.subBooks.map(o=>{var r;return{value:o.subBookId,label:((r=o.subBookTitle)==null?void 0:r[u])||o.subBookTitle.en}});e&&T(e),C()},[u]);const Z=e=>{const o=e.target.value;S(o)},X=e=>{const o=e.target.value;_(o)},Y=e=>{const o=e.target.value;G(o),l.dispatch({type:v.SET_CURRENT_LANGUAGE,payload:{language:o}})},ee=()=>{localStorage.removeItem(fe),l.dispatch({type:v.RESET_USER}),l.dispatch({type:v.RESET_BOOK}),D("/admin")},oe=()=>a.jsx(be,{isLoggedIn:!0,username:l.currentUser.username,isAdmin:l.currentUser.isAdmin,onLogOut:ee}),te=()=>a.jsx(Oe,{children:a.jsx(he,{books:Le.map(e=>({bookTitle:e.bookTitle,onClick:()=>W(e.value)})),selectedBook:x})}),se=()=>a.jsxs(je,{children:[a.jsxs(Ne,{onClick:()=>D("/admin/bookoverview"),children:[a.jsx(V,{}),a.jsx(F,{fontFamily:"Inter",color:"#155D74",fontWeight:"500",children:"overview"})]}),a.jsxs(we,{children:[a.jsx(F,{fontFamily:"Inter",color:"#155D74",fontWeight:"500",children:"Go to:"}),a.jsx(I,{label:"",options:A,value:A.find(e=>e.value===i)?i:"",backgroundColor:"#fff",textColor:"#155D74",onChange:Z}),a.jsx(I,{label:"",options:m,value:m.find(e=>e.value===g)?g:"",backgroundColor:"#fff",textColor:"#155D74",onChange:X}),a.jsx(I,{label:"",options:$,value:u,backgroundColor:"#fff",textColor:"#155D74",onChange:Y})]})]}),ae=()=>a.jsx(Ee,{children:a.jsx(Ce,{headers:P,rows:q})}),ne=()=>a.jsxs(ye,{children:[a.jsx(pe,{tools:Ae}),te(),se(),ae()]});return a.jsxs(a.Fragment,{children:[a.jsxs(Ie,{flexDirection:z?"column":"row",children:[oe(),ne()]}),M&&a.jsx(ge,{})]})}function De(l){return{dispatch:l}}function He(l){return{currentUser:l.user.currentUser,bookInfos:l.book.bookInfos,chapterInfos:l.book.chapterInfos,currentLanguage:l.book.language}}const Ge=ie(He,De)(Re);export{Ge as default};

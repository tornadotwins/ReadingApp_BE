import{a as p,j as t,O as Se}from"./createTheme-BLbvD98s.js";import{aq as Ke,T as M,ar as qe,r as ke,s as h,B as x,I as de,q as O,t as Ge,O as Je,K as Qe,u as Xe,A as le,H as ae,E as Ze,Q as Ye,w as et,F as V}from"./App-BCQb8yp0.js";import{A as tt,S as be}from"./index-S5uZ94LN.js";import{g as ot,a as ie}from"./images-7xzE-75r.js";import{A as nt,i as lt,k as at,n as it}from"./index-BUea8qEr.js";import{S as ve}from"./index-w_cd9mba.js";import{T as rt,B as st}from"./index-Drl01m5q.js";import{F as dt}from"./index-UWhlcQJy.js";import{b as we}from"./book.services-dLCAebpo.js";function ct(e,r=166){let f;function w(...I){const g=()=>{e.apply(this,I)};clearTimeout(f),f=setTimeout(g,r)}return w.clear=()=>{clearTimeout(f)},w}function ut(e){return e&&e.ownerDocument||document}function Ce(e){return ut(e).defaultView||window}function ht(e,r){typeof e=="function"?e(r):e&&(e.current=r)}const ye=typeof window<"u"?p.useLayoutEffect:p.useEffect;function gt(...e){return p.useMemo(()=>e.every(r=>r==null)?null:r=>{e.forEach(f=>{ht(f,r)})},e)}function X(e){return parseInt(e,10)||0}const xt={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function pt(e){return e==null||Object.keys(e).length===0||e.outerHeightStyle===0&&!e.overflowing}const ft=p.forwardRef(function(r,f){const{onChange:w,maxRows:I,minRows:g=1,style:k,value:T,...D}=r,{current:P}=p.useRef(T!=null),s=p.useRef(null),N=gt(f,s),i=p.useRef(null),c=p.useRef(null),u=p.useCallback(()=>{const B=s.current,S=Ce(B).getComputedStyle(B);if(S.width==="0px")return{outerHeightStyle:0,overflowing:!1};const m=c.current;m.style.width=S.width,m.value=B.value||r.placeholder||"x",m.value.slice(-1)===`
`&&(m.value+=" ");const A=S.boxSizing,z=X(S.paddingBottom)+X(S.paddingTop),F=X(S.borderBottomWidth)+X(S.borderTopWidth),G=m.scrollHeight;m.value="x";const L=m.scrollHeight;let E=G;g&&(E=Math.max(Number(g)*L,E)),I&&(E=Math.min(Number(I)*L,E)),E=Math.max(E,L);const oe=E+(A==="border-box"?z+F:0),ne=Math.abs(E-G)<=1;return{outerHeightStyle:oe,overflowing:ne}},[I,g,r.placeholder]),b=p.useCallback(()=>{const B=u();if(pt(B))return;const y=B.outerHeightStyle,S=s.current;i.current!==y&&(i.current=y,S.style.height=`${y}px`),S.style.overflow=B.overflowing?"hidden":""},[u]);ye(()=>{const B=()=>{b()};let y;const S=ct(B),m=s.current,A=Ce(m);A.addEventListener("resize",S);let z;return typeof ResizeObserver<"u"&&(z=new ResizeObserver(B),z.observe(m)),()=>{S.clear(),cancelAnimationFrame(y),A.removeEventListener("resize",S),z&&z.disconnect()}},[u,b]),ye(()=>{b()});const R=B=>{P||b(),w&&w(B)};return t.jsxs(p.Fragment,{children:[t.jsx("textarea",{value:T,onChange:R,ref:N,rows:g,style:k,...D}),t.jsx("textarea",{"aria-hidden":!0,className:r.className,readOnly:!0,ref:c,tabIndex:-1,style:{...xt.shadow,...k,paddingTop:0,paddingBottom:0}})]})});function mt(e){const r=f=>{e.onKeyDown&&e.onKeyDown(f)};return t.jsxs(t.Fragment,{children:[t.jsxs(Ke,{children:[e.label&&t.jsx(M,{fontFamily:'"Baloo Da 2"',fontWeight:"400",fontSize:16,lineHeight:24,textAlign:"center",children:e.label}),t.jsx(ft,{required:e.required,type:e.type,value:e.value,minRows:e.minLength,inputref:e.reference,placeholder:e.placeholder,onKeyDown:r,onChange:e.onChange})]}),e.error&&t.jsx(qe,{children:e.error})]})}var ce={},bt=Se;Object.defineProperty(ce,"__esModule",{value:!0});var Be=ce.default=void 0,vt=bt(ke()),wt=t;Be=ce.default=(0,vt.default)((0,wt.jsx)("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward");var ue={},Ct=Se;Object.defineProperty(ue,"__esModule",{value:!0});var je=ue.default=void 0,yt=Ct(ke()),St=t;je=ue.default=(0,yt.default)((0,St.jsx)("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"}),"ArrowDownward");const ee=h(x)({backgroundColor:"#F0F5FB",border:"1px solid #1B7695",borderRadius:"4px",padding:"10px",boxSizing:"border-box",fontFamily:"Inter",width:"100%",marginBottom:"10px"}),kt=h(x)({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"}),Bt=h(x)({display:"flex",alignItems:"center"}),re=h(x)(({isdisabled:e})=>({display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",padding:"5px",border:"1px solid #155D74",borderRadius:"4px",marginLeft:"5px",opacity:e=="true"?".8":"1","&:hover":{cursor:e=="true"?"not-allowed":"pointer",backgroundColor:e=="true"?"":"#155D74","& svg":{fill:e=="true"?"":"white"},"& .MuiBox-root":{color:e=="true"?"":"white"}}})),K=h(x)({display:"flex",alignItems:"start",marginTop:"10px","@media screen and (max-width: 480px)":{"& .MuiBox-root":{fontSize:"12px !important"},flexDirection:"column"}}),q=h(x)({display:"flex",alignItems:"center",marginRight:"15px",minWidth:"100px","& .MuiBox-root":{clear:"both",display:"inline-block",overflow:"hidden",whiteSpace:"nowrap"},"& > .MuiBox-root: first-of-type":{marginRight:"5px"},"@media screen and (max-width: 480px)":{minWidth:"70px",marginRight:"5px"}}),Y=h(x)(({hastextarea:e,isdisabled:r})=>({display:"flex",width:"100%",boxSizing:"border-box",border:e=="true"?"none":"1px solid #155D74",borderRadius:"4px",backgroundColor:e=="true"?"transparent":"#FFF",fontFamily:"Inter",fontSize:"16px",lineHeight:"24px",fontWeight:"500",color:"#000",outline:"none","& .MuiBox-root":{padding:"0",width:"100%","& textarea":{width:"100%",fontFamily:"Inter",fontSize:"16px",padding:"7px 10px",border:"1px solid #155D74",borderRadius:"4px"}},"& .MuiFormControl-root":{width:"100% !important",borderRadius:"4px","& .MuiInputBase-input":{fontFamily:"Inter",'&[type="text"]':{all:r=="true"&&"unset",paddingLeft:"10px",paddingRight:"10px"}},"& .MuiInputBase-root.Mui-disabled":{color:"rgba(0, 0, 0, 0.6)"}},'& input[type="file"]':{cursor:"pointer",minWidth:"50px"},"& p":{display:"none"},"@media screen and (max-width: 600px)":{flexDirection:"column"},"@media screen and (max-width: 460px)":{"& .MuiInputBase-root input":{textOverflow:"ellipsis",overflow:"hiddeon",whiteSpace:"nowrap"}}}));h(x)({margin:"20px 0px 10px 0px"});const Ie=h(x)({marginTop:"16px","& img":{maxWidth:"100%",maxHeight:"200px",objectFit:"contain",border:"1px solid #ccc",borderRadius:"4px"}}),jt=h(x)({display:"flex",alignItems:"center",justifyContent:"space-between",boxSizing:"border-box"}),It=h(x)({display:"flex",alignItems:"center"}),se=h(x)(({isdisabled:e})=>({display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",marginRight:"5px",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",cursor:e=="true"?"not-allowed !important":"pointer","& .MuiBox-root":{textTransform:"capitalize"},"&:hover":{cursor:"pointer",backgroundColor:e=="true"?"#A1A1A1":"#EE994C","& .MuiBox-root":{color:e=="true"?"#474747":"#FFF !important",backgroundColor:e=="true"?"#A1A1A1":"#EE994C"}}})),Dt=h(x)({display:"flex",flexDirection:"column",boxSizing:"border-box",marginTop:"10px"}),Mt=h(x)({display:"flex",flexDirection:"column",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",width:"100%",marginTop:"10px","& .MuiAccordionSummary-content .MuiBox-root":{width:"100%",wordWrap:"break-work",wordBreak:"break-word"},"& .MuiAccordionDetails-root .MuiBox-root":{marginTop:"10px",width:"100%",wordWrap:"break-work",wordBreak:"break-word"}});function te(e){return t.jsxs(kt,{children:[t.jsx(M,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.title}),t.jsxs(Bt,{children:[t.jsx(re,{isdisabled:e.disableMoveUp?"true":"false",onClick:()=>e.disableMoveUp?{}:e.onMoveUp(e.blockIndex),children:t.jsx(Be,{})}),t.jsx(re,{isdisabled:e.disableMoveDown?"true":"false",onClick:()=>e.disableMoveDown?{}:e.onMoveDown(e.blockIndex),children:t.jsx(je,{})}),t.jsx(re,{isdisabled:e.disableDelete?"true":"false",onClick:()=>e.disableDelete?{}:e.onDelete(),children:t.jsx(M,{children:"Delete"})})]})]})}function De(e){return t.jsxs(ee,{children:[t.jsx(te,{title:"Title Block",blockIndex:e.blockIndex,disableDelete:e.disableDelete,disableMoveDown:e.disableMovedown,disableMoveUp:e.disableMoveUp,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsxs(q,{children:[t.jsx(M,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.language}),t.jsx(M,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Title:"})]}),t.jsx(Y,{children:t.jsx(de,{type:"text",placeholder:"Enter Title",value:e.inputVal,onChange:r=>e.onInputChange(r.target.value)})})]})]})}function Me(e){return t.jsxs(ee,{children:[t.jsx(te,{title:"Text Block",blockIndex:e.blockIndex,disableDelete:e.disableDelete,disableMoveDown:e.disableMovedown,disableMoveUp:e.disableMoveUp,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsxs(q,{children:[t.jsx(M,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:e.language}),t.jsx(M,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Text:"})]}),t.jsx(Y,{hastextarea:"true",children:t.jsx(mt,{placeholder:"Enter Text",value:e.inputVal,minLength:3,onChange:r=>e.onInputChange(r.target.value)})})]})]})}function Ae(e){const[r,f]=p.useState(e.url||""),w=I=>{var k;const g=(k=I.target.files)==null?void 0:k[0];if(g){const T=new FileReader;T.onload=D=>{var s;const P=(s=D.target)==null?void 0:s.result;f(URL.createObjectURL(g)),e.onImageInputChange(P)},T.readAsDataURL(g)}};return t.jsxs(ee,{children:[t.jsx(te,{title:"Image Block",blockIndex:e.blockIndex,disableDelete:e.disableDelete,disableMoveDown:e.disableMovedown,disableMoveUp:e.disableMoveUp,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(M,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Image URL:"})}),t.jsxs(Y,{isdisabled:"true",children:[t.jsx(dt,{type:".png, .jpg, .jpeg",onChange:w}),t.jsx(de,{value:r,placeholder:"Image URL",disable:!0,onChange:()=>{}})]})]}),t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(M,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Alt Text:"})}),t.jsx(Y,{children:t.jsx(de,{type:"text",placeholder:"Enter Alt Text",value:e.alt,onChange:I=>e.onAltInputChange(I.target.value)})})]}),r&&t.jsxs(K,{children:[t.jsx(q,{children:t.jsx(M,{color:"#155D74",fontFamily:"Inter",fontSize:16,lineHeight:24,fontWeight:"500",children:"Preview:"})}),t.jsx(Ie,{children:t.jsx("img",{src:r,alt:e.alt||"Selected image"})})]})]})}function At(e){const r=ot(e.language),[f,w]=p.useState([]);p.useEffect(()=>{var u,b,R,B;const i=[],c=(u=e.value)==null?void 0:u.content;if((b=e.value)!=null&&b.title){const y={id:`title-${Date.now()}-${Math.random()}`,blockIndex:1,type:"title",value:(B=(R=e.value)==null?void 0:R.title)==null?void 0:B[r]};i.push(y)}c==null||c.map((y,S)=>{if(y.url){const m={id:`image-${Date.now()}-${Math.random()}`,blockIndex:S+2,type:"image",value:{url:y.url,alt:y.alt}};i.push(m)}else if(y.isTitle){const m={id:`title-${Date.now()}-${Math.random()}`,blockIndex:S+2,type:"title",value:y==null?void 0:y[r]};i.push(m)}else{const m={id:`text-${Date.now()}-${Math.random()}`,blockIndex:S+2,type:"text",value:y==null?void 0:y[r]};i.push(m)}}),w(i)},[]),p.useEffect(()=>{e.onChange(f)},[f]);const I=()=>t.jsx(te,{title:"Collapsible Block",blockIndex:e.blockIndex,onDelete:e.onDelete,onMoveUp:e.onMoveUp,onMoveDown:e.onMoveDown}),g=i=>{const u={id:`${i}-${Date.now()}-${Math.random()}`,blockIndex:f.length+1,type:i,value:i=="image"?{url:"",alt:""}:""};w([...f,u])},k=i=>{const c=f.filter(u=>u.id!==i);w(c)},T=()=>t.jsx(jt,{children:t.jsxs(It,{children:[t.jsx(se,{children:t.jsx(O,{label:"Add Title",onClick:()=>g("title")})}),t.jsx(se,{isdisabled:f.length==0?"true":"false",children:t.jsx(O,{label:"Add Text",disabled:!f||f.length==0,onClick:()=>g("text")})}),t.jsx(se,{isdisabled:f.length==0?"true":"false",children:t.jsx(O,{label:"Add Image",disabled:!f||f.length==0,onClick:()=>g("image")})})]})}),D=(i,c)=>{w(f.map(u=>u.id==i?{...u,value:c}:u))},P=(i,c)=>{w(u=>u.map(b=>b.id===i?{...b,value:{...b.value,...c}}:b))},s=(i,c)=>{w(u=>{const b=[...u];return c==="up"&&i>0&&([b[i],b[i-1]]=[b[i-1],b[i]]),c==="down"&&i<b.length-1&&([b[i],b[i+1]]=[b[i+1],b[i]]),b})},N=()=>t.jsx(Dt,{children:f.map((i,c)=>{switch(i.type){case"title":return t.jsx(De,{language:e.language,inputVal:i.value,blockIndex:c+1,disableDelete:c===0,disableMovedown:c===0,disableMoveUp:c===0,onInputChange:u=>D(i.id,u),onDelete:()=>k(i.id),onMoveUp:()=>s(c,"up"),onMoveDown:()=>s(c,"down")},c);case"text":return t.jsx(Me,{language:e.language,inputVal:i.value,blockIndex:c+1,disableMoveUp:c===1,onInputChange:u=>D(i.id,u),onDelete:()=>k(i.id),onMoveUp:()=>s(c,"up"),onMoveDown:()=>s(c,"down")},c);case"image":return t.jsx(Ae,{url:i.value.url,alt:i.value.alt,blockIndex:c+1,disableMoveUp:c==1,onImageInputChange:u=>P(i.id,{url:u}),onAltInputChange:u=>P(i.id,{alt:u}),onDelete:()=>k(i.id),onMoveUp:()=>s(c,"up"),onMoveDown:()=>s(c,"down")},c)}return null})});return t.jsxs(ee,{children:[I(),T(),N()]})}const Tt=h(x)({position:"relative",minHeight:"calc(100vh - 37px)",width:"100%","& >.MuiBox-root:first-of-type":{backgroundColor:"#1B7695","& >.MuiBox-root":{color:"#F6FCFC"}}}),Rt=h(x)({width:"100%",height:"calc(100% - 73px)",margin:"auto",marginTop:"73px"}),Ft=h(x)({margin:"20px 40px"}),Et=h(x)({margin:"20px 40px",display:"flex",alignItems:"center","@media screen and (max-width: 800px)":{display:"block"}}),zt=h(x)({display:"flex",justifyContent:"space-between",alignItems:"center","& > .MuiFormControl-root":{marginRight:"20px"},"@media screen and (max-width: 650px)":{display:"block","& > .MuiFormControl-root":{alignItems:"start","& .MuiInputBase-root":{width:"100%"}}}}),Ut=h(x)({margin:"20px 40px",display:"flex",alignItems:"center","& > .MuiBox-root":{width:"120px",marginRight:"50px"},"@media screen and (max-width: 800px)":{display:"block"}}),Ot=h(x)(({isdisable:e})=>({display:"flex",justifyContent:"center",alignItems:"center",width:"160px !important",marginRight:"0px !important",padding:"5px 10px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:e=="true"?"#A1A1A1":"#FFAA5D",cursor:e=="true"?"not-allowed":"pointer",button:{width:"100%"},"&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",fontWeight:"600 !important",textTransform:"none","&:hover":{backgroundColor:e=="true"?"#A1A1A1":"#EE994C"}}})),Pt=h(x)({width:"100%",padding:"20px 40px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"space-between","@media screen and (max-width: 800px)":{flexDirection:"column"}}),_t=h(x)({display:"flex",alignItems:"center","@media screen and (max-width: 800px)":{flexDirection:"column",width:"100%"}}),Z=h(x)({display:"flex",justifyContent:"center",alignItems:"center",marginRight:"20px !important",padding:"5px 10px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:"#FFAA5D",cursor:"pointer",button:{width:"100%"},"&:hover":{backgroundColor:"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",textTransform:"none","&:hover":{backgroundColor:"#EE994C"}},"@media screen and (max-width: 800px)":{width:"100%",marginRight:"0px !important",marginBottom:"10px"}}),Lt=h(x)({display:"flex",justifyContent:"center",alignItems:"center",padding:"5px 10px",width:"150px",boxSizing:"border-box",border:"1px solid #474747",backgroundColor:"#FFAA5D",cursor:"pointer",button:{width:"100%"},"&:hover":{backgroundColor:"#EE994C"},"& .MuiBox-root":{color:"#474747 !important",textTransform:"none","&:hover":{backgroundColor:"#EE994C"}},"@media screen and (max-width: 800px)":{width:"100%"}}),Ht=h(x)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boxSizing:"border-box",width:"100%"}),Wt=h(x)({display:"flex",flexDirection:"column",alignItems:"center",boxSizing:"border-box",border:"1px solid #155D74",borderRadius:"4px",backgroundColor:"#F0F5FB",padding:"10px",width:"300px",marginBottom:"10px","& .MuiBox-root":{width:"100%",wordWrap:"break-work",wordBreak:"break-word"},"& > .MuiBox-root: first-of-type":{marginBottom:"20px"},"@media screen and (max-width: 700px)":{width:"100%"}}),$t=h(x)({display:"flex",alignItems:"center",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),Nt=h(x)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),Vt=h(x)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px"}),Kt=h("img")({width:"250px"}),qt=h(x)({display:"flex",alignSelf:"start",boxSizing:"border-box",padding:"0px 10px",marginBottom:"10px",width:"100%"}),Gt=h(x)({display:"flex",margin:"20px 40px",boxSizing:"border-box",justifyContent:"space-between",gap:"20px","@media screen and (max-width: 700px)":{flexDirection:"column"}});function Jt(e){var r,f,w,I;return t.jsx(Mt,{children:t.jsx(tt,{label:e.title||((f=(r=e.value)==null?void 0:r.title)==null?void 0:f[e.language])||"",detail:(I=e.contents&&e.contents.length>0?e.contents:(w=e.value)==null?void 0:w.content)==null?void 0:I.map((g,k)=>g!=null&&g.isTitle?t.jsx(M,{color:"#474747",fontSize:16,fontWeight:"700",fontFamily:"Inter",children:g==null?void 0:g[e.language]},k):g!=null&&g.url?t.jsx(Ie,{children:t.jsx("img",{src:g==null?void 0:g.url})},k):t.jsx(M,{color:"#474747",fontSize:16,fontWeight:"500",fontFamily:"Inter",children:g==null?void 0:g[e.language]},k))})})}const Qt=[{toolName:"Western",onClick:()=>{}},{toolName:"Arabic",onClick:()=>{}}];function Xt(e){var pe,fe,me;const r=Je(),[f,w]=p.useState(!1),[I,g]=p.useState(e.currentBook),[k,T]=p.useState((pe=r.state.subBookInfo)==null?void 0:pe.subBookId),[D,P]=p.useState(r.state.chapterId),[s,N]=p.useState(e.currentLanguage),[i,c]=p.useState([]),[u,b]=p.useState(((fe=r.state.subBookInfo.chapterInfos[0].chapterIsCompleted)==null?void 0:fe[s])||!1),[R,B]=p.useState(((me=r.state.subBookInfo.chapterInfos[0].chapterIsPublished)==null?void 0:me[s])||!1),[y,S]=p.useState(!0),[m,A]=p.useState([]),[z,F]=p.useState(!1),G=Qe(),L=Xe(),E=p.useMemo(()=>r.state.languages,[r]);p.useEffect(()=>{var d,v;const o=e.bookInfos.find(a=>a.bookTitle.en==e.currentBook),n=(d=o==null?void 0:o.subBooks)==null?void 0:d.find(a=>a.subBookId==k),l=(n==null?void 0:n.chapterInfos)&&(n==null?void 0:n.chapterInfos[0].chapterNumber)==0&&((v=n==null?void 0:n.chapterInfos[0])==null?void 0:v.chapterId)||"";P(l)},[k]),p.useEffect(()=>{w(!0),A([]),we.getIntroVerses(D).then(o=>{var l,d,v;b(((l=o.isCompleted)==null?void 0:l[s])||!1),B(((d=o.isPublished)==null?void 0:d[s])||!1);const n=[];o.verses&&o.verses.length>0&&((v=o.verses)==null||v.map(a=>{var C,H;const j=a.number;if(!a.isCollapse&&a.title){const U={id:a.id||`title-${Date.now()}-${Math.random()}`,type:"title",blockIndex:j,value:(C=a.title)==null?void 0:C[s]};n.push(U)}else if(!a.isCollapse&&a.text){const U={id:a.id||`text-${Date.now()}-${Math.random()}`,type:"text",blockIndex:j,value:(H=a.text)==null?void 0:H[s]};n.push(U)}else if(!a.isCollapse&&a.image){const U={id:a.id||`image-${Date.now()}-${Math.random()}`,type:"image",blockIndex:j,value:a.image};n.push(U)}else if(a.isCollapse){const U={id:a.id||`collapsible-${Date.now()}-${Math.random()}`,type:"collapsible",blockIndex:j,value:a};n.push(U)}})),A(n),w(!1)}).catch(o=>{console.log(`warning/error while getting intro information: 
`,o),le.warning("No introduction information for the chapter.",{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),w(!1)})},[D,s]);const oe=()=>{localStorage.removeItem(nt),e.dispatch({type:V.RESET_USER}),e.dispatch({type:V.RESET_BOOK}),e.dispatch({type:V.RESET_APP_TEXT_PAGES}),L("/admin")},ne=()=>t.jsx(et,{isLoggedIn:!0,username:e.currentUser.username,isAdmin:e.currentUser.isAdmin,onLogOut:oe}),Te=o=>{g(o),L("/admin/bookoverview"),e.dispatch({type:V.SET_BOOK,payload:{bookTitle:o}})},Re=()=>t.jsx(Ft,{children:t.jsx(st,{books:lt.map(o=>({bookTitle:o.bookTitle,onClick:()=>{Te(o.value)}})),selectedBook:I})});p.useEffect(()=>{var n;const o=e.bookInfos.find(l=>l.bookTitle.en==e.currentBook);if(o){const d=Array.from(new Set(o.subBooks.map(v=>v.subBookId))).map(v=>o.subBooks.find(a=>a.subBookId===v)).map(v=>{var a;return{label:(a=v.subBookTitle)==null?void 0:a[s],value:v.subBookId}});c(d),T(((n=r.state.subBookInfo)==null?void 0:n.subBookId)||d[0].value)}},[e.currentBook]);const Fe=o=>{const n=o.target.value;T(n)},Ee=o=>{const n=o.target.value;N(n)},ze=()=>t.jsx(Et,{children:t.jsxs(zt,{children:[(I==at||I==it)&&t.jsx(ve,{label:"",options:i,value:i.find(o=>o.value===k)?k:"",backgroundColor:"#fff",textColor:"#155D74",onChange:Fe}),t.jsx(ve,{label:"",options:E,value:s,backgroundColor:"#fff",textColor:"#155D74",onChange:Ee})]})}),he=(o,n)=>{b(o),o&&B(n),!o&&B(!1),F(!0)},Ue=o=>{const n={chapterAudio:o.audio,chapterId:o._id,chapterNumber:o.chapterNumber,chapterTranslated:o.isTranslated,chapterIsCompleted:o.isCompleted,chapterIsPublished:o.isPublished,subBookId:o.subBook},l=e.bookInfos.map(d=>({...d,subBooks:d.subBooks.map(v=>({...v,chapterInfos:v.chapterInfos.map(a=>a.chapterId===D?{...a,...n}:a)}))}));e.dispatch({type:V.SET_BOOKINFOS,payload:{bookInfos:l}})},Oe=p.useCallback(()=>{w(!0);const o=[];m.map((l,d)=>{var v;switch(l.type){case"title":{const a=l.value,j={chapter:D,title:{[s]:a},text:{},image:{},number:d+1,isCollapse:!1,content:[]};o.push(j);break}case"text":{const a=l.value,j={chapter:D,title:{},text:{[s]:a},image:{},number:d+1,isCollapse:!1,content:[]};o.push(j);break}case"image":{const a=l.value,j=a.url,C=a.alt,H={chapter:D,title:{},text:{},image:{url:j,alt:C},number:d+1,isCollapse:!1,content:[]};o.push(H);break}case"collapsible":{let a={chapter:D,title:{},text:{},image:{},number:d+1,isCollapse:!0,content:[]};const j=[],C=l.value,H=(v=C[0])==null?void 0:v.value;a={...a,title:{[s]:H}};for(const U of Object.keys(C).slice(1)){const W=C[U];if(W.type=="title"){const $={[s]:W.value,isTitle:!0};j.push($)}else if(W.type=="text"){const $={[s]:W.value,isTitle:!1};j.push($)}else if(W.type=="image"){const $=W.value,Ve={url:$.url,alt:$.alt};j.push(Ve)}}a={...a,content:j},o.push(a);break}}});const n={languageCode:s,subBookId:k,chapterId:D,isCompleted:{[s]:u},isPublished:{[s]:R},verses:o};we.updateIntroData(n).then(l=>{Ue(l),le.success("Successfully updated.",{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),w(!1)}).catch(l=>{le.error(l.message,{position:"top-right",draggable:!0,theme:"colored",transition:ae,closeOnClick:!0,pauseOnHover:!0,hideProgressBar:!1,autoClose:3e3}),w(!1)})},[m,u,R]),Pe=()=>t.jsxs(Ut,{children:[t.jsx(be,{label:"Complete",value:u,disable:m.length==0,onChange:()=>he(!u,R)}),t.jsx(be,{label:"Publish",value:R,disable:!u,onChange:()=>he(u,!R)}),t.jsx(Ot,{isdisable:z?"false":"true",children:t.jsx(O,{label:"Save Changes",disabled:!z,onClick:Oe})})]}),J=o=>{const l={id:`${o}-${Date.now()}`,blockIndex:m.length,type:o,value:o=="image"?{url:"",alt:""}:""};F(!0),A([...m,l])},Q=o=>{const n=m.filter(l=>l.id!==o);F(!0),A(n)},_e=()=>t.jsxs(Pt,{children:[t.jsxs(_t,{children:[t.jsx(Z,{children:t.jsx(O,{label:"Add Title",onClick:()=>J("title")})}),t.jsx(Z,{children:t.jsx(O,{label:"Add Text",onClick:()=>J("text")})}),t.jsx(Z,{children:t.jsx(O,{label:"Add Image",onClick:()=>J("image")})}),t.jsx(Z,{children:t.jsx(O,{label:"Add Collapsible",onClick:()=>J("collapsible")})})]}),t.jsx(Lt,{children:t.jsx(O,{label:y?"Hide Preview":"Show Preview",onClick:()=>S(!y)})})]}),ge=(o,n)=>{F(!0),A(m.map(l=>l.id==o?{...l,value:n}:l))},xe=(o,n)=>{F(!0),A(l=>l.map(d=>d.id===o?{...d,value:{...d.value,...n}}:d))},Le=(o,n)=>{var l;F(!0),(l=Object.values(n)[0])!=null&&l.value||F(!1),A(d=>d.map(v=>v.id==o?{...v,value:{...v.value,...n}}:v))},_=(o,n)=>{F(!0),A(l=>{const d=[...l];return n==="up"&&o>0&&([d[o],d[o-1]]=[d[o-1],d[o]]),n==="down"&&o<d.length-1&&([d[o],d[o+1]]=[d[o+1],d[o]]),d})},He=()=>t.jsx(Ht,{children:m.map((o,n)=>{switch(o.type){case"title":return t.jsx(De,{language:ie(s),inputVal:o.value,blockIndex:n,onInputChange:l=>ge(o.id,l),onDelete:()=>Q(o.id),onMoveUp:()=>_(n,"up"),onMoveDown:()=>_(n,"down")},o.id);case"text":return t.jsx(Me,{language:ie(s),inputVal:o.value,blockIndex:n,onInputChange:l=>ge(o.id,l),onDelete:()=>Q(o.id),onMoveUp:()=>_(n,"up"),onMoveDown:()=>_(n,"down")},o.id);case"image":return t.jsx(Ae,{url:o.value.url,alt:o.value.alt,blockIndex:n,onImageInputChange:l=>xe(o.id,{url:l}),onAltInputChange:l=>xe(o.id,{alt:l}),onDelete:()=>Q(o.id),onMoveUp:()=>_(n,"up"),onMoveDown:()=>_(n,"down")},o.id);case"collapsible":return t.jsx(At,{language:ie(s),blockIndex:n,value:o.value,onChange:l=>Le(o.id,l),onDelete:()=>Q(o.id),onMoveUp:()=>_(n,"up"),onMoveDown:()=>_(n,"down")},o.id);default:return null}})}),We=()=>m&&m.length>0&&y&&t.jsxs(Wt,{children:[t.jsx(M,{color:"#155D74",fontSize:18,fontWeight:"bold",textAlign:"left",fontFamily:"Inter",children:"PREVIEW:"}),m.map((o,n)=>{var l;switch(o.type){case"title":return t.jsx($t,{children:t.jsx(M,{color:"black",fontWeight:"bold",textAlign:"left",fontFamily:"Inter",children:o.value})},n);case"text":return t.jsx(Nt,{children:t.jsx(M,{color:"black",fontSize:16,fontWeight:"400",fontFamily:"Inter",children:o.value})},n);case"image":return t.jsx(Vt,{children:t.jsx(Kt,{src:o.value.url,alt:o.value.alt})},n);case"collapsible":{const d=Object.values(o.value),v=(l=d[0])==null?void 0:l.value,a=[];for(let j=1;j<d.length;j++){const C=d[j];(C==null?void 0:C.type)=="title"?a.push({[s]:C==null?void 0:C.value,isTitle:!0}):(C==null?void 0:C.type)=="text"?a.push({[s]:C==null?void 0:C.value,isTitle:!1}):a.push(C==null?void 0:C.value)}return t.jsx(qt,{children:t.jsx(Jt,{language:s,blockIndex:o.blockIndex,value:o.value,title:v,contents:a,onChange:()=>{},onDelete:()=>{},onMoveDown:()=>{},onMoveUp:()=>{}})},n)}}})]}),$e=()=>t.jsxs(Gt,{children:[He(),We()]}),Ne=()=>t.jsxs(Rt,{children:[t.jsx(rt,{tools:Qt}),Re(),ze(),Pe(),_e(),$e()]});return t.jsxs(t.Fragment,{children:[t.jsxs(Tt,{flexDirection:G?"column":"row",children:[ne(),Ne()]}),f&&t.jsx(Ze,{}),t.jsx(Ye,{})]})}function Zt(e){return{dispatch:e}}function Yt(e){return{currentUser:e.user.currentUser,bookInfos:e.book.bookInfos,chapterInfos:e.book.chapterInfos,currentBook:e.book.book,currentLanguage:e.book.language}}const co=Ge(Yt,Zt)(Xt);export{co as default};
